
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>tflow package &#8212; tflow v0.0.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">tflow v0.0.1 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/tflow.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-modules">
   Processing modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-tflow.davis2hdf5">
   tflow.davis2hdf5 module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#core-modules">
   Core modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-tflow.velocity">
   tflow.velocity module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-module">
   Plotting module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-tflow.graph">
   tflow.graph module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-modules">
   Helper modules
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>tflow package</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-modules">
   Processing modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-tflow.davis2hdf5">
   tflow.davis2hdf5 module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#core-modules">
   Core modules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-tflow.velocity">
   tflow.velocity module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-module">
   Plotting module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-tflow.graph">
   tflow.graph module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-modules">
   Helper modules
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="tflow-package">
<h1>tflow package<a class="headerlink" href="#tflow-package" title="Permalink to this headline"></a></h1>
<section id="processing-modules">
<h2>Processing modules<a class="headerlink" href="#processing-modules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-tflow.davis2hdf5">
<span id="tflow-davis2hdf5-module"></span><h2>tflow.davis2hdf5 module<a class="headerlink" href="#module-tflow.davis2hdf5" title="Permalink to this headline"></a></h2>
<p>Convert DaVis txt outputs into hdf5</p>
<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.davis2hdf5">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">davis2hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datadir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'piv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.davis2hdf5" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.davis2hdf5_dirbase">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">davis2hdf5_dirbase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirbase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'piv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.davis2hdf5_dirbase" title="Permalink to this definition"></a></dt>
<dd><p>Convert multiple davis outputs into hdf5 files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirbase</strong> – </p></li>
<li><p><strong>savedir</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.davis2hdf5_piv">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">davis2hdf5_piv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datadir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.davis2hdf5_piv" title="Permalink to this definition"></a></dt>
<dd><p>Convert multiple DaVis output (PIV) into a hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirbase</strong> – </p></li>
<li><p><strong>savedir</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.davis2hdf5_stb">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">davis2hdf5_stb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datadir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.davis2hdf5_stb" title="Permalink to this definition"></a></dt>
<dd><p>Convert multiple DaVis output (PIV) into a hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirbase</strong> – </p></li>
<li><p><strong>savedir</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.main">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.natural_sort">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">natural_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.natural_sort" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.davis2hdf5.write_hdf5_dict">
<span class="sig-prename descclassname"><span class="pre">tflow.davis2hdf5.</span></span><span class="sig-name descname"><span class="pre">write_hdf5_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.davis2hdf5.write_hdf5_dict" title="Permalink to this definition"></a></dt>
<dd><p>Stores data_dict
:param filepath: file path where data will be stored. (Do not include extension- .h5)
:type filepath: str
:param data_dict: data should be stored as data_dict[key]= data_arrays
:type data_dict: dictionary</p>
</dd></dl>

</section>
<section id="core-modules">
<h2>Core modules<a class="headerlink" href="#core-modules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-tflow.velocity">
<span id="tflow-velocity-module"></span><h2>tflow.velocity module<a class="headerlink" href="#module-tflow.velocity" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.FFTOutput2CFTOutput_1d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">FFTOutput2CFTOutput_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.FFTOutput2CFTOutput_1d" title="Permalink to this definition"></a></dt>
<dd><p>Approximates the FFT of a 1D signal to the Continuous Fourier Transform (CFT)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gf</strong> (<em>1d array</em><em>, </em><em>FFT output of a 1d sample g</em><em>(</em><em>t</em><em>)</em>) – </p></li>
<li><p><strong>t</strong> (<em>1d array</em><em>, </em><em>a variable</em><em> (</em><em>time</em><em>, </em><em>space</em><em>, </em><em>etc</em><em>) </em><em>of the original function g</em><em>(</em><em>t</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gf_cft</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, Appriximated continuous fourier transform</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.FFTOutput2CFTOutput_nd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">FFTOutput2CFTOutput_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.FFTOutput2CFTOutput_nd" title="Permalink to this definition"></a></dt>
<dd><p>Approximates the DFT output into Continuous Fourier Transform output
… Power -&gt; Spectral Density
… The input “gf” is assumed to be the shifted, raw DFT output of a ND signal.</p>
<blockquote>
<div><p>i.e. The variable is frequency not angular frequency (wavenumber)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gf</strong> (<em>ND array</em><em> (</em><em>complex</em><em>)</em>) – … shifted, raw FFT output
… It assumes the output of the function “fft_nd(signal, axes)”</p></li>
<li><p><strong>dxs</strong> (<em>array-like</em>) – <dl class="simple">
<dt>… Sampling intervals of the signal in the spacial/temporal domain</dt><dd><p>i.e. (x, y, z, t) not (1/Lx, 1/Ly, 1/Lz. 1/T)</p>
</dd>
</dl>
<p>… Must have the same length as gf</p>
</p></li>
<li><p><strong>x0s</strong> (<em>array-like</em>) – <dl class="simple">
<dt>… The minimum value of the spatial/temporal domain</dt><dd><p>i.e. X0, Y0, Z0, T0- the edge coordinates of the data and the initial moment when the data was recorded</p>
</dd>
</dl>
<p>… Must have the same length as gf</p>
</p></li>
<li><p><strong>axes</strong> (<em>array-like</em><em>,  </em><em>e.g.-</em><em> [</em><em>0</em><em>, </em><em>1</em><em>]</em>) – … axes along which FFT was conducted
… If None, it assumes that FFT was conducted along all axes of gx</p></li>
<li><p><strong>return_freq</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … If True, it returns a list of the frequencies along the axes FFT was conducted</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.add_data2udatapath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">add_data2udatapath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datadict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grpname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.add_data2udatapath" title="Permalink to this definition"></a></dt>
<dd><p>Writes a data stored in a dictionary into a hdf5 at udatatapth
… datadict = {“name1”: value1, “name2”:value2, …} will be stored like /name1, /name2 in the hdf5 file
… datadict = {“grp1”: {“name1”: value1, “name2”:value2, …},</p>
<blockquote>
<div><blockquote>
<div><p>“grp1”: {“name1”: value1, “name2”:value2, …}, … }</p>
</div></blockquote>
<p>will be stored like /grp1/name1, /grp1/name2, /grp2/name1, /grp2/name2, …</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>a path to the hdf5 file</em>) – </p></li>
<li><p><strong>datadict</strong> (<em>dictionary</em><em>, or </em><em>a nested dictionary</em><em> (</em><em>up to level 2</em><em>)</em>) – … data must be stored like {“name1”: value1, “name2”: value2, …}</p></li>
<li><p><strong>grpname</strong> (<em>str</em>) – <dl class="simple">
<dt>… if given, it saves the datadict like</dt><dd><p>/grpname/name1, /grpname/name2</p>
</dd>
</dl>
</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it overwrite the data in the target hdf5 file</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it prints out details during saving the data</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.band_limited_noise2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">band_limited_noise2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.6666666666666667</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.band_limited_noise2d" title="Permalink to this definition"></a></dt>
<dd><p>Generates a 2D array of noise with a specific spectral distribution function (k^exponent)
… the output noise could be bandlimited [min_freq, max_freq]
… the output noise could have a simple frequency dependence
……exponent=0: White, exponent=-1, Pink, exponent=-5/3: Kolmogorov, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_freq</strong> (<em>float</em><em>, </em><em>the bandwidth of the noise is</em><em> [</em><em>min_freq</em><em>, </em><em>max_freq</em><em>]</em>) – </p></li>
<li><p><strong>max_freq</strong> (<em>float</em><em>, </em><em>the bandwidth of the noise is</em><em> [</em><em>min_freq</em><em>, </em><em>max_freq</em><em>]</em>) – </p></li>
<li><p><strong>nsamples</strong> (<em>int</em><em>, </em><em>number of samples in 1D</em><em> (</em><em>length of the field</em><em>)</em>) – </p></li>
<li><p><strong>samplerate</strong> (<em>float</em><em>, </em><em>spacing of the field</em>) – </p></li>
<li><p><strong>exponent</strong> (<em>float</em><em>, </em><em>frequency dependence of the noise</em><em>...</em><em> f^exponent</em>) – … This should be [-7.5, 0]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>noise</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array with shape (nsamples, nsamples)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2cyl">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2cyl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2cyl" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: cartesian to cylindrical coord
z = z
y = rho sin phi
x = rho cos phi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy array</em><em>, </em><em>cartesian x-coord</em>) – </p></li>
<li><p><strong>y</strong> (<em>numpy array</em><em>, </em><em>cartesian y-coord</em>) – </p></li>
<li><p><strong>z</strong> (<em>numpy array</em><em>, </em><em>cartesian z-coord</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rho, phi, z</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cylindrical coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2cyl_2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2cyl_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2cyl_2d" title="Permalink to this definition"></a></dt>
<dd><p>Transforms Cartesian (x, y) to Cylindrical (z’, rho’) coordinates
… This function is useful when an axisymmetry is present in the data.
… Cartesian-to-Cylindrical coordinate transformation is a mapping between R3 and R3.</p>
<blockquote>
<div><p>Axisymmetry makes a number of necessary variables to 2 from 3.
This function transforms (x, y) to (z’, rho’)
… The axis of symmetry is defined by y = a*x + b
… If a=b=0, z=x, rho=y</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>numpy array</em><em>, </em><em>x-coord</em>) – </p></li>
<li><p><strong>yy</strong> (<em>numpy array</em><em>, </em><em>y-coord</em>) – </p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>the axis of symmetry is given by y = a*x + b</em>) – </p></li>
<li><p><strong>b</strong> (<em>float</em><em>, </em><em>the axis of symmetry is given by y = a*x + b</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>This shifts the origin of the cylindrical coordinate system along the symmetry axis.</em>) – </p></li>
<li><p><strong>signed</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>the function returns the signed distance from the axis of symmetry.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>zz, rrho</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy arrays, cylindrical coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2cyl_2d_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2cyl_2d_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2cyl_2d_udata" title="Permalink to this definition"></a></dt>
<dd><p>Transforms a velocity field from the Cartesian (x, y) to Cylindrical (z’, rho’) basis
… This function is useful when an axisymmetry is present in the data.
… Cartesian-to-Cylindrical coordinate transformation is a mapping between R3 and R3.</p>
<blockquote>
<div><p>Axisymmetry makes a number of necessary variables to 2 from 3.
This function transforms (x, y) to (z’, rho’)
… The axis of symmetry is defined by y = a*x + b
… If a=b=0, z=x, rho=y</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>numpy array</em><em>, </em><em>x-coord</em>) – </p></li>
<li><p><strong>yy</strong> (<em>numpy array</em><em>, </em><em>y-coord</em>) – </p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>the axis of symmetry is given by y = a*x + b</em>) – </p></li>
<li><p><strong>b</strong> (<em>float</em><em>, </em><em>the axis of symmetry is given by y = a*x + b</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>This shifts the origin of the cylindrical coordinate system along the symmetry axis.</em>) – </p></li>
<li><p><strong>signed</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>the function returns the signed distance from the axis of symmetry.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata_cyl</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy arrays, velocity field in cylindrical coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2pol">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2pol" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: Cartesian coord to polar coord</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy array</em><em>, </em><em>x-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
<li><p><strong>y</strong> (<em>numpy array</em><em>, </em><em>y-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r</strong> (<em>numpy array, radius (polar)</em>)</p></li>
<li><p><strong>phi</strong> (<em>numpy array, angle (polar)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2pol_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2pol_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2pol_udata" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: Cartesian coord to polar coord (x, y, (ux, uy)) -&gt; (r, phi, (ur, uphi))
… Returns polar coordiantes AND velocity field in the polar basis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy array</em><em>, </em><em>x-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
<li><p><strong>y</strong> (<em>numpy array</em><em>, </em><em>y-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>array</strong> (<em>nd</em>) – </p></li>
<li><p><strong>field</strong> (<em>velocity</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r</strong> (<em>numpy array, radius (polar)</em>)</p></li>
<li><p><strong>phi</strong> (<em>numpy array, angle (polar)</em>)</p></li>
<li><p><em>udata_pol, nd array, velocity field in the polar basis (ur, uphi)</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2sph">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2sph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2sph" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: cartesian to spherical
z = r cos theta
y = r sin theta sin phi
x = r sin theta cos phi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy array</em><em>, </em><em>x-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
<li><p><strong>y</strong> (<em>numpy array</em><em>, </em><em>y-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
<li><p><strong>z</strong> (<em>numpy array</em><em>, </em><em>z-coord</em><em> (</em><em>Cartesian</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r</strong> (<em>radial distance</em>)</p></li>
<li><p><strong>theta</strong> (<em>polar angle [-pi/2, pi/2] (angle from the z-axis)</em>)</p></li>
<li><p><strong>phi</strong> (<em>azimuthal angle [-pi, pi] (angle on the x-y plane)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cart2sph_velocity">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cart2sph_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cart2sph_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: cartesian to spherical (x, y, z, (ux, uy, uz)) -&gt; (r, theta, phi, (ur, utheta, uphi))
… Returns a velocity field in the spherical basis
:param ux:
:type ux: numpy array, x-component of velocity field (Cartesian)
:param uy:
:type uy: numpy array, y-component of velocity field (Cartesian)
:param uz:
:type uz: numpy array, z-component of velocity field (Cartesian)
:param xx:
:type xx: numpy array, x-coord (Cartesian)
:param yy:
:type yy: numpy array, y-coord (Cartesian)
:param zz:
:type zz: numpy array, z-coord (Cartesian)
:param xc:
:type xc: float, x-coord of the origin of the spherical cordinate system
:param yc:
:type yc: float, y-coord of the origin of the spherical cordinate system
:param zc:
:type zc: float, z-coord of the origin of the spherical cordinate system</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>ur</strong> (<em>numpy array, radial component of velocity field in the spherical basis</em>)</p></li>
<li><p><strong>utheta</strong> (<em>numpy array, polar component of velocity field in the spherical basis</em>)</p></li>
<li><p><strong>uphi</strong> (<em>numpy array, azimuthal component of velocity field in the spherical basis</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cft_1d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cft_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cft_1d" title="Permalink to this definition"></a></dt>
<dd><p>Numerically evaluate the Fourier Transform of a function ‘g’ for given frequencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<em>function</em>) – </p></li>
<li><p><strong>f</strong> (<em>array-like</em><em>, </em><em>frequencies at which Fourier coefficients are calculated</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Fourier coefficients at given frequency</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.change_of_basis_mat_cart2sph">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">change_of_basis_mat_cart2sph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.change_of_basis_mat_cart2sph" title="Permalink to this definition"></a></dt>
<dd><p>Returns a change-of-basis matrix from a cartesian basis to a spherical basis
:param theta:
:type theta: float, polar angle [-pi/2, pi/2] (angle from the z-axis)
:param phi:
:type phi: float, azimuthal angle [-pi, pi] (angle on the x-y plane)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>Mc2s</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>3d array, change-of-basis matrix from cartesian to spherical</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>[ar, atheta, aphi] = np.matmul(Ms2c, [ax, ay, az]) # Convert from cartesian to spherical coordinates</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.change_of_basis_mat_sph2cart">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">change_of_basis_mat_sph2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.change_of_basis_mat_sph2cart" title="Permalink to this definition"></a></dt>
<dd><p>Returns a change-of-basis matrix from a spherical basis to a cartesian basis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em><em>, </em><em>polar angle</em><em> [</em><em>-pi/2</em><em>, </em><em>pi/2</em><em>] </em><em>(</em><em>angle from the z-axis</em><em>)</em>) – </p></li>
<li><p><strong>phi</strong> (<em>float</em><em>, </em><em>azimuthal angle</em><em> [</em><em>-pi</em><em>, </em><em>pi</em><em>] </em><em>(</em><em>angle on the x-y plane</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ms2c</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>3d array, change-of-basis matrix from spherical to cartesian</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>[ax, ay, az] = np.matmul(Ms2c, [ar, atheta, aphi]) # Convert from spherical to cartesian coordinates</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.clean_data">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">clean_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_org</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">makecopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.clean_data" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>This fills missing values (np.nan) in an array by one of the listed procedures below.</dt><dd><p>The options are
1. nearest neighbor filling (method = “nn”)- fast
2. filling with some constant (method = “fill”)- fast
3. filling with local mean (method = “localmean”)- slow
4. filling with an idw kernel (method = “idw”) - slow</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_org</strong> (<em>nd array</em><em>, </em><em>array to be cleaned</em>) – </p></li>
<li><p><strong>mask</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>choose from 'fill'</em><em>, </em><em>'nn'</em><em>, </em><em>'localmean'</em><em>, </em><em>'idw'</em>) – … computation is more expensive as it gets more right.
… fill: it filles</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>number of iterations conducted for the direct convolution methods</em>) – … When the method uses direct convolution, it repeats the operation until certain smoothness is achieved.
… relevant parameter for method==localmean or idw’</p></li>
<li><p><strong>tol</strong> (<em>relevant parameter for method==localmean</em><em> or </em><em>idw'</em>) – </p></li>
<li><p><strong>kernel_radius</strong> (<em>float</em><em>, </em><em>size of the kernel is 2 * kernel_radius + 1</em><em>, </em><em>relevant parameter for method==localmean'</em>) – </p></li>
<li><p><strong>kernel_sigma</strong> (<em>float</em><em>, </em><em>std of a gaussian kernel</em><em>, </em><em>relevant parameter for method==idw'</em>) – </p></li>
<li><p><strong>replace_val</strong> (<em>float</em><em>, </em><em>default: None. If not None</em><em>, </em><em>it replaces the values of the array with np.nan if value=replac_val.</em>) – <p>… This feature could be useful if the scalar data assigns a specific value instead of np.nans.
… This is certainly the case whenever DaVis outputs pressure. It outputs 0 instead of nan. This causes a problem as
0 could be physically meaningful while DaVis assigned that value solely because STB did not have sufficient tracks to</p>
<blockquote>
<div><p>infer the actual (intrinsic) value. In this case, simply replace all 0s with np.nan, then replace nans with nn, localmean, etc.</p>
</div></blockquote>
</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>default: np.inf. If not np.inf</em><em>, </em><em>it will invalidate values above cutoff.</em>) – </p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default: 0. If not 0</em><em>, </em><em>it will replace values above cutoff with fill_value</em>) – … relevant parameter for method==’fill’</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default: False. If True</em><em>, </em><em>it will print out the mean square difference between iterations</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True. If True</em><em>, </em><em>it will use tqdm_notebook instead of tqdm to show progress bar</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array with the same shape as data_org</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.clean_data_interp1d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">clean_data_interp1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.clean_data_interp1d" title="Permalink to this definition"></a></dt>
<dd><p>This function interpolates the missing and erroneous data using 1D interpolation.
… errorneous data points are identified by the rate of change of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>1/2d array with shape</em><em> (</em><em>n</em><em>,</em><em>) or </em><em>(</em><em>n</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>x</strong> (<em>1/2d array with shape</em><em> (</em><em>n</em><em>,</em><em>) or </em><em>(</em><em>n</em><em>, </em><em>duration</em><em>) </em><em>(</em><em>optional</em><em>)</em>) – … MUST have the same shape as y</p></li>
<li><p><strong>thd</strong> (<em>float</em>) – … threshold on the slope (dy/dx) used to spot the spurious values
… If np.abs( dy/dx )  / y) &lt; thd, the points in y will be removed, and will be interpolated as well as np.nan in y.</p></li>
<li><p><strong>p</strong> (<em>float</em><em>, </em><em>0 &lt; p &lt; 1</em>) – … if thd is None, it will remove (1-p) of the data points in y, and replaces with the interpolated values</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>x_output</strong> (<em>nd array with shape</em><em> (</em><em>n</em><em>, </em><em>1</em><em>) or </em><em>(</em><em>n</em><em>, </em><em>duration</em><em>)</em>) – … new x for new y</p></li>
<li><p><strong>y_output</strong> (<em>nd array with shape</em><em> (</em><em>n</em><em>, </em><em>1</em><em>) or </em><em>(</em><em>n</em><em>, </em><em>duration</em><em>)</em>) – … interpolated y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.clean_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">clean_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_zeros</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.clean_udata" title="Permalink to this definition"></a></dt>
<dd><p>Cleans up the velocity field udata.
… 1. Thresholding to spot unphysical values
… 2. Mask unphysical values, np.nan, and np.inf
… 3. ND interpolation over space (but NOT time) using direct convolution (replace_nan(…))
…… No interpolation over time is done because udata at two different frames do not have to be related in principle.
… 4. Median filter (optional) with kernel size = 2 * kernel_radius + 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field data with shape</em><em> (</em><em>no of components</em><em>, </em><em>y</em><em>, </em><em>x</em><em>, </em><em>(</em><em>z</em><em>)</em><em>, </em><em>t</em><em>) or  </em><em>(</em><em>no of components</em><em>, </em><em>y</em><em>, </em><em>x</em><em>, </em><em>(</em><em>z</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>mask</strong> (<em>nd array</em><em>, </em><em>same shape as udata</em><em>, </em><em>default: None</em>) – … If it were not None, this function interpolates the</p></li>
<li><p><strong>method</strong> (<em>str- options are 'fill'</em><em>, </em><em>'nn'</em><em>, </em><em>'local mean'</em><em>, </em><em>'idw'</em>) – … ‘fill’ (fill by a constant “fill_value”)
… ‘nn’ (nearest neighbor filling),
… ‘local mean’, relevant arg: kernel_radius=2
… ‘idw’ (convolution with a Gaussian kernel, relevant arg: “kernel_sigma”)</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>default: 10</em>) – … Number of iterations for inpainting until tolerance is reached</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>default: 0.05</em><em>, </em><em>tolerance for inpainting</em>) – </p></li>
<li><p><strong>kernel_radius</strong> (<em>int</em><em>, </em><em>default: 2</em><em>, </em><em>radius of the kernel for inpainting and median filter</em>) – </p></li>
<li><p><strong>kernel_sigma</strong> (<em>float</em><em>, </em><em>default: 2</em><em>, </em><em>sigma of the Gaussian kernel for inpainting if method == 'idw</em>) – </p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>If method=='fill'</em><em>, </em><em>the errorneous valeus are replaced by this fill_value.</em>) – </p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>a positive real number- Any velocity vector whose norm is greater than this cutoff is subject to cleaning.</em>) – </p></li>
<li><p><strong>median_filter</strong> (<em>bool</em><em>, </em><em>default: True. If True</em><em>, </em><em>a median filter is applied to the velocity field after inpainting/nearest-neighbor filling</em>) – </p></li>
<li><p><strong>replace_zeros</strong> (<em>bool default: True</em>) – … Some softwares assign 0 as a velocity instead of na or np.nan</p></li>
<li><p><strong>showtqdm</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … If True, show tqdm for the processes: 1. removing np.nan 2. applying a median filter</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, it shows a tqdm progress bar for the iterations of the direct convolution method</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it uses tqdm_notebook instead of tqdm</em>) – </p></li>
<li><p><strong>make_copy</strong> (<em>bool</em><em>, </em><em>default: True</em>) – <dl class="simple">
<dt>… If True, it creates a copy of the given udata, then modify the copied array.</dt><dd><p>Without copying, it modifies the given array directly. (Why?- it should create a new copy</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata_i</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, same shape as udatawith unphysical values replaced</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.clean_udata_cheap">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">clean_udata_cheap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoffU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.clean_udata_cheap" title="Permalink to this definition"></a></dt>
<dd><p>ONLY WORKS FOR THE 2D data
Conducts a cheap bilinear interpolation for missing data.
… literally, computes the average of the values interpolated in the x- and y-directions
… griddata performs a better interpolation but this method is much faster but not necessarily accurate.
… values near the edges must not be trusted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>cutoffU</strong> – </p></li>
<li><p><strong>fill_value</strong> – </p></li>
<li><p><strong>verbose</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.coarse_grain_2darr">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">coarse_grain_2darr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolumns_sub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.coarse_grain_2darr" title="Permalink to this definition"></a></dt>
<dd><p>Coarse-grain a 2D array
… Coarse-graining a MxN array means a following procedure.</p>
<blockquote>
<div><p>1. Divide an MxN array into blocks of (m x n) arrays
… m=nrows_sub, n=ncolumns_sub
2. Replace each block by an average of the values in the block</p>
</div></blockquote>
<p>… If you are not familiar with coarse-graining, consult with Kadanoff’s block-spin renormalization group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>nrows_sub</strong> (<em>int</em><em>, </em><em>Number of rows of blocks</em><em> (</em><em>over which values are averaged</em><em>)</em>) – </p></li>
<li><p><strong>ncolumns_sub</strong> (<em>int</em><em>, </em><em>Number of columns of blocks</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>arr_coarse</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>coarse-grained 2d arr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.coarse_grain_2darr_overwrap">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">coarse_grain_2darr_overwrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolumns_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.coarse_grain_2darr_overwrap" title="Permalink to this definition"></a></dt>
<dd><p>Coarse-grain 2D arrays with overwrap (mimics how PIVLab processes a velocity field)</p>
<dl>
<dt>arr= [[ 0  1  2  3  4  5]</dt><dd><blockquote>
<div><p>[ 6  7  8  9 10 11]
[12 13 14 15 16 17]
[18 19 20 21 22 23]
[24 25 26 27 28 29]
[30 31 32 33 34 35]]</p>
</div></blockquote>
<p>-&gt; Make a new array. (nrows_sub=4, ncolumns_sub=4, overwrap=0.5)</p>
</dd>
<dt>array([[  0.,   1.,   2.,   3.,   2.,   3.,   4.,   5.],</dt><dd><blockquote>
<div><p>[  6.,   7.,   8.,   9.,   8.,   9.,  10.,  11.],
[ 12.,  13.,  14.,  15.,  14.,  15.,  16.,  17.],
[ 18.,  19.,  20.,  21.,  20.,  21.,  22.,  23.],
[ 12.,  13.,  14.,  15.,  14.,  15.,  16.,  17.],
[ 18.,  19.,  20.,  21.,  20.,  21.,  22.,  23.],
[ 24.,  25.,  26.,  27.,  26.,  27.,  28.,  29.],
[ 30.,  31.,  32.,  33.,  32.,  33.,  34.,  35.]])</p>
</div></blockquote>
<p>-&gt; Coarse-grain (output)</p>
</dd>
<dt>array([[ 10.5,  12.5],</dt><dd><p>[ 22.5,  24.5]])</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>nrows_sub</strong> (<em>int</em><em>, </em><em>Number of rows of blocks</em><em> (</em><em>over which values are averaged</em><em>)</em>) – </p></li>
<li><p><strong>ncolumns_sub</strong> (<em>int</em><em>, </em><em>Number of columns of blocks</em>) – </p></li>
<li><p><strong>overwrap</strong> (<em>fraction of overwrap</em><em>, </em><em>default=0.5</em><em>, </em><em>[</em><em>0</em><em>, </em><em>1</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>arr_coarse</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>coarse-grained 2d arr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.coarse_grain_3darr">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">coarse_grain_3darr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrow_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndep_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.coarse_grain_3darr" title="Permalink to this definition"></a></dt>
<dd><p>Coarse-grain a 3d array
… The idea is to split the original array into many subcells, and average over each subcell
… The cell size is (nrow_sub, ncol_sub, ndep_sub)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>3d array to be coarse-grained</em>) – </p></li>
<li><p><strong>nrow_sub</strong> (<em>int</em><em>, </em><em>number of rows of the subcell</em>) – </p></li>
<li><p><strong>ncol_sub</strong> (<em>int</em><em>, </em><em>number of columns of the subcell</em>) – </p></li>
<li><p><strong>ndep_sub</strong> (<em>int</em><em>, </em><em>number of depths</em><em>(</em><em>steps</em><em>) </em><em>of the subcell</em>) – </p></li>
<li><p><strong>overwrap</strong> (<em>float</em><em>, </em><em>[</em><em>0</em><em>, </em><em>1</em><em>)</em>) – </p></li>
<li><p><strong>showtqdm</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_arr</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>coarse-grained 3d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.coarse_grain_3dudata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">coarse_grain_3dudata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrow_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndep_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.coarse_grain_3dudata" title="Permalink to this definition"></a></dt>
<dd><p>Coarse-grain a 3d udata
… 3d udata has a shape (dim=3, nrows, ncols, ndeps, duration) or (dim=3, nrows, ncols, ndeps)
… The idea is to split the original array into many subcells, and average over each subcell
… The cell size is (nrow_sub, ncol_sub, ndep_sub)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata_3d</strong> (<em>4d</em><em> or </em><em>5d array</em><em>, </em><em>udata</em>) – … udata is just a nd array.</p></li>
<li><p><strong>nrow_sub</strong> (<em>int</em><em>, </em><em>number of rows of the subcell</em>) – </p></li>
<li><p><strong>ncol_sub</strong> (<em>int</em><em>, </em><em>number of columns of the subcell</em>) – </p></li>
<li><p><strong>ndep_sub</strong> (<em>int</em><em>, </em><em>number of depths</em><em>(</em><em>steps</em><em>) </em><em>of the subcell</em>) – </p></li>
<li><p><strong>overwrap</strong> (<em>float</em><em>, </em><em>[</em><em>0</em><em>, </em><em>1</em><em>)</em>) – </p></li>
<li><p><strong>showtqdm</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata_cg</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>coarse-grained ud</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.coarse_grain_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">coarse_grain_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolumns_sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.coarse_grain_udata" title="Permalink to this definition"></a></dt>
<dd><p>Returns a coarse grained udata
… so far, this can handle only 2D udata
:param udata:
:type udata: nd array, velocity field
:param nrows_sub:
:type nrows_sub: int, number of rows in the sub-grid
:param ncolumns_sub:
:type ncolumns_sub: int, number of columns in the sub-grid
:param overwrap:
:type overwrap: float, fraction of the sub-grid that is overlapped with the original grid, [0, 1]
:param xx:
:type xx: nd array, x-coordinates of the original grid
:param yy:
:type yy: nd array, y-coordinates of the original grid</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>udata_sub</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>nd array, coarse grained velocity field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.computeImageDistanceUsingHuMoments">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">computeImageDistanceUsingHuMoments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.computeImageDistanceUsingHuMoments" title="Permalink to this definition"></a></dt>
<dd><p>Returns the image distance between two images
:param img1:
:type img1: 2d array- the elements must be between 0 and 255.
:param img2:
:type img2: 2d array- the elements must be between 0 and 255.
:param method:
:type method: this method gets passed to cv2.matchShapes (e.g.- cv2.CONTOURS_MATCH_I1, cv2.CONTOURS_MATCH_I2, cv2.CONTOURS_MATCH_I3)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>imgDist- a scalar quantity which represents a distance between two images based on the (logarithmic) Hu moments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_circulation">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_circulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_circulation" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Returns circulation along a given contour (if None, a circular contour by default) with udata and spatial grids as inputs</dt><dd><dl class="simple">
<dt>… it is compatible with spatially 2D/3D udata</dt><dd><p>Yet, 2D udata is probably easier to handle. If you need a sliced velocity field from a volumetric udata,
consider using slice_udata_3d()</p>
</dd>
</dl>
<p>… For 3D udata, you probably want to pass a contour manually.
… Default contour is a circle(s) with radius of 10 and its center at (xc, yc) or (xc, yc, zc).</p>
<blockquote>
<div><p>If you want the contours with multiple radii, try something like rs = [10, 20, 25, …]</p>
</div></blockquote>
<p>… if you want to draw contours later, you can output pts on the contours by setting return_contours True.</p>
</dd>
<dt>How it works:</dt><dd><p>It computes a Riemann sum of addends defined by velocity cdot dl at each point on the contour.
… In case of</p>
<blockquote>
<div><blockquote>
<div><ol class="arabic simple">
<li><p>a part of the contour were out of the plane / volume</p></li>
<li><p>udata contains nans at a point on the contour</p></li>
</ol>
</div></blockquote>
<p>this function first computes the average of the addends, then multiples the avg by the number of pts along the contour.
This way, it still computes the correct value of circulation if these cases occur, and still outputs
somewhat meaningful values even if these cases occur.</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>ndarray</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>xx</strong> (<em>ndarray</em><em>, </em><em>x-coordinates of the grid</em><em> (</em><em>real space</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>ndarray</em><em>, </em><em>y-coordinates of the grid</em><em> (</em><em>real space</em><em>)</em>) – </p></li>
<li><p><strong>zz</strong> (<em>ndarray</em><em>, </em><em>z-coordinates of the grid</em><em> (</em><em>real space</em><em>)</em>) – </p></li>
<li><p><strong>contour</strong> (<em>2d array with shape</em><em> (</em><em>n</em><em>, </em><em>dim</em><em>)</em><em>, </em><em>default: None</em>) – <dl class="simple">
<dt>… contour must be closed but it is not necessary to pass a closed contour.</dt><dd><p>The contour will be closed by connecting the first and last pts in this array.
(It is also okay to pass a contour with an array of a closed contour to this function)</p>
</dd>
</dl>
<p>… A default contour is circular with a radius (or radii) of 10 around the center (xc, yc, zc)
… contour[:, 0]- x-coords of pts on the contour</p>
<blockquote>
<div><p>contour[:, 1]- y-coords of pts on the contour
contour[:, 2]- z-coords of pts on the contour</p>
</div></blockquote>
</p></li>
<li><p><strong>rs</strong> (<em>list</em><em>, </em><em>radii in the same units as xx/yy/zz</em>) – … only relevant if “contours” is None</p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>x-coordinate of the center of a circular contour</em><em>(</em><em>s</em><em>)</em><em>, </em><em>default:0.</em>) – … only relevant if “contours” is None</p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>y-coordinate of the center of a circular contour</em><em>(</em><em>s</em><em>)</em><em>, </em><em>default:0.</em>) – … only relevant if “contours” is None</p></li>
<li><p><strong>zc</strong> (<em>float</em><em>, </em><em>z-coordinate of the center of a circular contour</em><em>(</em><em>s</em><em>)</em><em>, </em><em>default:0.</em>) – … only relevant if “contours” is None</p></li>
<li><p><strong>n</strong> (<em>number of sampled pts on the circular contour</em>) – … only relevant if “contours” is None</p></li>
<li><p><strong>return_contours</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, it returns pts on the contour(s)
… This feature could be handy if you’d like to plot the contour(s) later</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gammas</strong> (<em>nd array with shape (duration, ) or (len(rs), duration), circulation values</em>)</p></li>
<li><p><strong>contours</strong> (<em>nd array (optional)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_energy_current_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_energy_current_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.000997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_energy_current_from_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_energy_flux">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_energy_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.000997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_energy_flux" title="Permalink to this definition"></a></dt>
<dd><p>Returns the energy flux (int (Energy current density) dS in nW
… If flux_density is True, it returns the energy flux per unit area in nW / mm^2
… Units guide: [udata], [xx] = L/T, L.</p>
<blockquote>
<div><p>The dimension of the energy flux is [e_flux] = [rho * udata**3 * dS] = ML^2/T^3 = [W=J/s]
… This represents the amount of energy flow through the surface per unit time.</p>
</div></blockquote>
<dl class="simple">
<dt>… If flux_density is True, this returns the energy flux density- simply energy flux divided by the surface area</dt><dd><p>The dimension of the energy flux DENSITY is [e_flux density] = M/T^3 = [W] / L^2
… This represents the amount of energy flow through the surface per unit time.</p>
</dd>
<dt>… Sample case: [udata], [xx] = mm/s, mm</dt><dd><p>… The dimension of energy flux: ML^2/T^3 = g mm^2/s^3 = nW
… The dimension of energy flux density: nW / mm^2</p>
</dd>
</dl>
<p>n: number of gaussian surfaces considered</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_energy_flux_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_energy_flux_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.000997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_energy_flux_from_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_form_no">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_form_no</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stroke_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orifice_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piston_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_orifices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_form_no" title="Permalink to this definition"></a></dt>
<dd><p>Returns a formation number with stroke length as an input
… Old box (small): orifice_d=20, piston_d=125
… New box (3D printed): orifice_d=25.6, piston_d=160</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stroke_length</strong> (<em>float/1d array</em><em>, </em><em>stroke length in mm</em>) – </p></li>
<li><p><strong>orifice_d</strong> (<em>float</em><em>, </em><em>orifice diameter in mm</em>) – </p></li>
<li><p><strong>piston_d</strong> (<em>float</em><em>, </em><em>piston diameter in mm</em>) – </p></li>
<li><p><strong>num_orifices</strong> (<em>int</em><em>, </em><em>number of orifices</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>LD</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float/1d array, formation number</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_kolmogorov_lengthscale_simple">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_kolmogorov_lengthscale_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_kolmogorov_lengthscale_simple" title="Permalink to this definition"></a></dt>
<dd><p>Return Kolmogorov length scale for a given set of dissipation rate and viscosity
:param epsilon:
:type epsilon: float, dissipation rate
:param nu:
:type nu: float, viscosity</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>eta, float, Kolmogorov length scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_line_integral">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_line_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_line_integral" title="Permalink to this definition"></a></dt>
<dd><p>A wrapper for compute_circulation_along_contour()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_mass_flux">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_mass_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.000997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_mass_flux" title="Permalink to this definition"></a></dt>
<dd><p>Returns the energy flux (int (mass current density) dS in M/T
… If flux_density is True, it returns the energy flux per unit area in M/(L^2 T)
… Units guide: [udata], [xx] = L/T, L.</p>
<blockquote>
<div><p>The dimension of the energy flux is [mass_flux] = [rho * udata * dS] = M/T
… This represents the amount of energy flow through the surface per unit time.</p>
</div></blockquote>
<dl class="simple">
<dt>… If flux_density is True, this returns the energy flux density- simply energy flux divided by the surface area</dt><dd><p>The dimension of the energy flux DENSITY is [mass_flux density] = M/(L^2 T)
… This represents the amount of energy flow through the surface per unit time.</p>
</dd>
<dt>… Sample case: [udata], [xx] = mm/s, mm</dt><dd><p>… The dimension of energy flux: M/T = g /s
… The dimension of energy flux density: M/(L^2 T)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_net_energy_current">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_net_energy_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.000997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_net_energy_current" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns the integral of energy flux (Net energy current inside the Gaussian sphere)</dt><dd><p>Net energy current = int_0^{R} (energy current density) cdot dS dr</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_ring_circulation_from_master_curve">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_ring_circulation_from_master_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_ring_circulation_from_master_curve" title="Permalink to this definition"></a></dt>
<dd><p>Given a stroke length, this function returns circulation of a vortex ring in a vortex ring collider
… well tested over time
… units: mm2/s
e.g.-</p>
<blockquote>
<div><p>r = compute_ring_radius_from_master_curve(8.2, setting=’small’)
v = compute_ring_velocity_from_master_curve(8.2, estimate_veff(8.2, 200), setting=’small’)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float/array</em>) – … stroke length in mm</p></li>
<li><p><strong>veff</strong> (<em>float/array</em>) – … effective piston velocity- (&lt;vp&gt;^2 / &lt;vp&gt; )
… this quantitty can be estimated from estimate_veff(commanded_stroke_length, commanded_stroke_velocity)</p></li>
<li><p><strong>dp</strong> (<em>float</em>) – …. piston diameter in mm</p></li>
<li><p><strong>float</strong> (<em>do</em>) – … orfice diameter in mm</p></li>
<li><p><strong>N</strong> (<em>int/float</em>) – … number of oricies</p></li>
<li><p><strong>lowerGamma</strong> (<em>float</em>) – … experimental constant, default: 2.2
… This represents the ratio of semi-major to semi-minor radius when a vortex bubble is approximated as an ellipsoid</p></li>
<li><p><strong>setting</strong> (<em>str</em>) – … vortex ring collider versions
… choose from ‘medium’ or ‘small’
… ‘medium’ refers to the chamber configuration to create D=10cm blobs
… ‘small’ refers to the chamber configuration to create D=5cm blobs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>velocity</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float/array, velocity of the ring</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_ring_radius_from_master_curve">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_ring_radius_from_master_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowerGamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_ring_radius_from_master_curve" title="Permalink to this definition"></a></dt>
<dd><p>Given a stroke length, this function returns a radius of a vortex ring in a vortex ring collider
… well tested over time
… units: mm
e.g.-</p>
<blockquote>
<div><p>r = compute_ring_radius_from_master_curve(8.2, setting=’small’)
v = compute_ring_velocity_from_master_curve(8.2, estimate_veff(8.2, 200), setting=’small’)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float/array</em>) – … stroke length in mm</p></li>
<li><p><strong>dp</strong> (<em>float</em>) – …. piston diameter in mm</p></li>
<li><p><strong>float</strong> (<em>do</em>) – … orfice diameter in mm</p></li>
<li><p><strong>N</strong> (<em>int/float</em>) – … number of oricies</p></li>
<li><p><strong>lowerGamma</strong> (<em>float</em>) – … experimental constant, default: 2.2
… This represents the ratio of semi-major to semi-minor radius when a vortex bubble is approximated as an ellipsoid</p></li>
<li><p><strong>setting</strong> (<em>str</em>) – … vortex ring collider versions
… choose from ‘medium’ or ‘small’
… ‘medium’ refers to the chamber configuration to create D=10cm blobs
… ‘small’ refers to the chamber configuration to create D=5cm blobs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>radius</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float/array, radius of the rings</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_ring_velocity_from_master_curve">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_ring_velocity_from_master_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_ring_velocity_from_master_curve" title="Permalink to this definition"></a></dt>
<dd><p>Given a stroke length, this function returns self-induced velocity of a vortex ring in a vortex ring collider
… well tested over time
… units: mm/s
e.g.-</p>
<blockquote>
<div><p>r = compute_ring_radius_from_master_curve(8.2, setting=’small’)
v = compute_ring_velocity_from_master_curve(8.2, estimate_veff(8.2, 200), setting=’small’)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>float/array</em>) – … stroke length in mm</p></li>
<li><p><strong>veff</strong> (<em>float/array</em>) – … effective piston velocity- (&lt;vp&gt;^2 / &lt;vp&gt; )
… this quantitty can be estimated from estimate_veff(commanded_stroke_length, commanded_stroke_velocity)</p></li>
<li><p><strong>dp</strong> (<em>float</em>) – …. piston diameter in mm</p></li>
<li><p><strong>float</strong> (<em>do</em>) – … orfice diameter in mm</p></li>
<li><p><strong>N</strong> (<em>int/float</em>) – … number of oricies</p></li>
<li><p><strong>lowerGamma</strong> (<em>float</em>) – … experimental constant, default: 2.2
… This represents the ratio of semi-major to semi-minor radius when a vortex bubble is approximated as an ellipsoid</p></li>
<li><p><strong>setting</strong> (<em>str</em>) – … vortex ring collider versions
… choose from ‘medium’ or ‘small’
… ‘medium’ refers to the chamber configuration to create D=10cm blobs
… ‘small’ refers to the chamber configuration to create D=5cm blobs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>velocity</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float/array, velocity of the ring</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_rms">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_rms" title="Permalink to this definition"></a></dt>
<dd><p>Returns the root mean square of qty</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qty</strong> (<em>nd array</em><em>, </em><em>quantity</em>) – </p></li>
<li><p><strong>axes</strong> (<em>list of ints</em><em>, </em><em>axes to compute rms over</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rms</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, root mean square of qty</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_signal_loss_due_to_windowing">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_signal_loss_due_to_windowing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_signal_loss_due_to_windowing" title="Permalink to this definition"></a></dt>
<dd><p>Returns the inverse of the signal-loss factor by the window
Signal loss factor: 1 (rectangle… no loss), 0.2-ish (flattop)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d/3d numpy array</em>) – x grid</p></li>
<li><p><strong>yy</strong> (<em>2d/3d numpy array</em>) – y grid</p></li>
<li><p><strong>window</strong> (<em>str</em>) – name of the window: flattop, hamming, blackman, etc.</p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify the region to which the window applies: xx[y0:y1, x0:x1], yy[y0:y1, x0:x1]</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify the region to which the window applies: xx[y0:y1, x0:x1], yy[y0:y1, x0:x1]</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify the region to which the window applies: xx[y0:y1, x0:x1], yy[y0:y1, x0:x1]</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify the region to which the window applies: xx[y0:y1, x0:x1], yy[y0:y1, x0:x1]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gamma</strong> – inverse of the signal-loss factor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_spatial_autocorr">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_spatial_autocorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_spatial_autocorr" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>[DEPRICATED] Use get_two_point_vel_corr() instead.</p>
<p>Compute spatial autocorrelation (two-point correlation) function of 2D velocity field using np.roll
Spatial autocorrelation function:</p>
<blockquote>
<div><p>f = &lt;u_j(</p>
</div></blockquote>
</div></blockquote>
<p>ec{x}) u_j(
ec{x}+rhat{x_i})&gt; / &lt;u_j(
ec{x})^2&gt;</p>
<blockquote>
<div><p>where velocity vector u = (u1, u2).
If i = j, f is called longitudinal autocorrelation function.
Otherwise, f is called transverse autocorrelation function.</p>
<dl>
<dt>Example:</dt><dd><p>u = ux # shape(height, width, duration)
<a href="#id41"><span class="problematic" id="id42">x_</span></a>, <a href="#id43"><span class="problematic" id="id44">y_</span></a>  = range(u.shape[1]), range(u.shape[0])
x, y = np.meshgrid(<a href="#id45"><span class="problematic" id="id46">x_</span></a>, <a href="#id47"><span class="problematic" id="id48">y_</span></a>)</p>
<p># LONGITUDINAL AUTOCORR FUNC
rrs, corrs, corr_errs = compute_spatial_autocorr(u, x, y, roll_axis=1)  # roll_axis is i in the description above</p>
<p># TRANSVERSE AUTOCORR FUNC
rrs, corrs, corr_errs = compute_spatial_autocorr(u, x, y, roll_axis=0)  # roll_axis is i in the description above</p>
</dd>
</dl>
<p>ui: numpy array, one-component velocity field i.e. shape: (height, width, duration)
x: numpy array, 2d grid
y: numpy array, 2d grid
roll_axis: int, axis index to compute correlation… 0 for y-axis, 1 for x-axis
n_bins: int, number of bins to compute statistics
x0: int, index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
x1: int, index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
y0: int, index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
y1: int, index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
t0: int, index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
t1: int, index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
coarse: float (0, 1], This parameter determines the bin width (int(1. / coarse)) of the spatial autocorrelation function.
coarse2: float (0, 1], This parameter is used to control the number of data points to compute a correlation value at a particular distance.</p>
<blockquote>
<div><p>… 1: all data points are used
… 0.5: only a half of data points are used</p>
</div></blockquote>
<p>rr: 2d numpy array, (distance, time)
corr: 2d numpy array, (autocorrelation values, time)
corr_err: 2d numpy array, (std of autocorrelation values, time)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_spatial_autocorr3d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_spatial_autocorr3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_spatial_autocorr3d" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>[DEPRICATED] Use get_two_point_vel_corr instead.</p>
<p>Compute spatial autocorrelation function of 2+1 velocity field using np.roll()
Spatial autocorrelation function:</p>
<blockquote>
<div><p>f = &lt;u_j(</p>
</div></blockquote>
</div></blockquote>
<p>ec{x}) u_j(
ec{x}+rhat{x_i})&gt; / &lt;u_j(
ec{x})^2&gt;</p>
<blockquote>
<div><p>where velocity vector u = (u1, u2).
If i = j, f is called longitudinal autocorrelation function.
Otherwise, f is called transverse autocorrelation function.</p>
<dl>
<dt>Example:</dt><dd><p>u = ux # shape(height, width, duration)
<a href="#id49"><span class="problematic" id="id50">x_</span></a>, <a href="#id51"><span class="problematic" id="id52">y_</span></a>  = range(u.shape[1]), range(u.shape[0])
x, y = np.meshgrid(<a href="#id53"><span class="problematic" id="id54">x_</span></a>, <a href="#id55"><span class="problematic" id="id56">y_</span></a>)</p>
<p># LONGITUDINAL AUTOCORR FUNC
rrs, corrs, corr_errs = compute_spatial_autocorr(u, x, y, roll_axis=1)  # roll_axis is i in the description above</p>
<p># TRANSVERSE AUTOCORR FUNC
rrs, corrs, corr_errs = compute_spatial_autocorr(u, x, y, roll_axis=0)  # roll_axis is i in the description above</p>
</dd>
</dl>
<p>ui: numpy array, 3 + 1 scalar field. i.e. shape: (height, width, duration)
x: numpy array, 3d grid
y: numpy array, 3d grid
z: numpy array, 3d grid
roll_axis: int, axis index to compute correlation… 0 for y-axis, 1 for x-axis, 2 for z-axis
n_bins: int, number of bins to compute statistics
x0: int, index to specify a portion of data in which autocorrelation funciton is computed. Will use data u[y0:y1, x0:x1, z0:z1, t0:t1].
x1: int, index to specify a portion of data in which autocorrelation funciton is computed.
y0: int, index to specify a portion of data in which autocorrelation funciton is computed.
y1: int, index to specify a portion of data in which autocorrelation funciton is computed.
z0: int, index to specify a portion of data in which autocorrelation funciton is computed.
z1: int, index to specify a portion of data in which autocorrelation funciton is computed.
t0: int, index to specify a portion of data in which autocorrelation funciton is computed.
t1: int, index to specify a portion of data in which autocorrelation funciton is computed.
coarse: float (0, 1], Process coarse * possible data points. This is an option to output coarse results.
coarse2: float (0, 1], Rolls matrix
Returns
——-
rr: 2d numpy array, (distance, time)
corr: 2d numpy array, (autocorrelation values, time)
corr_err: 2d numpy array, (std of autocorrelation values, time)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_streamfunction_direct">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_streamfunction_direct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nctrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sampled_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cartesian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_streamfunction_direct" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><dl class="simple">
<dt>Returns a streamfunction of a given udata in a ND array by computing</dt><dd><p>psi = int_A^B udy - vdx  (cartesian)
psi = int_A^B</p>
</dd>
</dl>
</div></blockquote>
<p>ho uz drho - urho dz  (cyindrical)</p>
<blockquote>
<div><p>… udata must be non-divergent</p>
<p>udata
xx: 2d array, a positional grid (x)</p>
<blockquote>
<div><p>… If coordinate_system == ‘cylindrical’, this will be interpreted as a grid of z</p>
</div></blockquote>
<dl>
<dt>yy: 2d array, a positional grid (y)</dt><dd><p>… If coordinate_system == ‘cylindrical’, this will be interpreted as a grid of rho=np.sqrt(x**2 + y**2)</p>
</dd>
<dt>xref: float, default: 0</dt><dd><p>… reference point of a streamfunction
… The contour integral will be calculated between (xref, yref) and (xp, yp)</p>
<blockquote>
<div><p>(xp, yp) will be sampled from the given positinal grid.</p>
</div></blockquote>
</dd>
<dt>yref: float, default: 0</dt><dd><p>… reference point of a streamfunction
… The contour integral will be calculated between (xref, yref) and (xp, yp)</p>
<blockquote>
<div><p>(xp, yp) will be sampled from the given positinal grid.</p>
</div></blockquote>
</dd>
</dl>
<p>inc: int, sampling frequency of (xp, yp) out of the positional grid (xx and yy)
nctrs: int, must be greater than or equal to 1</p>
<blockquote>
<div><p>… number of contours used to compute the streamfunction value at the given point
… the streamfunction values could be different depending on the contour due to discreteness of data</p>
<blockquote>
<div><p>… divergent field will also result in such a discrepancy
udata must be non-divergent in order for the streamfunction to exist</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>nsample: int, default: 100</dt><dd><p>… number of sampled points on each contour to compute the integral,</p>
</dd>
<dt>nkinks: int, must be greater or equal to 2</dt><dd><p>… this controls how wiggly contours are if the contours were not given by the user</p>
</dd>
<dt>noise: array-like with two elements, default: None</dt><dd><p>… This controls the maximum amplitude of the wiggle.</p>
</dd>
<dt>return_sampled_grid: bool, default: False</dt><dd><dl class="simple">
<dt>… If True, this will return positional grids (xx_s, yy_s) used to sample the streamfunction values.</dt><dd><p>This becomes handy if inc is not equal to 1. You can always plot the result as ax.pcolormesh(xx_s, yy_s, psi)</p>
</dd>
</dl>
</dd>
<dt>coordinate_system: str, default: ‘cartesian’</dt><dd><dl class="simple">
<dt>… the form of the contour integral to compute the stream function depends on the coordinate system</dt><dd><p>psi = int u dy - v dx (Cartesian, 2D)
psi = int</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>ho (u_z drho - u_rho dz) (Cylindrical, 3D-axisymmetric)</dt><dd><dl>
<dt>notebook: bool, default: True</dt><dd><dl class="simple">
<dt>… If True, it uses tqdm.tqdm_notebook for a progress bar.</dt><dd><p>(a natural choise if you run the code on Jupyter notebooks)</p>
</dd>
</dl>
<p>… If False, it uses tqdm.tqdm for a progress bar.</p>
</dd>
</dl>
<p>psi_master, psi_err_master, xx_sampled (Optional), yy_sampled (Optional)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_streamfunction_values">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_streamfunction_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nctrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_streamfunction_values" title="Permalink to this definition"></a></dt>
<dd><p>Returns a streamfunction value at a point (x, y) for 2D incompressible flows
with respect to the value at the reference (xref, yref)</p>
<p>… Computes a contour integral int_A^B udy - vdx
… Requires bezier module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>xx</strong> – </p></li>
<li><p><strong>yy</strong> – </p></li>
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>xref</strong> – </p></li>
<li><p><strong>float</strong> – </p></li>
<li><p><strong>point</strong> (<em>...</em><em> y coordinate of the reference</em>) – </p></li>
<li><p><strong>yref</strong> – </p></li>
<li><p><strong>float</strong> – </p></li>
<li><p><strong>point</strong> – </p></li>
<li><p><strong>contours</strong> (<em>3d array with shape</em><em> (</em><em>number of contours</em><em>, </em><em>number of points on each contour</em><em>, </em><em>2</em><em>)</em><em>, </em><em>default: None</em>) – <p>E.g. (x, y) on the 3rd contour is stored as (contours[2, :, 0], contours[2, :, 1])
… By default, it generates nctrs contours connecting (xref, yref) and (x, y)</p>
<blockquote>
<div><p>It generates non-selfintersecting, smooth conours. It could be non-smooth if (xref, yref) == (x, y)</p>
</div></blockquote>
</p></li>
<li><p><strong>nctrs</strong> (<em>int</em><em>, </em><em>must be greater than</em><em> or </em><em>equal to 1</em>) – <p>… number of contours used to compute the streamfunction value at the given point
… the streamfunction values could be different depending on the contour due to discreteness of data</p>
<blockquote>
<div><p>… divergent field will also result in such a discrepancy
udata must be non-divergent in order for the streamfunction to exist</p>
</div></blockquote>
</p></li>
<li><p><strong>nsample</strong> (<em>int</em><em>, </em><em>default: 100</em>) – … number of sampled points on each contour to compute the integral,</p></li>
<li><p><strong>nkinks</strong> (<em>int</em><em>, </em><em>must be greater</em><em> or </em><em>equal to 2</em>) – … this controls how wiggly contours are if the contours were not given by the user</p></li>
<li><p><strong>noise</strong> (<em>array-like with two elements</em><em>, </em><em>default: None</em>) – … This controls the maximum amplitude of the wiggle.</p></li>
<li><p><strong>return_contours</strong> – … If True, it returns contours used to compute the integral.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>psis</strong> (<em>nd array with shape=(nctrs, udata.shape[-1)</em>)</p></li>
<li><p><strong>contours (optional)</strong> (<em>points on the contours used to compute the streamfunction value</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.compute_streamfunction_values_cylindrical">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">compute_streamfunction_values_cylindrical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata_cylindrical</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rrho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhoref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nctrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.compute_streamfunction_values_cylindrical" title="Permalink to this definition"></a></dt>
<dd><p>Returns a streamfunction value at a point (x, y) for 3D, axisymmetric flows
with respect to the value at the reference (xref, yref)</p>
<p>… Computes a contour integral int_A^B rho (u_z drho - u_rho dz)
… Requires bezier module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata_cylindrical</strong> (<em>nd array</em><em>, </em><em>(</em><em>u_z</em><em>, </em><em>u_rho</em><em>)</em>) – </p></li>
<li><p><strong>zz</strong> – </p></li>
<li><p><strong>rrho</strong> – </p></li>
<li><p><strong>z</strong> – </p></li>
<li><p><strong>rho</strong> – </p></li>
<li><p><strong>zref</strong> – </p></li>
<li><p><strong>float</strong> – </p></li>
<li><p><strong>rhoref</strong> – </p></li>
<li><p><strong>float</strong> – </p></li>
<li><p><strong>contours</strong> (<em>3d array with shape</em><em> (</em><em>number of contours</em><em>, </em><em>number of points on each contour</em><em>, </em><em>2</em><em>)</em><em>, </em><em>default: None</em>) – <p>E.g. (x, y) on the 3rd contour is stored as (contours[2, :, 0], contours[2, :, 1])
… By default, it generates nctrs contours connecting (xref, yref) and (x, y)</p>
<blockquote>
<div><p>It generates non-selfintersecting, smooth conours. It could be non-smooth if (xref, yref) == (x, y)</p>
</div></blockquote>
</p></li>
<li><p><strong>nctrs</strong> (<em>int</em><em>, </em><em>must be greater than</em><em> or </em><em>equal to 1</em>) – <p>… number of contours used to compute the streamfunction value at the given point
… the streamfunction values could be different depending on the contour due to discreteness of data</p>
<blockquote>
<div><p>… divergent field will also result in such a discrepancy
udata must be non-divergent in order for the streamfunction to exist</p>
</div></blockquote>
</p></li>
<li><p><strong>nsample</strong> (<em>int</em><em>, </em><em>default: 100</em>) – … number of sampled points on each contour to compute the integral,</p></li>
<li><p><strong>nkinks</strong> (<em>int</em><em>, </em><em>must be greater</em><em> or </em><em>equal to 2</em>) – … this controls how wiggly contours are if the contours were not given by the user</p></li>
<li><p><strong>noise</strong> (<em>array-like with two elements</em><em>, </em><em>default: None</em>) – … This controls the maximum amplitude of the wiggle.</p></li>
<li><p><strong>return_contours</strong> – … If True, it returns contours used to compute the integral.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>psis</strong> (<em>nd array with shape=(nctrs, udata.shape[-1)</em>)</p></li>
<li><p><strong>contours (optional)</strong> (<em>points on the contours used to compute the streamfunction value</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.convertNDto1D">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">convertNDto1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ef_nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.convertNDto1D" title="Permalink to this definition"></a></dt>
<dd><p>Returns a shell-to-shell contribution from ND array
Converts ND array into 1D array (primarily used for Energy spectrum computation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ef_nd</strong> (<em>ND array</em><em>, </em><em>assuming energy density in the frequency space</em>) – </p></li>
<li><p><strong>freqs</strong> (<em>ND array</em><em>, </em><em>frequency grid</em>) – … assuming np.stack((fxx, fyy)) or np.stack((fxx, fyy, fzz))
… fxx is a 2D/3D grid of 1/x.</p></li>
<li><p><strong>nkout</strong> (<em>int</em>) – … Number of points to be sampled in the radial direction</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>[</em><em>'linear'</em><em>, </em><em>'log'</em><em>]</em>) – … This determines whether sampling is evenly done in the linear or log scale.
… For energy spectrum computation, one might prefer to get statistics at frequency/wavenumber evenly spaced in the log scale</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fr_binned, ef1d, ef1d_err</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.convert_dat2h5files">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">convert_dat2h5files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.convert_dat2h5files" title="Permalink to this definition"></a></dt>
<dd><p>Converts tecplot data files (.data format) to a set of hdf5 files
… Used for DaVis STB Lagrangian data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path to tecplot data file</em><em> (</em><em>data</em><em>)</em>) – </p></li>
<li><p><strong>savedir</strong> (<em>str</em><em>, </em><em>default: None</em>) – … directories where hdf5 files are going to be saved</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default: False</em>) – </p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … boolean which determines whether hdf5 files will be overwritten</p></li>
<li><p><strong>start</strong> (<em>int</em><em>, </em><em>default:10</em>) – … this will be used to name the h5 files</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.count_nans">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">count_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.count_nans" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of nans in the given array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.count_nans_along_axis">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">count_nans_along_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.count_nans_along_axis" title="Permalink to this definition"></a></dt>
<dd><p>Count the number of nans in udata along an axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>path to udata</em>) – </p></li>
<li><p><strong>axis</strong> (<em>str</em><em>, </em><em>'x'</em><em>, </em><em>'y'</em><em>, </em><em>'z'</em><em>, </em><em>an axis along which the number of nans gets calculated</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>time increment to count the number of nans in a udata</em>) – … if one wants complete statistics, use inc=1 but this is overkill.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nans</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, (number of nans in udata) / udata.size along the specified axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cross">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cross" title="Permalink to this definition"></a></dt>
<dd><p>Returns an cross poduct of udata with vdata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>vdata</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vecData</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array with (dim, height, width, (depth), (duration)) if dim==3 OR (height, width, (depth), (duration)) if dim==2</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.curl">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">curl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.curl" title="Permalink to this definition"></a></dt>
<dd><p>Computes curl of a velocity field using a rate of strain tensor
… if you already have velocity data as ux = array with shape (m, n) and uy = array with shape (m, n),</p>
<blockquote>
<div><p>udata = np.stack((ugrid1, vgrid1))
omega = vec.curl(udata)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>(</em><em>ux</em><em>, </em><em>uy</em><em>, </em><em>uz</em><em>) or </em><em>(</em><em>ux</em><em>, </em><em>uy</em><em>)</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>spatial spating of a 2D/3D grid</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>spatial spating of a 2D/3D grid</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>spatial spating of a 2D/3D grid</em>) – </p></li>
<li><p><strong>xyz_orientations</strong> (<em>1d array</em>) – … differentiation in the index space and the physical space must be conducted properly.
tflow convention is to treat the row, column, and the depth (i,j,k) are parallel to x, y, z in the physical space;
however, this does not specify the direction of the axes. (+i direction is only equal to EITHER +x or -x).
This ambiguity causes a problem during differentiation, and the choice is somewhat arbitrary to the users.
This function offers a solution by two ways. One way is to give a 2d/3d array of the positional grids.
If xx, yy, zz are given, it would automatically figures out how +i,+j,+k are aligned with +x,+y,+z.
The second way is give delta x/ delta_i, dy/delta_j, dz/delta_k. This argument is related to this method.
… e.g.
xyz_orientations = [1, 1, 1]… means +x // +i, +y//+j, +z//+k
xyz_orientations = [-1, -1, -1]… means +x // -i, +y//-j, +z//-k
xyz_orientations = [1, -1, 1]… means +x // +i, +y//-j, +z//+k</p></li>
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>positional grid</em>) – <dl class="simple">
<dt>… If given, it would automatically figure out whether +x and +i point at the same direction,</dt><dd><p>and the curl is computed based on that</p>
</dd>
</dl>
</p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>positional grid</em>) – <dl class="simple">
<dt>… If given, it would automatically figure out whether +y and +j point at the same direction,</dt><dd><p>and the curl is computed based on that</p>
</dd>
</dl>
</p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>positional grid</em>) – <dl class="simple">
<dt>… If given, it would automatically figure out whether +z and +k point at the same direction,</dt><dd><p>and the curl is computed based on that</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>omega</strong> – shape: (height, width, duration) (2D) or (height, width, depth, duration) (3D)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.curl_2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">curl_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">-</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.curl_2d" title="Permalink to this definition"></a></dt>
<dd><p>Calculate curl of 2D (or 2D+1) field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ux</strong> (<em>2D array</em>) – x component of a 2D field</p></li>
<li><p><strong>uy</strong> (<em>2D array</em>) – y component of a 2D field</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – data spacing (mm/px)</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – data spacing (mm/px)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>omega</strong> – vorticity field</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.cyl2cart">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">cyl2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.cyl2cart" title="Permalink to this definition"></a></dt>
<dd><p>Transformation from cylindrical to cartesian coords
:param rho:
:type rho: numpy array, radial distance (cylindrical)
:param phi:
:type phi: numpy array, polar angle [-pi, pi] (angle on the x-y plane)
:param z:
:type z: numpy array, z-coord
:param x0:
:type x0: float, (x0, y0, 0) is the origin of the coordinate system
:param y0:
:type y0: float, (x0, y0, 0) is the origin of the coordinate system</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>x, y, z</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>cartesian coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.decompose_duidxj">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">decompose_duidxj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sij</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.decompose_duidxj" title="Permalink to this definition"></a></dt>
<dd><p>Decompose a duidxj tensor into a symmetric and an antisymmetric parts
Returns symmetric part (eij) and anti-symmetric part (gij)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sij</strong> – </p></li>
<li><p><strong>(</strong><strong>x</strong> (<em>j</em><em>) </em><em>or</em>) – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>t</strong> – </p></li>
<li><p><strong>i</strong> – </p></li>
<li><p><strong>(</strong><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>z</strong> – </p></li>
<li><p><strong>t</strong> – </p></li>
<li><p><strong>i</strong> – </p></li>
<li><p><strong>j</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eij</strong> (<em>5d or 6d numpy array, symmetric part of rate-of-strain tensor.</em>) – 5d if spatial dimensions are x and y. 6d if spatial dimensions are x, y, and z.</p></li>
<li><p><strong>gij</strong> (<em>5d or 6d numpy array, anti-symmetric part of rate-of-stxxain tensor.</em>) – 5d if spatial dimensions are x and y. 6d if spatial dimensions are x, y, and z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.default_analysis_piv">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">default_analysis_piv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.default_analysis_piv" title="Permalink to this definition"></a></dt>
<dd><p>A function to perform default analysis on 2D PIV data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path to the h5 file where a velocity field is stored</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>increment of the time index to be used to perform analysis</em>) – … inc==1: use all v-field data
… inc==n: use every n-th frame of the v-field data</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>whether to overwrite existing analysis results</em>) – </p></li>
<li><p><strong>time</strong> (<em>1d array</em><em>, </em><em>time that corresponds to the measurement</em>) – … if provided, it writes this data to the h5 file at /t</p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index of the first frame to be used to compute the statistics</em><em>, </em><em>[</em><em>t0</em><em>, </em><em>t1</em><em>)</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index of the first frame to be used to compute the statistics</em><em>, </em><em>[</em><em>t0</em><em>, </em><em>t1</em><em>)</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.default_analysis_stb">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">default_analysis_stb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.default_analysis_stb" title="Permalink to this definition"></a></dt>
<dd><p>A function which adds some basic results such as time-averaged energy (FOR 3D DATA)
… Suggestive indices of the volume to load:’x0’, ‘x1’, ‘y0’, ‘y1’, ‘z0’, ‘z1’
… Velocity statistics: ‘abs_ui_median’, ‘abs_ui_avg’, ‘abs_ui_99’, ‘abs_ui_99p9’, ‘u_cutoff’
… Temporally/spatially averaged energy and enstrophy: ‘etavg’, ‘esavg’, ‘esavg_err’, ‘enst_tavg’, ‘enst_savg’, ‘enst_savg_err’
… Center of energy: ‘xc’, ‘yc’, ‘zc’
… Center of enstrophy: ‘xc_enst’, ‘yc_enst’, ‘zc_enst’
… Radial energy profile (The center is (xc, yc, zc): r_energy’, ‘eTimeThetaPhi_avg’, ‘eTimeThetaPhi_avg_err
… Radial enstrophy profile (The center is (xc, yc, zc): r_energy’, ‘eTimeThetaPhi_avg’, ‘eTimeThetaPhi_avg_err</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path to the h5 file where udata is stored.</em>) – … the h5 file must include 3D+1 array of ‘ux’, ‘uy’, ‘uz’ and 3D arrays of ‘x’, ‘y’, ‘z’
… this is a default data format</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default: 1</em>) – </p></li>
<li><p><strong>energy</strong> (<em>...</em><em> increment used to compute time-sensitive quantities such as spatial-averaged</em>) – … If inc==10, for example, this function computes the spatially-averaged energy every 10 time steps.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>whether to overwrite existing analysis results</em>) – </p></li>
<li><p><strong>time</strong> (<em>1d array</em><em>, </em><em>time that corresponds to the measurement</em>) – … if provided, it writes this data to the h5 file at /t</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.derive_all">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">derive_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udatapath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.derive_all" title="Permalink to this definition"></a></dt>
<dd><p>A shortcut function to derive major quantities of turbulence</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>spacing along x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>spacing along y</em>) – </p></li>
<li><p><strong>savepath</strong> (<em>str</em><em>, </em><em>path where the derived quantities are saved</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>kwargs that are passed to both derive_easy</em><em>(</em><em>) </em><em>and derive_hard</em><em>(</em><em>)</em>) – … e.g. x0, x1, y0, y1, z0, z1, t0, t1</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.derive_easy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">derive_easy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reynolds_decomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udatapath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.derive_easy" title="Permalink to this definition"></a></dt>
<dd><p>Function to derive quantities which are (relatively) computationally cheap
… energy spectra, energy, enstrophy, skewness etc.
:param udata:
:type udata: nd array, velocity field
:param dx:
:type dx: float, spacing along x
:param dy:
:type dy: float, spacing along y
:param savepath:
:type savepath: str, path where the derived quantities are saved
:param time:
:type time: 1d array, time in physical units
:param inc: … if inc=1, then it uses the whole time series to derive various quantities (default)</p>
<blockquote>
<div><p>… if inc=n, then it uses every nth time point to derive various quantities (this speeds up the process)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>spacing along z</em><em> (</em><em>3d data only</em><em>)</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>kinematic viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>reynolds_decomp</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … if True, then it uses the fluctuating velocity instead of raw velocity to compute various quantities</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … if True, then it uses the tqdm_notebook instead of tqdm to display a progress bar</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … if True, then it overwrites the existing data in savepath</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.derive_hard">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">derive_hard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reynolds_decomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.derive_hard" title="Permalink to this definition"></a></dt>
<dd><p>Function to derive quantities which are (relatively) computationally expensive
… structure function, two_point correlation function,</p>
<blockquote>
<div><p>taylor microscale as a curvature of the long.  autocorr. func. etc.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>spacing along x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>spacing along y</em>) – </p></li>
<li><p><strong>savepath</strong> (<em>str</em><em>, </em><em>path where the derived quantities are saved</em>) – </p></li>
<li><p><strong>time</strong> (<em>1d array</em><em>, </em><em>time in physical units</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>increment along time</em>) – … if inc=1, then it uses the whole time series to derive various quantities (default)
… if inc=n, then it uses every nth time point to derive various quantities (this speeds up the process)</p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>spacing along z</em><em> (</em><em>3d data only</em><em>)</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>kinematic viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>reynolds_decomp</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … if True, then it uses the fluctuating velocity instead of raw velocity to compute various quantities</p></li>
<li><p><strong>coarse</strong> (<em>float</em><em>, </em><em>default: 1.0</em>) – … parameter for get_structure_function</p></li>
<li><p><strong>coarse2</strong> (<em>float</em><em>, </em><em>default: 1.0</em>) – … parameter for get_structure_function
… The higher the value, the more data points are used to evaluate the statistics to get the structure function</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … if True, then it uses the tqdm_notebook instead of tqdm to display a progress bar</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … if True, then it overwrites the existing data in savepath</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.div">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.div" title="Permalink to this definition"></a></dt>
<dd><p>Computes divergence of a velocity field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>numpy array</em>) – … (ux, uy, uz) or (ux, uy)
… ui has a shape (height, width, depth, duration) or (height, width, depth) (3D)
… ui may have a shape (height, width, duration) or (height, width) (2D)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>div_u</strong> – … div_u has a shape (height, width, depth, duration) (3D) or (height, width, duration) (2D)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.dot">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.dot" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dot poduct of udata with vdata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>vdata</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scaData</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array with (height, width, (depth), (duration))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.estimate_cirulation_vring_collider">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">estimate_cirulation_vring_collider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.estimate_cirulation_vring_collider" title="Permalink to this definition"></a></dt>
<dd><p>Returns the circulation of a vortex ring created in the vortex ring collider (setting 1- 10cm blob creation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>float/array</em>) – commanded stroke length in mm</p></li>
<li><p><strong>sv</strong> (<em>float/array</em>) – commanded stroke velocity in mm/s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gammaT, gammaB</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of float values/arrays, circulation of the top and the bottom rings</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.estimate_radius_vring_collider">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">estimate_radius_vring_collider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.estimate_radius_vring_collider" title="Permalink to this definition"></a></dt>
<dd><p>Returns the radius of a vortex ring created in the vortex ring collider (setting 1- 10cm blob creation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>float/array</em>) – commanded stroke length in mm</p></li>
<li><p><strong>sv</strong> (<em>float/array</em>) – commanded stroke velocity in mm/s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rrT, rrB</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of float values/arrays, radius of the top and the bottom rings</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.estimate_ringVRratio">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">estimate_ringVRratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norfices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowerGamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'master_curve'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_V_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.estimate_ringVRratio" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the V/R ratio of a ring created in a vortex ring collider
… V/R ratio: ring velocity / ring radius
… Two methods are possible.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>By Using a master curve to infer ring velocity and radius</p></li>
<li><p>By interpolating the experimental measurements in the past</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>float/array</em>) – commanded stroke length in mm</p></li>
<li><p><strong>sv</strong> (<em>float/array</em>) – commanded stroke velocity in mm/s</p></li>
<li><p><strong>dp</strong> (<em>float</em>) – …. piston diameter in mm</p></li>
<li><p><strong>float</strong> (<em>do</em>) – … orfice diameter in mm</p></li>
<li><p><strong>norifices</strong> (<em>int/float</em>) – … number of oricies</p></li>
<li><p><strong>lowerGamma</strong> (<em>float</em>) – … experimental constant, default: 2.2
… This represents the ratio of semi-major to semi-minor radius when a vortex bubble is approximated as an ellipsoid</p></li>
<li><p><strong>setting</strong> (<em>str</em>) – … vortex ring collider versions
… choose from ‘medium’ or ‘small’
… ‘medium’ refers to the chamber configuration to create D=10cm blobs
… ‘small’ refers to the chamber configuration to create D=5cm blobs</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>choose from &quot;master_curve&quot; and &quot;measurement&quot;</em>) – </p></li>
<li><p><strong>return_err</strong> (<em>bool</em>) – … Only applicable to method==”master_curve”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vrRatio, (vrRatio_err)</strong> – … Self-induced velocity / radius of a vortex ring(s) created by (stroke length, stroke velocity)
… Error of V/R ratio due to the discrepancy between the rings created at the top and bottom orifices</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float/arrays, float/arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.estimate_ring_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">estimate_ring_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowerGamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">veff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viscous'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circulation_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'master</span> <span class="pre">curve'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'thin_core'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.estimate_ring_energy" title="Permalink to this definition"></a></dt>
<dd><p>Given a stroke length, this function estimates energy of a vortex ring in a vortex ring collider in nJ
… units: nJ</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>float/1d array</em><em>, </em><em>stroke length in mm</em>) – </p></li>
<li><p><strong>sv</strong> (<em>float/1d array</em><em>, </em><em>stroke velocity in mm/s</em>) – </p></li>
<li><p><strong>dp</strong> (<em>float</em><em>, </em><em>piston diameter</em>) – </p></li>
<li><p><strong>do</strong> (<em>float</em><em>, </em><em>orifice diameter</em>) – </p></li>
<li><p><strong>N</strong> (<em>number of orifices</em>) – </p></li>
<li><p><strong>lowerGamma</strong> (<em>float</em>) – … experimental constant, default: 2.2
… This represents the ratio of semi-major to semi-minor radius when a vortex bubble is approximated as an ellipsoid</p></li>
<li><p><strong>setting</strong> (<em>str</em><em>, </em><em>options are 'medium' and 'small'</em>) – … if setting == ‘small’, it uses dp, do, N = 56.7, 12.8, 8.
… if setting == ‘medium’, it uses dp, do, N = 160, 25.6, 8.</p></li>
<li><p><strong>rho</strong> (<em>float</em><em>, </em><em>mass density of medium in g/mm3</em><em>, </em><em>default: 1e-3</em><em> (</em><em>water</em><em>)</em>) – </p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>a core size of a vortex ring</em>) – </p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>a vortex ring core parameter</em><em>, </em><em>see Sullivan et. al. 2008</em>) – </p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>a vortex ring core parameter</em><em>, </em><em>see Sullivan et. al. 2008</em>) – </p></li>
<li><p><strong>core_type</strong> (<em>str</em><em>, </em><em>defalut: 'viscous'</em>) – … if specified, it uses the values of alpha and beta for each core model- taken from Sullivan et. al. 2008
… options are ‘viscous’, ‘solid_const_volume’, ‘hollow_const_volume’,’hollow_const_pressure’, ‘hollow_surface_tension’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>energy</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vortex ring energy in nJ</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.estimate_veff">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">estimate_veff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.estimate_veff" title="Permalink to this definition"></a></dt>
<dd><p>Returns effective velocity from a given commanded stroke length and velocity
… This function interpolates values based on the measurements in the past</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>int/float/1d array</em>) – <ul>
<li><p>Commanded stroke length in mm</p></li>
</ul>
</p></li>
<li><p><strong>sv</strong> (<em>int/float/1d array</em>) – <ul>
<li><p>Commanded stroke velocity in mm/s</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>veff</strong> –</p>
<ul class="simple">
<li><p>Effective velocity in mm/s</p></li>
<li><p>Velocity program factor * mean speed</p></li>
<li><p>Velocity program factor P = Mean of the second moment / Square of the mean of the first moment (average)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.estimate_velocity_vring_collider">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">estimate_velocity_vring_collider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.estimate_velocity_vring_collider" title="Permalink to this definition"></a></dt>
<dd><p>Returns the velocity of a vortex ring created in the vortex ring collider (setting 1- 10cm blob creation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>float/array</em>) – commanded stroke length in mm</p></li>
<li><p><strong>sv</strong> (<em>float/array</em>) – commanded stroke velocity in mm/s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vrT, vrB</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of float values/arrays, velocity of the top and the bottom rings</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.expand_dim">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">expand_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.expand_dim" title="Permalink to this definition"></a></dt>
<dd><p>Returns arr[…, np.newaxis]
… shape of arr changes from arr.shape to (arr.shape, 1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>nd array</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>arr[…, np.newaxis]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.export_raw_file">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">export_raw_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data2save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uint32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrast_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.export_raw_file" title="Permalink to this definition"></a></dt>
<dd><p>Exports a raw file from a numpy array with inteprolation features
… The intended use is to convert the numpy array to a raw file which can be loaded to Dragonfly
… np.nan in the given array could be filled by the following interpolating methods:</p>
<blockquote>
<div><p>‘nn’: fills nans with the nearest neighbors (fast)
‘localmean’:  fills nans with the local mean (kernel size of 3 by default</p>
<blockquote>
<div><ul class="simple">
<li><p>the kernel size can be changed by passing an extra kwargs to the method called replace_nan_w_nn) (slow)</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>‘idw’:  fills nans with the (inverse distancing weighting) Gaussian kernel</dt><dd><ul class="simple">
<li><p>the kernel size can be changed by passing an extra kwargs to the method called replace_nan_w_nn) (slow)</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data2save</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>Ny</em><em>, </em><em>Nx</em><em>, </em><em>Nz</em><em>, </em><em>Nt</em><em>)</em>) – </p></li>
<li><p><strong>savepath</strong> (<em>str</em><em>, </em><em>path where the raw file is saved</em>) – </p></li>
<li><p><strong>dtype</strong> (<em>str</em><em>, </em><em>default: 'uint32'</em><em>, </em><em>data type of the raw file</em>) – </p></li>
<li><p><strong>thd</strong> (<em>float default: np.inf</em>) – … data &gt; thd will be replaced by fill_value</p></li>
<li><p><strong>interpolate</strong> (<em>str</em><em>, </em><em>default None</em>) – <dl class="simple">
<dt>… choose from ‘idw’ and ‘localmean’, ‘nn</dt><dd><p>… if specified, it replaces np.nan in array using replace_nan(…)</p>
</dd>
</dl>
</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default: np.nan</em>) – … value that is used to fill in data where data value &gt; thd</p></li>
<li><p><strong>kwargs</strong> (<em>passed to replace_nan</em><em>(</em><em>...</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.export_raw_file_from_dpath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">export_raw_file_from_dpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">udatapath</span></em>, <em class="sig-param"><span class="pre">func=&lt;function</span> <span class="pre">get_energy&gt;</span></em>, <em class="sig-param"><span class="pre">x0=0</span></em>, <em class="sig-param"><span class="pre">x1=None</span></em>, <em class="sig-param"><span class="pre">y0=0</span></em>, <em class="sig-param"><span class="pre">y1=None</span></em>, <em class="sig-param"><span class="pre">z0=0</span></em>, <em class="sig-param"><span class="pre">z1=None</span></em>, <em class="sig-param"><span class="pre">t0=0</span></em>, <em class="sig-param"><span class="pre">t1=None</span></em>, <em class="sig-param"><span class="pre">inc=1</span></em>, <em class="sig-param"><span class="pre">savedir=None</span></em>, <em class="sig-param"><span class="pre">dtype='uint32'</span></em>, <em class="sig-param"><span class="pre">thd=None</span></em>, <em class="sig-param"><span class="pre">interpolate=None</span></em>, <em class="sig-param"><span class="pre">notebook=True</span></em>, <em class="sig-param"><span class="pre">running_avg=1</span></em>, <em class="sig-param"><span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.export_raw_file_from_dpath" title="Permalink to this definition"></a></dt>
<dd><p>Exports a raw file of the output of a given function (default: get_energuy) at each time step.
(Intended for 4D visualization. e.g. use ORS Dragonfly for visualiztion)</p>
<p>… Argument: path to udata
… Philosophy: Load 3D data at an instant of time, compute the quantity of interest. Export the 3D array. Repeat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>a path to the udata file</em>) – </p></li>
<li><p><strong>func</strong> (<em>function</em><em>, </em><em>a function that takes in a 3D array and returns a 3D array</em>) – … default: get_energy()- returns the instantaneous energy field of the flow</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … exports the raw data every “inc”-th time step</p></li>
<li><p><strong>savedir</strong> (<em>str</em><em>, </em><em>default: None</em>) – … a path of the directory where raw data will be saved</p></li>
<li><p><strong>dtype</strong> (<em>str</em><em>, </em><em>default: 'uint32'</em>) – … data type of the raw data</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>default: None</em>) – … values above this threshold are set to 0.</p></li>
<li><p><strong>interpolate</strong> (<em>str</em><em>, </em><em>default None</em>) – … choose from ‘idw’ and ‘localmean’
…… Inverse distance weighting (IDW) - gaussian mean
…… localmean -  assigns mean of the surrounding values at the missing points</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em><em>,</em>) – …. if True, use tqdm_notebook instead of tqdm to show a progress bar</p></li>
<li><p><strong>running_avg</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … if running_avg&gt;1, it exporsts the running average of the computed quantity</p></li>
<li><p><strong>kwargs</strong> (<em>additional arguments for func</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.extend_2darray_fill">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">extend_2darray_fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newarrshape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.extend_2darray_fill" title="Permalink to this definition"></a></dt>
<dd><p>Resize a 2d array while keeping the physical shape of the original array and fill the rest with something
e.g.-
arr =</p>
<blockquote>
<div><dl class="simple">
<dt>array([[ 0,  1,  2,  3,  4],</dt><dd><p>[ 5,  6,  7,  8,  9],
[10, 11, 12, 13, 14],
[15, 16, 17, 18, 19]])</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>-&gt; arr_ext with newarrshape = (6,6)</dt><dd><dl class="simple">
<dt>array([[  0.,   1.,   2.,   3.,   4.,  nan],</dt><dd><p>[  5.,   6.,   7.,   8.,   9.,  nan],
[ 10.,  11.,  12.,  13.,  14.,  nan],
[ 15.,  16.,  17.,  18.,  19.,  nan],
[ nan,  nan,  nan,  nan,  nan,  nan],
[ nan,  nan,  nan,  nan,  nan,  nan]])</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>2d numpy array</em>) – </p></li>
<li><p><strong>newarrshape</strong> (<em>tuple</em><em>, </em><em>new array shape </em><em>...</em><em> (</em><em>nrows</em><em>, </em><em>ncols</em><em>)</em>) – </p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default=np.nan</em><em>, </em><em>value to fill the rest of the array with</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>arr_ext</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>extended/padded 2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fft_1d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fft_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fft_1d" title="Permalink to this definition"></a></dt>
<dd><p>Returns the shifted FFT of a 1D signal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gt</strong> (<em>1d array</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gf</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d complex array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fft_nd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fft_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fft_nd" title="Permalink to this definition"></a></dt>
<dd><p>Conducts FFT along specified axes
… If axes were not given, it FFT along all axes
… Returns shifted FFT output</p>
<blockquote>
<div><p>… FFT is a fast DFT algorithm, meaning that it does computation in Frequency space (1/x)
instead of the Angular Frequency (wavenumber) space.
… It is recommended to do the change of variables at the end of the process because it becomes increasingly
hard to keep track of the factor of 2pi as the computation becomes more complex.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gx</strong> (<em>ND-array</em><em>, </em><em>Signal</em>) – </p></li>
<li><p><strong>axes</strong> (<em>array-like</em><em>,  </em><em>e.g.-</em><em> [</em><em>0</em><em>, </em><em>1</em><em>]</em>) – … axes along which FFT is conducted
… Default is doing FFT along all axes
… If you want to do 1D FFT using a 3D data, you may provide a 3D data with axes=[0] etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.fft.fftshift(np.fft.fftn(gx, axes=axes))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fftnoise2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fftnoise2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fftnoise2d" title="Permalink to this definition"></a></dt>
<dd><p>Returns a inverse FT of a given noise after multiplying random phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>2d array</em><em>, </em><em>frequency of noise</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>noise = np.fft.ifftn(f*random_phase)real, 2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fill_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fill_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fill_udata" title="Permalink to this definition"></a></dt>
<dd><p>Replaces values in ~keep with ‘filled_value’
… For actual masking which does not involve replacing values of the array, use a numpy masked array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array of a v-field</em>) – </p></li>
<li><p><strong>keep</strong> (<em>2/3d boolean array</em><em>, </em><em>where True indicates values to keep</em>) – </p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>default: True</em>) – </p></li>
<li><p><strong>True</strong> (<em>...</em><em> If</em>) – </p></li>
<li><p><strong>untouched.</strong> (<em>the given udata remains</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vdata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array- a masked array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fill_unphysical_with_sth">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fill_unphysical_with_sth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fill_unphysical_with_sth" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array whose elements are replaced by fill_value if its mask value is True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>U</strong> (<em>array-like</em>) – </p></li>
<li><p><strong>mask</strong> (<em>multidimensional boolean array</em>) – </p></li>
<li><p><strong>fill_value</strong> (<em>value that replaces masked values</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>U_filled</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array, same shape as U, with masked values replaced by fill_value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.find_crop_no">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">find_crop_no</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.find_crop_no" title="Permalink to this definition"></a></dt>
<dd><p>Returns a how many pixels should be cropped from the edge if udata contains many nan values near the edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em><em>, </em><em>shape</em><em> (</em><em>ncomp</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>,</em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>default: 0.2</em>) – … The tolerance for the percentage of nan values near the edge</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>i</strong> (<em>int, how many pixels should be cropped from the edge</em>)</p></li>
<li><p><em>Examples</em></p></li>
<li><p><em>——–</em></p></li>
<li><p><em>udata = fix_udata_shape(udata)</em></p></li>
<li><p><em>n = find_crop_no(udata, tol=0.2)</em></p></li>
<li><p><strong>udata_cropped = udata[</strong> (<em>, n:-n, n:-n, …]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.find_n_largest_values">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">find_n_largest_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.find_n_largest_values" title="Permalink to this definition"></a></dt>
<dd><p>Returns n largest values in a given array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.find_n_smallest_values">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">find_n_smallest_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.find_n_smallest_values" title="Permalink to this definition"></a></dt>
<dd><p>Returns n smallest values in a given  array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.find_nearest">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">find_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.find_nearest" title="Permalink to this definition"></a></dt>
<dd><p>Find an element and its index closest to ‘value’ in ‘array’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>value</strong> (<em>float/int</em>) – </p></li>
<li><p><strong>option</strong> (<em>str</em><em>, </em><em>'auto'</em><em> or </em><em>'less'</em><em>, or </em><em>'greater'</em>) – … ‘auto’ will return the element closest to ‘value’
… ‘less’ will return the element closest to ‘value’ that is LESS than ‘value’
… ‘greater’ will return the element closest to ‘value’ that is GREATER than ‘value’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>idx</strong> (<em>index of the array where the closest value to ‘value’ is stored in ‘array’</em>)</p></li>
<li><p><strong>array[idx]</strong> (<em>the closest value in ‘array’</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fix_udata_shape">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fix_udata_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fix_udata_shape" title="Permalink to this definition"></a></dt>
<dd><p>Adds a singleton dimension to the shape of udata if it does not have one.
It is better to always have udata with shape (3, height, width, depth, duration) (3D) or  (2, height, width, duration) (2D)
This method fixes the shape of udata whose shape is (3, height, width, depth) or (2, height, width)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array</em><em>,</em>) – … with shape (height, width, depth) (3D) or  (height, width, duration) (2D)
… OR shape (height, width, depth, duration) (3D) or  (height, width, duration) (2D)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, with shape (height, width, depth, duration) (3D) or  (height, width, duration) (2D)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fourier_transform_1d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fourier_transform_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fourier_transform_1d" title="Permalink to this definition"></a></dt>
<dd><p>Approximate the Fourier Transform of a time-limited
signal by means of the discrete Fourier Transform.</p>
<p>samples: signal values sampled at the positions t0 + n/Fs
fs: Sampling frequency of the signal
t0: starting time of the sampling of the signal</p>
<p>Returns:
FT of the underlying function of given samples
frequency: 1d array, frequency in hz (optional)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.fourier_transform_nd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">fourier_transform_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'freq'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.fourier_transform_nd" title="Permalink to this definition"></a></dt>
<dd><p>Returns a (Continuous) Fourier Transform of a given signal using FFT (DFT)
… This returns the adjusted values of FFT as approximated CFT of the given signal.</p>
<blockquote>
<div><p>If sampling frequency were sufficiently high, there is a simple relation between DFT and CFT of the signal, and
DFT can be used to approximate CFT of the signal.</p>
</div></blockquote>
<dl class="simple">
<dt>… Since DFT is conveniently defined using Frequency (not angular frequency), this returns the CFT as a function of frequency, f.</dt><dd><p>If one desires to convert the spectral density as a function of omega=2pi*f, you may set return_in=’wavenumber’.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gx</strong> (<em>ND signal</em>) – </p></li>
<li><p><strong>dxs</strong> (<em>array-like</em>) – <dl class="simple">
<dt>… Sampling intervals of the signal in the spacial/temporal domain</dt><dd><p>i.e. (y, x, z, t) not (1/Ly, 1/Lx, 1/Lz. 1/T)</p>
</dd>
</dl>
<p>… The order is (dy, dx, dz)
… Must have the same length as gf</p>
</p></li>
<li><p><strong>x0s</strong> (<em>array-like</em>) – <dl class="simple">
<dt>… The minimum value of the spatial/temporal domain</dt><dd><p>i.e. Y0, X0, Z0, T0- the edge coordinates of the data and the initial moment when the data was recorded</p>
</dd>
</dl>
<p>… The order is (Y0, X0, Z0)
… Must have the same length as gf</p>
</p></li>
<li><p><strong>axes</strong> (<em>array-like</em><em>,  </em><em>e.g.-</em><em> [</em><em>0</em><em>, </em><em>1</em><em>]</em>) – … axes along which FFT was conducted
… If None, it assumes that FFT was conducted along all axes of gx</p></li>
<li><p><strong>return_freq</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … If True, it returns a list of the frequencies along the axes FFT was conducted</p></li>
<li><p><strong>return_in</strong> (<em>str</em><em>, </em><em>Choose from</em><em> [</em><em>'freq'</em><em>, </em><em>'wavenumber'</em><em>, </em><em>'angular frequency'</em><em>, </em><em>'ang freq'</em><em>, </em><em>'k'</em><em>]</em>) – <dl class="simple">
<dt>… If return_in in [‘wavenumber’, ‘angular frequency’, ‘ang freq’, ‘k’],</dt><dd><p>it returns the CFT as a function of wavenumber instead of frequency (1/x)</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gf_cft</strong> (<em>Fourier transform of the signal “gx”</em>)</p></li>
<li><p><strong>freqs</strong> (<em>list, corresponding frequencies along the axes</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.gaussian_blur_scalar_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">gaussian_blur_scalar_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.gaussian_blur_scalar_field" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian blur a scalar field with shape=(…, duration) such as udata
using scipy.ndimage.filters.gaussian_filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>...</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>int</em><em>, </em><em>size of the gaussian kernel</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>blurred</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gaussian blurred field with the same shape as the field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.gaussian_blur_vector_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">gaussian_blur_vector_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.gaussian_blur_vector_field" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian blur a scalar/vector field with shape=(dim, …, duration) such as udata
using scipy.ndimage.filters.gaussian_filter
… e.g. udata</p>
<blockquote>
<div><p>udata = fix_udata_shape(udata)
gaussian_blur(udata, sigma=5)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>...</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>int</em><em>, </em><em>size of the gaussian kernel</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>blurred</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gaussian blurred field with the same shape as the field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.gen_arb_curves">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">gen_arb_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_self_intersection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_attempt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.gen_arb_curves" title="Permalink to this definition"></a></dt>
<dd><p>Generates n arbitrary curves connecting pt1 and pt2
… the obtained curve is not self-intersecting by default</p>
<blockquote>
<div><p>… this can be changed via “allow_self_intersection”</p>
</div></blockquote>
<p>How it works:
1. Sample equally-spaced points on the straight line connecting pt1 and pt2
2. Add noise to each sampled points
3. Draw a Benzier curve with disturbed points (this makes the curve smooth)
4. If Step 3 results a self-intersecting curve, repeat 1-3 untile the curve is not self-intersecting
5. Repeat 1-4 until you obtain n curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pt1</strong> (<em>1d array-like</em><em>, </em><em>e.g.-</em><em> [</em><em>0.</em><em>, </em><em>0.</em><em>,</em><em>]</em>) – </p></li>
<li><p><strong>pt2</strong> (<em>1d array-like</em><em>, </em><em>e.g.-</em><em> [</em><em>1.</em><em>, </em><em>1.</em><em>,</em><em>]</em>) – <dl class="simple">
<dt>… pt1 and pt2 could be the same coordinate but one might need to adjust “noise” to obtain a desired curve</dt><dd><p>However, this would make the curve non-smooth at pt1</p>
</dd>
</dl>
</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>MUST be greater than</em><em> or </em><em>equal to 2</em>) – <p>… number of points used to construct a Benzier curve
… The higher n is, the more wiggly/complex a curve becomes
… n=2: Line</p>
<blockquote>
<div><p>n=3: 1 kink
n=4: 2 kinks …</p>
</div></blockquote>
</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – <dl class="simple">
<dt>… number of sampled points on the output curves</dt><dd><p>This essentially defines the number of kinks on the curve</p>
</dd>
</dl>
</p></li>
<li><p><strong>noise</strong> – … noise is added to a straight lig</p></li>
<li><p><strong>allow_self_intersection</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If False, do not allow self-intersection of the generated curves</p></li>
<li><p><strong>n_attempt</strong> (<em>int</em><em>, </em><em>default: 100</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bezier_curve</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, shape=(n, 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.gen_bezier_curve">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">gen_bezier_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.gen_bezier_curve" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Bezier curve between two given points
… pts.shape = (n, 2)
… pts[0] = x, pts[1] = y</p>
<p>REQUIRES berzier module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> (<em>2d array</em><em>,</em>) – … points used to draw bezier curves. Shape: (number of points, 2)</p></li>
<li><p><strong>n</strong> (<em>int</em>) – … number of sampled points on the obtained bezier curve</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bezier_curve</strong> – … (x, y) = (bezier_curve[:, 0], bezier_curve[:, 1])</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, shape=(n, 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.generate_sample_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">generate_sample_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.6666666666666667</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.generate_sample_field" title="Permalink to this definition"></a></dt>
<dd><p>Returns a square v-field which has the energy spectrum with a given exponent
… 1. It prepares a Fourier Transform of the resulting velocitiy field</p>
<blockquote>
<div><ol class="arabic simple" start="2">
<li><p>Add random phase to the array</p></li>
<li><p>Inverse Fourier Transform the prepared field</p></li>
<li><p>Multilply “mag”</p></li>
</ol>
</div></blockquote>
<p>… Known issues: this algorithm fails for exponents outside [-7.5, -0.1]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>float</em><em>, </em><em>size of a field</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>length of the array</em>) – </p></li>
<li><p><strong>exponent</strong> (<em>float</em><em>, </em><em>[</em><em>-7.5</em><em>, </em><em>-0.1</em><em>] </em><em>seems to work.</em>) – </p></li>
<li><p><strong>mag</strong> (<em>float</em><em>, </em><em>this factor is multiplied to the resulting v-field in the end</em>) – </p></li>
<li><p><strong>return_xy</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>returns x and y arrays</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata</strong> (<em>2d array with shape (n, n)</em>)</p></li>
<li><p><strong>xx</strong> (<em>2d array with shape (n, n), optional, x-coordinates of the array</em>)</p></li>
<li><p><strong>yy</strong> (<em>2d array with shape (n, n), optional, y-coordinates of the array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.getHuMoments">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">getHuMoments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'binary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.getHuMoments" title="Permalink to this definition"></a></dt>
<dd><p>Returns Hu Moments of a 2D array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qty</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>method</strong> (<em>'binary'</em><em> or </em><em>'thresholding'</em>) – </p></li>
<li><p><strong>thd</strong> (<em>int/float</em><em>, </em><em>value for binarization</em><em> or </em><em>thresholding</em>) – </p></li>
<li><p><strong>log</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>huMoments_</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array of hu moments (h0-h6), h6 flips a sign under reflection</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_1d_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_1d_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_1d_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns 1D energy spectrum from velocity field data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>k</strong> (<em>str</em><em>, </em><em>default: 'kx'</em>) – string to specify the direction along which the given velocity field is Fourier-transformed</p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of available window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eiis</strong> (<em>numpy array</em>) – eiis[0] = E11, eiis[1] = E22
… 1D energy spectra with argument k=”k” (kx by default)</p></li>
<li><p><strong>eii_errs</strong> (<em>numpy array:</em>) – eiis[0] = E11_error, eiis[1] = E22_error</p></li>
<li><p><strong>k</strong> (<em>1d numpy array</em>) – Wavenumber with shape (number of data points, )
… Unlike get_energy_spectrum(…), this method NEVER outputs the wavenumber array with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_1d_energy_spectrum_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_1d_energy_spectrum_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_1d_energy_spectrum_old" title="Permalink to this definition"></a></dt>
<dd><p>Returns 1D energy spectrum from velocity field data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>k</strong> (<em>str</em><em>, </em><em>default: 'kx'</em>) – string to specify the direction along which the given velocity field is Fourier-transformed</p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of available window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eiis</strong> (<em>numpy array</em>) – eiis[0] = E11, eiis[1] = E22
… 1D energy spectra with argument k=”k” (kx by default)</p></li>
<li><p><strong>eii_errs</strong> (<em>numpy array:</em>) – eiis[0] = E11_error, eiis[1] = E22_error</p></li>
<li><p><strong>k</strong> (<em>1d numpy array</em>) – Wavenumber with shape (number of data points, )
… Unlike get_energy_spectrum(…), this method NEVER outputs the wavenumber array with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_1d_rescaled_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_1d_rescaled_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0034</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flattop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_1d_rescaled_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns SCALED 1D energy spectra (E11 and E22)
… Applies the flattop window function by default
… Uses dissipation rate estimated by the rate-of-strain tensor unless given]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>nd array</em><em> or </em><em>float</em><em>, </em><em>default: None</em>) – dissipation rate used for scaling energy spectrum
If not given, it uses the values estimated using the rate-of-strain tensor</p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of available window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eii_arr_norm</strong> (<em>nd array</em>) – Scaled spectral densities (Scaled E11 and Scaled E22)</p></li>
<li><p><strong>eii_err_arr_norm</strong> (<em>nd array</em>) – Scaled errors for (Scaled E11 and Scaled E22)</p></li>
<li><p><strong>k_norm</strong> (<em>nd array</em>) – Scaled wavenumber</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_angular_impulse">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_angular_impulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_angular_impulse" title="Permalink to this definition"></a></dt>
<dd><p>Returns the total angular impulse inside the region defined by xx, yy, zz
… it returns an array of a shape (duration, )
… If return_bulk_surface is True, it returns hydrodynamic impulse, its bulk term, and surface term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>4d/5d array</em><em>, </em><em>v-field data with shape</em><em> (</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>) or </em><em>(</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>, </em><em>t</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>positional grid about x</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>positional grid about y</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>positional grid about z</em>) – </p></li>
<li><p><strong>rho</strong> (<em>fluid density</em><em>, </em><em>default 1e-3 g/mm3</em>) – </p></li>
<li><p><strong>crop</strong> (<em>int</em><em>, </em><em>crop the domain near the edge to remove the boundary effects</em>) – </p></li>
<li><p><strong>keep</strong> (<em>boolean array</em><em>, </em><em>indices of the points to keep</em>) – </p></li>
<li><p><strong>R</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>zc</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hydrodynamic angular impulse</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array (components, duration)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_angular_impulse_density">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_angular_impulse_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_angular_impulse_density" title="Permalink to this definition"></a></dt>
<dd><p>It returns the density of (hydrodynamic) angular impulse</p>
<p>… It is the moment of the impulsive force which generates the motion from the rest
… Angular impulse is defined as</p>
<blockquote>
<div><dl class="simple">
<dt>A = 1/3 int r  imes (r         imes omega) dV (Lamb, 1932, Sect. 152, Saffman. Sect. 3.5, Eq.5)</dt><dd><p>= - 1/2 int r^2 omega dV - 1/6 r^2 r         imes (omega cdot n) dS (Batchelor, 1967, Sect. 7.2)
=  int r     imes u dV  + 1/2 int r^2 (n    imes  u) dS (Saffman. Sect. 3.5, Eq.7)</p>
</dd>
<dt>… If all the vorticity is contained inside the control volume,</dt><dd><p>A = int r  imes u dV</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>4d/5d array</em><em>, </em><em>v-field data with shape</em><em> (</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>) or </em><em>(</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>, </em><em>t</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>positional grid about x</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>positional grid about y</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>positional grid about z</em>) – </p></li>
<li><p><strong>rho</strong> (<em>fluid density</em><em>, </em><em>default 1e-3 g/mm3</em>) – </p></li>
<li><p><strong>crop</strong> (<em>int</em><em>, </em><em>crop the domain near the edge to remove the boundary effects</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ai</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, angular impulse density</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_autocorr_functions">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_autocorr_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_autocorr_functions" title="Permalink to this definition"></a></dt>
<dd><p>Return interpolated functions using the outputs of get_two_point_vel_corr_iso()
… arguments: r, t</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_long</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>f_long</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>r_tran</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>g_tran</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>time</strong> (<em>numpy array</em>) – time corresponding to the given autocorrelation functions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f, g</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>long./trans. autocorrelation functions with argument (distance, time)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_autocorr_functions_int_list">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_autocorr_functions_int_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_autocorr_functions_int_list" title="Permalink to this definition"></a></dt>
<dd><p>Returns lists of INTERPOLATED autocorrelation functions
… an element of the list is a spline interpolating function at an instant in time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_long</strong> (<em>numpy array with shape</em><em> (</em><em>n_bins</em><em>, </em><em>duration</em><em>)</em>) – … distance for the long. autocorrelation function
output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>f_long</strong> (<em>numpy array</em>) – … long. autocorrelation function
output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>r_tran</strong> (<em>numpy array</em>) – … distance for the trans. autocorrelation function
output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>g_tran</strong> (<em>numpy array</em>) – … trans. autocorrelation function
output of get_two_point_vel_corr_iso()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fs</strong> (<em>list, length = duration = f_long.shape[-1]</em>) – list of interpolated longitudinal structure functions</p></li>
<li><p><strong>gs</strong> (<em>list, length = duration = g_long.shape[-1]</em>) – list of interpolated transverse structure functions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_autocorrelation_tensor_iso">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_autocorrelation_tensor_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_autocorrelation_tensor_iso" title="Permalink to this definition"></a></dt>
<dd><p>Returns an autocorrelation tensor, assuming isotropy of the flow
… not recommended for practical use due to long convergence time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_long</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>f_long</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>r_tran</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>g_tran</strong> (<em>numpy array</em>) – output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>time</strong> (<em>numpy array</em>) – time corresponding to the given autocorrelation functions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rij</strong> – technically a function with arguments: i, j, r, t, udata (tensor indices, separation distance, time index, udata)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>autocorrelation tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_azimuthal_average">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_azimuthal_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ef_nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_azimuthal_average" title="Permalink to this definition"></a></dt>
<dd><p>Computes an azimuthal average of an nd array ef_nd
…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ef_nd</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>freqs</strong> (<em>a list/tuple of nd array</em>) – … r = sqrt(freqs[0]**2 + freqs[1]**2 + … + freqs[-1]**2)</p></li>
<li><p><strong>nkout</strong> (<em>number of bins used to take statistsics</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>choose from 'linear'</em><em> or </em><em>'log'</em>) – <p>… this determines the width of the bins to be evenly spaced in a linear space or logarithmic space
… i.e. bin edges will be like 0, 1, 2, 3, 4, … for the linear mode</p>
<blockquote>
<div><p>bin edges will be like 10^0, 10^1, 10^2, 10^3, … for the logarithmic mode</p>
</div></blockquote>
</p></li>
<li><p><strong>cc</strong> (<em>constant to be multiplied to the output</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fr_binned, ef1d, ef1d_err</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>radius r, azimuthal average of e(r, theta, phi), standard deviation as a function of r</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_binned_stats">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_binned_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_binned_stats" title="Permalink to this definition"></a></dt>
<dd><p>Make a histogram out of a pair of 1d arrays.
… Returns arg_bins, var_mean, var_err
… The given arrays could contain nans and infs. They will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg</strong> (<em>1d array</em><em>, </em><em>controlling variable</em>) – </p></li>
<li><p><strong>var</strong> (<em>1d array</em><em>, </em><em>data array to be binned</em>) – </p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default: 100</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>deafult: 'linear'</em>) – If ‘linear’, var will be sorted to equally spaced bins. i.e. bin centers increase linearly.
If ‘log’, the bins will be not equally spaced. Instead, they will be equally spaced in log.
… bin centers will be like… 10**0, 10**0.5, 10**1.0, 10**1.5, …, 10**9</p></li>
<li><p><strong>return_std</strong> (<em>bool</em>) – If True, it returns the STD of the statistics instead of the error = STD / np.sqrt(N)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>arg_bins</strong> (<em>1d array, bin centers</em>)</p></li>
<li><p><strong>var_mean</strong> (<em>1d array, mean values of data in each bin</em>)</p></li>
<li><p><strong>var_err</strong> (<em>1d array, error of data in each bin</em>) – … If return_std=True, it returns the STD of the statistics instead of the error = STD / np.sqrt(N)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_binned_stats2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_binned_stats2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_binned_stats2d" title="Permalink to this definition"></a></dt>
<dd><p>Make a histogram out of a pair of 1d arrays.
… Returns arg_bins, var_mean, var_err
… The given arrays could contain nans and infs. They will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>2d array</em><em>, </em><em>control variable</em>) – </p></li>
<li><p><strong>y</strong> (<em>2d array</em><em>, </em><em>control variable</em>) – </p></li>
<li><p><strong>var</strong> (<em>2d array</em><em>, </em><em>data array to be binned</em>) – </p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default: 100</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>deafult: 'linear'</em>) – If ‘linear’, var will be sorted to equally spaced bins. i.e. bin centers increase linearly.
If ‘log’, the bins will be not equally spaced. Instead, they will be equally spaced in log.
… bin centers will be like… 10**0, 10**0.5, 10**1.0, 10**1.5, …, 10**9</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xx_binned</strong> (<em>2d array, bin centers about x</em>)</p></li>
<li><p><strong>yy_binned</strong> (<em>2d array, bin centers about y</em>)</p></li>
<li><p><strong>var_mean</strong> (<em>2d array,  mean values of data in each bin</em>)</p></li>
<li><p><strong>var_err</strong> (<em>2d array, standard error of data in each bin</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_binned_stats3d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_binned_stats3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_binned_stats3d" title="Permalink to this definition"></a></dt>
<dd><p>Make a histogram out of a trio of 1d arrays.
… Returns arg_bins, var_mean, var_err
… The given arrays could contain nans and infs. They will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg</strong> (<em>1d array</em><em>, </em><em>controlling variable</em>) – </p></li>
<li><p><strong>var</strong> (<em>1d array</em><em>, </em><em>data array to be binned</em>) – </p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default: 100</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>deafult: 'linear'</em>) – If ‘linear’, var will be sorted to equally spaced bins. i.e. bin centers increase linearly.
If ‘log’, the bins will be not equally spaced. Instead, they will be equally spaced in log.
… bin centers will be like… 10**0, 10**0.5, 10**1.0, 10**1.5, …, 10**9</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xx_binned</strong> (<em>3d array, bin centers about x</em>)</p></li>
<li><p><strong>yy_binned</strong> (<em>3d array, bin centers about y</em>)</p></li>
<li><p><strong>var_mean</strong> (<em>3d array,  mean values of data in each bin</em>)</p></li>
<li><p><strong>var_err</strong> (<em>3d array, standard error of data in each bin</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_center_of_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_center_of_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_center_of_energy" title="Permalink to this definition"></a></dt>
<dd><p>Returns the center of energy (essentially the center of the blob)- (xc, yc, zc)
using the TIME-AVERAGED ENERGY FIELD.
- It computes the time-averaged energy from udatapath
- Then, it computes the center of energy like the center of mass.
(i.e. the energy density serves as a weight function)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path where velocity field data is stored</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>it uses every inc-th frame of the data to compute the center of energy</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>z1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center_of_energy</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array, center of energy for the time-avg-energy field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_center_of_vorticity">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_center_of_vorticity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_center_of_vorticity" title="Permalink to this definition"></a></dt>
<dd><p>Get the center of vorticity field
… This computes the normalized, first moment of the vorticity field.
… The center of field is not well-defined if values can be positive and negative
…… To avoid this, the sign of the vorticity field must be specified.
…… If sign=’auto’, the sign is automatically determined based on the average vorticity in the field.
…… Otherwise, the sign must be specified as ‘positive’ or ‘negative’
…… The opposite vorticity will be considered to be zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>xx</strong> (<em>nd array</em><em>, </em><em>x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>nd array</em><em>, </em><em>y-coordinates</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>int</em><em>, </em><em>default: 5</em><em>, </em><em>std of the gaussian kernel that is passed to ndimage.gaussian_filter</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>sign</strong> (<em>str</em><em>, </em><em>default: 'auto'</em><em>, </em><em>'positive'</em><em> or </em><em>'negative'</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>y1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>default: 0</em>) – … <a href="#id33"><span class="problematic" id="id34">|vorticity|</span></a> &lt; thd will be considered to be zero</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>centers</strong> – … centers[0, t] = x-coordinate of the center of energy
… centers[1, t] = y-coordinate of the center of energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array with shape (dim, duration), center of energy for each instantenous vorticity field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_characteristic_velocity">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_characteristic_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_characteristic_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Return 1-component RMS velocity, u’
… energy = dim / 2 *  u’^2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>u_irms</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, 1-component RMS velocity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_confidence_levels_on_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_confidence_levels_on_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iw_wrt_eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_confidence_levels_on_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns the alpha values which reflects the confidence levels of the energy spectrum obtained from
a velocity field generated by PIV experiments
… Returned array can be used as alpha values. To plot values with varying alpha, use plt.scatter or
graph.plot_with_varying_alphas. The latter allows to draw lines with different alpha values.</p>
<p>… path/to/module_dir/reference_data/error_functions_of_ek_args_iweta_keta.pkl
contains an function which gives LOGARITHMIC ERROR of the spectrum (log10[Observed E(k) / True E(k)])
with arguments (interrogation window size / eta, keta)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iw_wrt_eta</strong> (<em>float</em>) – <dl class="simple">
<dt>… interrogation window size with respect to Kolmogorov scale</dt><dd><p>i.e. (interrogation window size) / (Kolmogorov scale)</p>
</dd>
</dl>
<p>… here we assume that the interrogation window was a square.</p>
</p></li>
<li><p><strong>keta</strong> (<em>float</em>) – … dimensionless waveumber of the energy spectrum (k times Kolmogorov scale)</p></li>
<li><p><strong>simple</strong> (<em>bool</em>) – <dl class="simple">
<dt>… If True, the returning alphas will be</dt><dd><p>[alpha_max, …, alpha_max, alpha_min, …, alpha_min, ]; alpha changes at keta = keta_c =2.*np.pi / (iw_wrt_eta * 2.)</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alphas</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of alpha values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_confidence_levels_on_structure_function">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_confidence_levels_on_structure_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iw_wrt_eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_confidence_levels_on_structure_function" title="Permalink to this definition"></a></dt>
<dd><p>Returns the alpha values which reflects the confidence levels of the second order longitudinal structure function
obtained from a velocity field generated by PIV experiments
… Returned array can be used as alpha values. To plot values with varying alpha, use plt.scatter or
graph.plot_with_varying_alphas. The latter allows to draw lines with different alpha values.</p>
<p>… path/to/module_dir/reference_data/error_functions_of_dll_args_iweta_keta.pkl
contains an function which gives a SIGNED RELATIVE ERROR of the spectrum (log10[Observed E(k) / True E(k)])
with arguments (interrogation window size / eta, keta)
… You should non-dimensionalize the distance r and the two-pt  correlation function by the most plausible dissipation rate!</p>
<blockquote>
<div><p>You have two choices in experiments.
… 1. Compute epsilon from the rate-of-strain tensor</p>
<blockquote>
<div><p>… However, low resolution PIV could lead to poor estimation of epsilon
2. Compute epsilon such that the structure function exhibits a plateau at y=2.1
… The dissipation rate estimated by this method is more robust than the first method. (It also has its limitaions)</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iw_wrt_eta</strong> (<em>float</em>) – <dl class="simple">
<dt>… interrogation window size with respect to Kolmogorov scale</dt><dd><p>i.e. (interrogation window size) / (Kolmogorov scale)</p>
</dd>
</dl>
<p>… here we assume that the interrogation window was a square.</p>
</p></li>
<li><p><strong>reta</strong> (<em>float</em>) – … dimensionless distance of the second-order structure function (r / Kolmogorov scale)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alphas</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of alpha values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_data_size_in_GB">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_data_size_in_GB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_data_size_in_GB" title="Permalink to this definition"></a></dt>
<dd><p>Returns the data size in GB</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_dissipation_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_dissipation_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flattop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_dissipation_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns dissipation spectrum D(k) = 2 nu k^2 E(k) where E(k) is the 1d energy spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>nd array</em><em> or </em><em>float</em><em>, </em><em>default: None</em>) – dissipation rate used for scaling energy spectrum
If not given, it uses the values estimated using the rate-of-strain tensor</p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of available window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>D_k</strong> (<em>numpy array</em>) – Dissipation spectrum with shape (number of data points, duration)</p></li>
<li><p><strong>D_k_err</strong> (<em>numpy array</em>) – Dissipation spectrum error with shape (number of data points, duration)</p></li>
<li><p><strong>k1d</strong> (<em>numpy array</em>) – Wavenumber with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_duidxj_tensor">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_duidxj_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_duidxj_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Assumes udata has a shape (d, nrows, ncols, duration) or  (d, nrows, ncols)
… one can easily make udata by np.stack((ux, uy))</p>
<p>Important Warning:
… udata is np.stack((ux, uy, uz))
… udata.shape = dim, nrows, ncols, duration
:param udata: … assumes ux/uy/uz has a shape (nrows, ncols, duration) or (nrows, ncols, nstacks, duration)</p>
<blockquote>
<div><p>… can handle udata without a temporal axis</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>x spacing</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>y spacing</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>z spacing</em>) – </p></li>
<li><p><strong>xyz_orientations</strong> (<em>1d array-like with shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – <p>… xyz_orientations = [djdx, didy, dkdz]
… HOW TO DETERMINE xyz_orientations:</p>
<blockquote>
<div><blockquote>
<div><ol class="arabic simple">
<li><dl class="simple">
<dt>Does the xx[0, :] (or xx[0, :, 0] for 3D) monotonically increase as the index increases?</dt><dd><p>If True, djdx = 1
If False, djdx = -1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Does the yy[:, 0] (or yy[:, 0, 0] for 3D) monotonically increase as the index increases?</dt><dd><p>If True, didy = 1
If False, didy = -1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Does the zz[0, 0, :] monotonically increase as the index increases?</dt><dd><p>If True, dkdz = 1
If False, dkdz = -1</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p>… If you are not sure what this is, use</p>
</div></blockquote>
<p>… Factors between index space (ijk) and physical space (xyz)</p>
<dl class="simple">
<dt>… This factor is necessary since the conventions used for the index space and the physical space are different.</dt><dd><p>Consider a 3D array a. a[i, j, k]. The convention used for this module is to interpret this array as a[y, x, z].
(In case of udata, udata[dim, y, x, z, t])
All useful modules such as numpy are written in the index space, but this convention is not ideal for physicists
for several reasons.
1. many experimental data are not organized in the index space.
2. One always requires conversion between the index space and physical space especially at the end of the analysis.
(physicists like to present in the units of physical units not in terms of ijk)</p>
</dd>
<dt>… This array is essentially a Jacobian between the index space basis (ijk) and the physical space basis (xyz)</dt><dd><p>All information needed is just dx/dj, dy/di, dz/dk because ijk and xyz are both orthogonal bases.
There is no off-diagonal elements in the Jacobian matrix, and one needs to supply only 3 elements for 3D udata.
If I strictly use the Cartesian basis for xyz (as it should), then I could say they are both orthonormal.
This makes each element of the Jacobian array to be either 1 or -1, reflecting the directions of +x/+y/+z
with respect to +j/+i/+k</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>sij</strong> –</p>
<dl class="simple">
<dt>… idea is… sij[spacial coordinates, time, tensor indices]</dt><dd><p>e.g.-  sij(x, y, t) = sij[y, x, t, i, j]</p>
</dd>
</dl>
<p>… sij = d ui / dxj</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array with shape (nrows, ncols, duration, 2, 2) (dim=2) or (nrows, ncols, nstacks, duration, 3, 3) (dim=3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns energy(</p>
</div></blockquote>
<dl>
<dt>ec{x}, t) of udata</dt><dd><p>… energy = np.nansum(udata**2, axis=0) / 2</p>
<p>udata: nd array</p>
<p>energy: nd array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectra_jhtd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectra_jhtd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectra_jhtd" title="Permalink to this definition"></a></dt>
<dd><p>Returns values to plot energy spectrum from JHTD, computed by Takumi in 2019
Call get_rescaled_energy_spectra_jhtd for scaled energy spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>datadict</strong> – data stored is stored in ‘/reference_data/jhtd_e_specs.h5’</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_undersampled_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dealiasing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns an energy spectrum from velocity field data
… The algorithm implemented in this function is VERY QUICK because it does not use the two-point autorcorrelation tensor.
… Instead, it converts u(kx, ky, kz)u*(kx, ky, kz) into u(kr)u*(kr). (here * dentoes the complex conjugate)
… CAUTION: Must provide udata with aspect ratio ~ 1
…… The conversion process induces unnecessary error IF the dimension of u(kx, ky, kz) is skewed.
…… i.e. Make udata.shape like (800, 800), (1024, 1024), (512, 512) for accurate results.
… KNOWN ISSUES:
…… This function returns a bad result for udata with shape like (800, 800, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>nd array</em><em> or </em><em>float</em><em>, </em><em>default: None</em>) – dissipation rate used for scaling energy spectrum
If not given, it uses the values estimated using the rate-of-strain tensor</p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>a name of the windowing function</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
<li><p><strong>cc</strong> (<em>float</em><em>, </em><em>default: 1.75</em>) – A numerical factor to compensate for the signal loss due to approximations.
… cc=1.75 was obtained from the JHTD data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>e_k</strong> (<em>numpy array</em>) – Energy spectrum with shape (number of data points, duration)</p></li>
<li><p><strong>e_k_err</strong> (<em>numpy array</em>) – Energy spectrum error with shape (number of data points, duration)</p></li>
<li><p><strong>kk</strong> (<em>numpy array</em>) – Wavenumber with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectrum_nd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectrum_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wavenumber'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dealiasing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectrum_nd" title="Permalink to this definition"></a></dt>
<dd><p>Returns ukdata * np.conjugate(ukdata) where ukdata is the ND-Fourier Transform of udata
…
:param udata:
:type udata: nd array that contains a velocity field with a shape (dim, y, x, (z), duration)
:param x0: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type x0: int, default: 0
:param x1 int: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type x1 int: None
:param default: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type default: None
:param y0 int: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type y0 int: 0
:param default: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type default: 0
:param y1 int: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type y1 int: None
:param default: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type default: None
:param z0 int: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type z0 int: 0
:param default: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type default: 0
:param z1 int: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type z1 int: None
:param default: … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])
:type default: None
:param dx:
:type dx: float, spacing of the x-grid
:param dy:
:type dy: float, spacing of the y-grid
:param dz:
:type dz: float, spacing of the z-grid
:param window:
:type window: str,
:param correct_signal_loss:
:param return_in: … wavenumber:=2pi/L, freq:=1/L
:type return_in: str, Choose from ‘wavenumber’ and ‘freq’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>… If return_in=’’wavenumber’, it returns norm of ND-CFT of velocity field as a function of wavenumber (2pi/x) instead of frequency (1/x)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ef_nd, np.asarray([fxx, fyy, fzz])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectrum_nd_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectrum_nd_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectrum_nd_old" title="Permalink to this definition"></a></dt>
<dd><p>DEPRECATED: TM cleaned up the code, and improved the literacy and transparency of the algorithm- TM (Sep 2020)
… Please use the updated function: get_energy_spectrum_nd()
… the new function correctly returns the SPECTRAL DENSITY. T
…… This code might contain minor errors (like a factor of 2pi). The new code has no such ambiguity.</p>
<p>Returns nd energy spectrum from velocity data (FFT of a velocity field)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em>) – </p></li>
<li><p><strong>dx</strong> – spacing in x</p></li>
<li><p><strong>dy</strong> – spacing in y</p></li>
<li><p><strong>dz</strong> – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>energy_fft</strong> (<em>nd array with shape (height, width, duration) or (height, width, depth, duration)</em>)</p></li>
<li><p><strong>ks</strong> (<em>nd array with shape (ncomponents, height, width, duration) or (ncomponents, height, width, depth, duration)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>nx, ny = 100, 100
x = np.linspace(0, 2*np.pi, nx)
y = np.linspace(0, 4*np.pi, ny)
dx, dy = x[1]- x[0], y[1]-y[0]</p>
<p># Position grid
xx, yy = np.meshgrid(x, y)</p>
<p># In Fourier space, energy will have a peak at (kx, ky) = (+/- 5, +/- 2)
ux = np.sin(2.5*xx + yy)
uy = np.sin(yy) * 0
udata_test = np.stack((ux, uy))
ek, ks = get_energy_spectrum_nd(udata_test, dx=dx, dy=dy)
graph.color_plot(xx, yy, (ux**2 + uy**2 ) /2., fignum=2, subplot=121)
fig22, ax22, cc22 = graph.color_plot(ks[0], ks[1], ek.real[…, 0], fignum=2, subplot=122, figsize=(16, 8))
graph.setaxes(ax22, -10, 10, -10, 10)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectrum_nd_ver2">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectrum_nd_ver2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectral</span> <span class="pre">density'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectrum_nd_ver2" title="Permalink to this definition"></a></dt>
<dd><p>Returns ND energy spectrum from velocity data (FFT of a velocity field)
… Returns the SPECTRUM DENSITY not power (integrated spectral density)
… Few Important Tips:</p>
<blockquote>
<div><dl class="simple">
<dt>… np.fft.fft() returns POWER not spectrum density</dt><dd><dl class="simple">
<dt>… If you want to check Parseval’s theorem, you must use the POWER not SPECTRAL DENSITY</dt><dd><dl class="simple">
<dt>Parseval’s theorem:</dt><dd><p>ukdata =  np.fft.fft(udata, axis=(1, dim+1)
1/n_samples * np.nansum( ukdata * np.conjucate(ukdata)) ) = np.nansum(udata ** 2)</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>… np.fft.fft() returns the DFT in frequency space (NOT ANGULAR FREQUENCY space)
… To convert the power (DFT output) to spectral density, one must do following.</p>
<blockquote>
<div><blockquote>
<div><p>ukdata /= (dfx * dfy * dfz) * n_samples</p>
</div></blockquote>
<p>… where dfx = 1 / dx, etc. and n_samples is the number of samples actually discrete-fourie transformed.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em>) – </p></li>
<li><p><strong>dx</strong> – spacing in x</p></li>
<li><p><strong>dy</strong> – spacing in y</p></li>
<li><p><strong>dz</strong> – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>energy_fft</strong> (<em>nd array with shape (height, width, duration) or (height, width, depth, duration)</em>)</p></li>
<li><p><strong>ks</strong> (<em>nd array with shape (ncomponents, height, width, duration) or (ncomponents, height, width, depth, duration)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>nx, ny = 100, 100
x = np.linspace(0, 2*np.pi, nx)
y = np.linspace(0, 4*np.pi, ny)
dx, dy = x[1]- x[0], y[1]-y[0]</p>
<p># Position grid
xx, yy = np.meshgrid(x, y)</p>
<p># In Fourier space, energy will have a peak at (kx, ky) = (+/- 5, +/- 2)
ux = np.sin(2.5*xx + yy)
uy = np.sin(yy) * 0
udata_test = np.stack((ux, uy))
ek, ks = get_energy_spectrum_nd(udata_test, dx=dx, dy=dy)
graph.color_plot(xx, yy, (ux**2 + uy**2 ) /2., fignum=2, subplot=121)
fig22, ax22, cc22 = graph.color_plot(ks[0], ks[1], ek.real[…, 0], fignum=2, subplot=122, figsize=(16, 8))
graph.setaxes(ax22, -10, 10, -10, 10)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectrum_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectrum_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_undersampled_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectrum_old" title="Permalink to this definition"></a></dt>
<dd><p>DEPRECATED: TM cleaned up the code, and improved the literacy and transparency of the algorithm- TM (Sep 2020)</p>
<p>Returns 1D energy spectrum from velocity field data
… The algorithm implemented in this function is VERY QUICK because it does not use the two-point  autorcorrelation tensor.
… Instead, it converts u(kx, ky, kz)u*(kx, ky, kz) into u(kr)u*(kr). (here * dentoes the complex conjugate)
… CAUTION: Must provide udata with aspect ratio ~ 1
…… The conversion process induces unnecessary error IF the dimension of u(kx, ky, kz) is skewed.
…… i.e. Make udata.shape like (800, 800), (1024, 1024), (512, 512) for accurate results.
… KNOWN ISSUES:
…… This function returns a bad result for udata with shape like (800, 800, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>nd array</em><em> or </em><em>float</em><em>, </em><em>default: None</em>) – dissipation rate used for scaling energy spectrum
If not given, it uses the values estimated using the rate-of-strain tensor</p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
<li><p><strong>remove_undersampled_region</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it will not sample the region with less statistics.</p></li>
<li><p><strong>cc</strong> (<em>float</em><em>, </em><em>default: 1.75</em>) – A numerical factor to compensate for the signal loss due to approximations.
… cc=1.75 was obtained from the JHTD data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>e_k</strong> (<em>numpy array</em>) – Energy spectrum with shape (number of data points, duration)</p></li>
<li><p><strong>e_k_err</strong> (<em>numpy array</em>) – Energy spectrum error with shape (number of data points, duration)</p></li>
<li><p><strong>kk</strong> (<em>numpy array</em>) – Wavenumber with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_energy_spectrum_ver2">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_energy_spectrum_ver2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_undersampled_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_energy_spectrum_ver2" title="Permalink to this definition"></a></dt>
<dd><p>Returns 1D energy spectrum from velocity field data
… The algorithm implemented in this function is VERY QUICK because it does not use the two-point  autorcorrelation tensor.
… Instead, it converts u(kx, ky, kz)u*(kx, ky, kz) into u(kr)u*(kr). (here * dentoes the complex conjugate)
… CAUTION: Must provide udata with aspect ratio ~ 1
…… The conversion process induces unnecessary error IF the dimension of u(kx, ky, kz) is skewed.
…… i.e. Make udata.shape like (800, 800), (1024, 1024), (512, 512) for accurate results.
… KNOWN ISSUES:
…… This function returns a bad result for udata with shape like (800, 800, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>nd array</em><em> or </em><em>float</em><em>, </em><em>default: None</em>) – dissipation rate used for scaling energy spectrum
If not given, it uses the values estimated using the rate-of-strain tensor</p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
<li><p><strong>remove_undersampled_region</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it will not sample the region with less statistics.</p></li>
<li><p><strong>cc</strong> (<em>float</em><em>, </em><em>default: 1.75</em>) – A numerical factor to compensate for the signal loss due to approximations.
… cc=1.75 was obtained from the JHTD data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>e_k</strong> (<em>numpy array</em>) – Energy spectrum with shape (number of data points, duration)</p></li>
<li><p><strong>e_k_err</strong> (<em>numpy array</em>) – Energy spectrum error with shape (number of data points, duration)</p></li>
<li><p><strong>kk</strong> (<em>numpy array</em>) – Wavenumber with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_enstrophy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_enstrophy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_enstrophy" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns enstrophy(</p>
</div></blockquote>
<dl>
<dt>ec{x}, t) of udata</dt><dd><p>… enstropy = omega ** 2
… omega = curl(udata)</p>
<p>udata: nd array
dx: float</p>
<blockquote>
<div><p>data spacing along x</p>
</div></blockquote>
<dl class="simple">
<dt>dy: float</dt><dd><p>data spacing along y</p>
</dd>
<dt>dz: float</dt><dd><p>data spacing along z</p>
</dd>
</dl>
<p>enstrophy: nd array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_enstrophy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_enstrophy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dealiasing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_enstrophy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Compute the enstrophy spectrum from a velocity field (udata)</p>
<p>… CAUTION: Must provide udata with aspect ratio ~ 1
…… The conversion process induces unnecessary error IF the dimension of u(kx, ky, kz) is skewed.
…… i.e. Make udata.shape like (800, 800), (1024, 1024), (512, 512) for accurate results.
… KNOWN ISSUES:
…… This function returns a bad result for a highly skewed udata with shape like (dim, 800, 800, 2, duration)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>ndarray</em><em>, </em><em>a velocity field</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>the standard deviation of the Gaussian kernel</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>a name of the windowing function</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
<li><p><strong>cc</strong> (<em>float</em><em>, </em><em>default: 1</em>) – … an arbitrary constant to scale the enstrophy spectrum
… this is used to mimic 1D enstrophy spectrum from a 3D spectrum.</p></li>
<li><p><strong>xx</strong> (<em>ndarray</em><em>, </em><em>x-coordinates of the data</em><em>, </em><em>used to compute vorticity</em><em> (</em><em>Passng xx/yy/zz is recommended rather than passing dx</em><em>, </em><em>dy</em><em>, </em><em>dz</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>ndarray</em><em>, </em><em>y-coordinates of the data</em><em>, </em><em>used to compute vorticity</em><em> (</em><em>Passng xx/yy/zz is recommended rather than passing dx</em><em>, </em><em>dy</em><em>, </em><em>dz</em><em>)</em>) – </p></li>
<li><p><strong>zz</strong> (<em>ndarray</em><em>, </em><em>z-coordinates of the data</em><em>, </em><em>used to compute vorticity</em><em> (</em><em>Passng xx/yy/zz is recommended rather than passing dx</em><em>, </em><em>dy</em><em>, </em><em>dz</em><em>)</em>) – </p></li>
<li><p><strong>notebook</strong> – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default: 'linear'</em>) – … ‘linear’ or ‘log’
… sampling of the energy spectrum will be conducted with bins that are linearly/logarithmically spaced</p></li>
<li><p><strong>dealiasing</strong> (<em>if True</em><em>, </em><em>it pads the data with zeros to make the array square to mitigate aliasing effects..</em>) – </p></li>
<li><p><strong>padding_mode</strong> (<em>str</em><em>, </em><em>default: 'edge'</em>) – … arguments are passed to np.pad(array, pad_width, padding_mode, <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs)</p></li>
<li><p><strong>padding_kwargs</strong> – … keyword arguments for np.pad()</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, it prints out the result of a sanity check based on the Parseval’s theorem.
… It checks identity at t=0: &lt;omega_i omega_i&gt; = int_0^infty P(k)dk at t0=0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>enst_k</strong> (<em>2d array, 3D enstrophy spectrum</em>) – … (nkout, duration)</p></li>
<li><p><strong>enst_k_err</strong> (<em>2d array, standard error of enstrophy spectrum</em>) – … (nkout, duration)</p></li>
<li><p><strong>kk</strong> (<em>1d array</em>) – … k-values of the enstrophy spectrum</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_enstrophy_spectrum_nd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_enstrophy_spectrum_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wavenumber'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dealiasing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_enstrophy_spectrum_nd" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compute enstrophy spectrum of a 2/3D data.</dt><dd><p>… omegak * np.conjugate(omegak)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>Standard deviation for Gaussian kernel</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>a name of the windowing function</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of applying window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
<li><p><strong>return_in</strong> (<em>str</em><em>, </em><em>default: 'wavenumber'</em>) – <dl class="simple">
<dt>… the returning power will be in the units of</dt><dd><p>’wavenumber’:(1/s^2) * (rad/m)^3
‘frequency’: (1/s^2) * (1/m)^3</p>
</dd>
</dl>
<p>… ‘wavenumber’: 2pi / L
… ‘frequency’: 1 / L</p>
</p></li>
<li><p><strong>dealiasing</strong> (<em>if True</em><em>, </em><em>it pads the data with zeros to make the array square to mitigate aliasing effects..</em>) – </p></li>
<li><p><strong>padding_mode</strong> (<em>str</em><em>, </em><em>default: 'edge'</em>) – … arguments are passed to np.pad(array, pad_width, padding_mode, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs)</p></li>
<li><p><strong>padding_kwargs</strong> – … keyword arguments for np.pad()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ef_nd</strong> (<em>nd array, enstrophy power density(dim, ky, kx, kz, duration)</em>) – … If return_in=’’wavenumber’, it returns norm of ND-CFT of velocity field as a function of wavenumber (2pi/x) instead of frequency (1/x)</p></li>
<li><p><em>OPTIONAL</em></p></li>
<li><p><strong>ky, kx, kz</strong> (<em>nd array, wavenumber(ky, kx, kz) = 2pi/L</em>) – or</p></li>
<li><p><strong>fy, fx, fz</strong> (<em>nd array, frequency(fy, fx, fz) = 1/L</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_from_1d_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_from_1d_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.491</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_from_1d_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dissipation rate from a 1D energy spectrum
How it works:</p>
<blockquote>
<div><dl class="simple">
<dt>Since</dt><dd><p>E11=c1 epsilon^(2/3) k^(-5/3) in the inertial subrange,</p>
</dd>
<dt>then</dt><dd><p>epsilon = (E11/ (c1 k^(-5/3)))^(3/2)</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>nrows</em><em>, </em><em>ncols</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>k</strong> (<em>str</em><em>, </em><em>'kx'</em><em> or </em><em>'ky'</em><em>, </em><em>the direction along which the 1D spectrum is computed</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>spacing along x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>spacing along y</em>) – </p></li>
<li><p><strong>c1</strong> (<em>kolmogorov constant for E11=c1 epsilon^</em><em>(</em><em>2/3</em><em>) </em><em>k^</em><em>(</em><em>-5/3</em><em>)</em>) – </p></li>
<li><p><strong>r</strong> (<em>tuple</em><em>, </em><em>(</em><em>r0</em><em>, </em><em>r1</em><em>)</em>) – … (r0, r1) defines a inertial subrange</p></li>
<li><p><strong>kwargs</strong> (<em>keyword arguments passed to get_1d_energy_spectrum</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epsilons</strong> (<em>1d array with shape (duration, )</em>)</p></li>
<li><p><strong>epsilon_stds</strong> (<em>1d array with shape (duration, ), std of the dissipation rate (std of the n largest values of f(r))</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_iso">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_iso" title="Permalink to this definition"></a></dt>
<dd><p>Return dissipation rate (epsilon) computed by isotropic formula involving Taylor microscale
Isotropic formula:
… epsilon = 30. * nu * u2_irms / (lambda_f ** 2)
… epsilon = 15. * nu * u2_irms / (lambda_g ** 2)</p>
<p>How it works:
… if Taylor microscales (lambdas) are not provided, then it attempts to compute them from udata.
… If either or both of lambda_f and lambda_g are provided, then it uses them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a velocity field</em><em> (</em><em>dim</em><em>, </em><em>nrows</em><em>, </em><em>ncols</em><em>, </em><em>nstacks</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>x</strong> (<em>2d array</em><em>, </em><em>x coordinates- get x from get_udata_from_path</em><em>(</em><em>dpath</em><em>, </em><em>return_xy=True</em><em>)</em>) – </p></li>
<li><p><strong>y</strong> (<em>2d array</em><em>, </em><em>y coordinates- get y from get_udata_from_path</em><em>(</em><em>dpath</em><em>, </em><em>return_xy=True</em><em>)</em>) – </p></li>
<li><p><strong>lambda_f</strong> (<em>float/1d array</em><em>, </em><em>longitudinal two-point correlation function</em>) – </p></li>
<li><p><strong>lambda_g</strong> (<em>float/1d array</em><em>, </em><em>transverse two-point correlation function</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>viscosity</em><em>, </em><em>default: 1.004</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index to specify a portion of data in which autocorrelation funciton is computed. Use data u</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em><em></em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index to specify a portion of data in which autocorrelation funciton is computed. Use data u</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em><em></em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index to specify a portion of data in which autocorrelation funciton is computed. Use data u</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em><em></em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index to specify a portion of data in which autocorrelation funciton is computed. Use data u</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em><em></em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>provided</strong> (<em>...</em><em> passed to get_two_point_vel_corr_iso</em><em>(</em><em>) </em><em>if lambda_f and lambda_g are not</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epsilon</strong> (<em>float/1d array with shape (duration,)</em>)</p></li>
<li><p><em>… dissipation rate</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_local_using_sij">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_local_using_sij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_local_using_sij" title="Permalink to this definition"></a></dt>
<dd><p>Returns the local dissipation rate computed using the rate-of-strain tensor
… epsilon(x, y, z, t) = 2 * nu * sij(x, y, z, t) sij(x, y, z, t)</p>
<blockquote>
<div><p>sij: numpy array with shape (nrows, ncols, duration, 2, 2) (dim=2) or (nrows, ncols, nstacks, duration, 3, 3) (dim=3)
… sij[spacial coordinates, time, tensor indices]</p>
<blockquote>
<div><p>e.g.-  sij(x, y, t) can be accessed by sij[y, x, t, i, j]</p>
</div></blockquote>
<p>… sij = d ui / dxj</p>
</div></blockquote>
<dl class="simple">
<dt>… To compute epsilon, it uses a formula from Hinze (1975)</dt><dd><p>… epsilon_spatial = 6. * nu * (epsilon_0 + epsilon_1 + epsilon_2)  # Hinze, 1975, eq. 3-98</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>kinematic viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>x-coordinate of the data</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>y-coordinate of the data</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>z-coordinate of the data</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epsilon_spatial</strong> – … dissipation rate with shape (nrows, ncols, (nstacks), duration)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_using_diss_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_using_diss_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0034</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_using_diss_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns dissipation rate computed by integrated the dissipation specrtrum
… must have a fully resolved spectrum to yield a reasonable result</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epsilon</strong> – dissipation rate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_using_sij">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_using_sij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_using_sij" title="Permalink to this definition"></a></dt>
<dd><p>Returns the dissipation rate computed using the rate-of-strain tensor</p>
<p>sij: numpy array with shape (nrows, ncols, duration, 2, 2) (dim=2) or (nrows, ncols, nstacks, duration, 3, 3) (dim=3)
… idea is… sij[spacial coordinates, time, tensor indices]</p>
<blockquote>
<div><p>e.g.-  sij(x, y, t) can be accessed by sij[y, x, t, i, j]</p>
</div></blockquote>
<p>… sij = d ui / dxj
:param udata:
:type udata: nd array
:param nu:
:type nu: flaot, viscosity
:param x0: index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
:type x0: int
:param x1: index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
:type x1: int
:param y0: index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
:type y0: int
:param y1: index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
:type y1: int
:param t0: index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
:type t0: int
:param t1: index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].
:type t1: int
:param dx: spacing in x
:type dx: float
:param dy: spacing in y
:type dy: float
:param dz: spacing in z
:type dz: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>epsilon</strong> – dissipation rate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_using_struc_func">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_using_struc_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_using_struc_func" title="Permalink to this definition"></a></dt>
<dd><p>Estimates dissipation rate based on the plateau of the rescaled structure funciton
… Structure function D = c(epsilon r)^{p/3} in the inertial subrage, ignoring the intermittency correction</p>
<blockquote>
<div><p>Let f be f(r)=(D/c)^{3/p} / r.
Then, f(r)= epsilon where r is in the inertial subrange. This is essentially the value at the plateau.
… This function grabs the n largest values of f(r), and considers its average as a dissipation rate.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dll</strong> (<em>nd array with shape</em><em> (</em><em>m</em><em>, </em><em>duration</em><em>)</em>) – … the p-th order structure function
… one of the outputs of get_structure_function()</p></li>
<li><p><strong>r_dll</strong> (<em>nd array with shape</em><em> (</em><em>m</em><em>, </em><em>duration</em><em>)</em>) – … separation length for the structure function (correlation function of the velocity difference)</p></li>
<li><p><strong>c</strong> (<em>float</em><em>, </em><em>default:2.1</em><em> (</em><em>applicable to p=2</em><em>)</em>) – … Kolmogorov constant for the p-th order structure function
… c=2.1 (p=2, experiment), c=-4/5 (p=3, theory)</p></li>
<li><p><strong>p</strong> (<em>float</em><em>, </em><em>order of the structure function</em>) – … the order of the structure function</p></li>
<li><p><strong>n</strong> (<em>int</em>) – … number of structure peaks of f(r) used to estimate the dissipation rate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>epsilons</strong> (<em>1d array with shape (duration, ), dissipation rate (mean of the n largest values of f(r))</em>)</p></li>
<li><p><strong>epsilon_stds</strong> (<em>1d array with shape (duration, ), std of the dissipation rate (std of the n largest values of f(r))</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_epsilon_using_struc_func_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_epsilon_using_struc_func_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dxxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Nelder-Mead'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_epsilon_using_struc_func_old" title="Permalink to this definition"></a></dt>
<dd><p>[DEPRICATED]
Returns the values of estimated dissipation rate using a long. structure function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rrs</strong> (<em>numpy array</em>) – separation length for long. transverse function</p></li>
<li><p><strong>Dxxs</strong> (<em>numpy array</em>) – values of long. transverse function</p></li>
<li><p><strong>epsilon_guess</strong> (<em>numpy array</em>) – initial guess for dissipation rate</p></li>
<li><p><strong>r0</strong> (<em>float</em>) – The scaled structure function is expected to have a plateau [r0, r1]</p></li>
<li><p><strong>r1</strong> (<em>float</em>) – The scaled structure function is expected to have a plateau [r0, r1]</p></li>
<li><p><strong>p</strong> (<em>float/int</em>) – order of structure function
… smaller order is better due to intermittency</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default: 'Nelder-Mead'</em>) – method used to find the minimum of the test function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epsilons</strong> – estimated dissipation rate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_equally_spaced_grid">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_equally_spaced_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_equally_spaced_grid" title="Permalink to this definition"></a></dt>
<dd><p>Returns an evenly spaced grid for the given udata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>v-field data</em>) – </p></li>
<li><p><strong>d</strong> (<em>spacing of the grid</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xx, yy, (zz)</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D or 3D numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_equally_spaced_kgrid">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_equally_spaced_kgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_equally_spaced_kgrid" title="Permalink to this definition"></a></dt>
<dd><p>Returns a equally spaced grid to plot FFT of udata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>dx</strong> (<em>spacing of the grid in the real space</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kxx, kyy, (kzz)</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D or 3D numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_flow_about_a_lifting_cylinder">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_flow_about_a_lifting_cylinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.7853981633974483</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_in_xy_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_flow_about_a_lifting_cylinder" title="Permalink to this definition"></a></dt>
<dd><p>Returns a flow (udata) about a lifting cylinder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y-coordinates</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>x-coordinate of cylinder</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>y-coordinate of cylinder</em>) – </p></li>
<li><p><strong>u</strong> (<em>float</em><em>, </em><em>default: 1</em><em>, </em><em>magnitude of the stream velocity</em>) – </p></li>
<li><p><strong>a</strong> (<em>radius of cylinder</em>) – </p></li>
<li><p><strong>beta</strong> (<em>angle of the stream</em>) – </p></li>
<li><p><strong>return_in_xy_basis</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>returns udata in cartesian coordinates</em>) – … if return_in_xy_basis=False, returns udata in polar coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, streamfunction values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_flow_past_a_circular_cylinder">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_flow_past_a_circular_cylinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_in_xy_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_flow_past_a_circular_cylinder" title="Permalink to this definition"></a></dt>
<dd><p>Returns udata (ux, uy) of a flow past a circular cylinder in Stokes limit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y-coordinates</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>x-coordinate of cylinder</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>y-coordinate of cylinder</em>) – </p></li>
<li><p><strong>U</strong> (<em>float</em><em>, </em><em>default: 1</em><em>, </em><em>magnitude of the stream velocity</em>) – </p></li>
<li><p><strong>a</strong> (<em>radius of cylinder</em>) – </p></li>
<li><p><strong>return_in_xy_basis</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>returns udata in cartesian coordinates</em>) – … if return_in_xy_basis=False, returns udata in polar coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, streamfunction values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_grid_spacing">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_grid_spacing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_grid_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Returns the spacing of the grid</p>
<p>Index i, j, k corresponds to physical space y, x, z
… x = xx[0, :, (0, optional)]
… y = yy[:, 0, (0, optional)]
… z = zz[0, 0, :]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>a grid of x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>a grid of y-coordinates</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>a grid of z-coordinates</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dx, dy, dz</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>floats, spacing of the grid along each axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_h5_keys">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_h5_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_h5_keys" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of dataset names in h5- only the datasets stored under the top
… /Dataset1, /Dataset2, … -&gt; Returns [“Dataset1”, “Dataset2”]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_h5_subkeys">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_h5_subkeys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_h5_subkeys" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of dataset names in h5- only the datasets stored under /key
… key/Dataset1, key/Dataset2, … -&gt; Returns [“Dataset1”, “Dataset2”]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_hamming_window_radial">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_hamming_window_radial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_hamming_window_radial" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns the Hamming window as a function of radius</dt><dd><p>… r = 0 corresponds to the center of the window.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>point</strong> (<em>...</em><em> radius from the center</em>) – </p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – </p></li>
<li><p><strong>...</strong> – </p></li>
<li><p><strong>duration</strong> (<em>int</em>) – </p></li>
<li><p><strong>None</strong> (<em>...</em><em> if</em>) – </p></li>
<li><p><strong>(</strong><strong>height</strong> (<em>this returns</em>) – </p></li>
<li><p><strong>width</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>height</strong> – </p></li>
<li><p><strong>width</strong> – </p></li>
<li><p><strong>depth</strong><strong>)</strong> – </p></li>
<li><p><strong>Otherwise</strong> (<em>...</em>) – </p></li>
<li><p><strong>(</strong><strong>height</strong> – </p></li>
<li><p><strong>width</strong> – </p></li>
<li><p><strong>duration</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>height</strong> – </p></li>
<li><p><strong>width</strong> – </p></li>
<li><p><strong>depth</strong> – </p></li>
<li><p><strong>duration</strong><strong>)</strong> – </p></li>
<li><p><strong>purposes.</strong> (<em>...</em><em> duration = udata.shape</em><em>[</em><em>-1</em><em>] </em><em>should work for most of</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>window/windows</strong> (<em>nd array</em>)</p></li>
<li><p><strong>… window</strong> (<em>hamming window with the shape as xx</em>)</p></li>
<li><p><strong>… window</strong> (<em>hamming window with the shape (xx.shape[:], duration)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_helicity">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_helicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_helicity" title="Permalink to this definition"></a></dt>
<dd><p>(For 3D velocity field)
Returns a scalar field such that u dot omega</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>4d/5d array</em><em>, </em><em>v-field data with shape</em><em> (</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>) or </em><em>(</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>, </em><em>t</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em>) – </p></li>
<li><p><strong>crop</strong> (<em>int</em><em>, </em><em>&gt;0</em><em> or </em><em>None</em>) – … it replaces the values near the edges to np.nan because omega often behaves ill near the edges
… helicity_density[crop:-crop, crop:-crop, crop:-crop, :] = np.nan[crop:-crop, crop:-crop, crop:-crop, :] = np.nan</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>helicity</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, shape (duration.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_helicity_density">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_helicity_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_helicity_density" title="Permalink to this definition"></a></dt>
<dd><p>Returns helicity density u cdot omega
…
:param udata:
:type udata: (4d or 5d) array, 3d velocity field (components(ux, uy, uz), x, y, z, t)
:param xx:
:type xx: 3d array
:param yy:
:type yy: 3d array
:param zz:
:type zz: 3d array
:param crop: … it replaces the values near the edges to np.nan because omega often behaves ill near the edges</p>
<blockquote>
<div><p>… helicity_density[crop:-crop, crop:-crop, crop:-crop, :] = np.nan[crop:-crop, crop:-crop, crop:-crop, :] = np.nan</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>helicity_density</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>4d array (x, y, z, t)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_impulse">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_impulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_impulse" title="Permalink to this definition"></a></dt>
<dd><p>Returns the hydrodynamic impulse inside the region defined by xx, yy, zz
… Consider the momentum contained in a simply connected domain G.</p>
<blockquote>
<div><p>(total fluid momentum in G) = (hydrodynamic impulse in G) + (surface terms)
… Saffman “Vortex Dynamics” Ch. 3.3 Eq 13</p>
</div></blockquote>
<p>… it returns an array of a shape (duration, )</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>4d/5d array</em><em>, </em><em>v-field data with shape</em><em> (</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>) or </em><em>(</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>, </em><em>t</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>positional grid about x</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>positional grid about y</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>positional grid about z</em>) – </p></li>
<li><p><strong>rho</strong> (<em>fluid density</em><em>, </em><em>default 1e-3 g/mm3</em>) – </p></li>
<li><p><strong>crop</strong> (<em>int</em><em>, </em><em>crop the domain near the edge to remove the boundary effects</em>) – </p></li>
<li><p><strong>keep</strong> (<em>boolean array</em><em>, </em><em>indices of the points to keep</em>) – </p></li>
<li><p><strong>R</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>zc</strong> (<em>float</em><em>, </em><em>if given</em><em>, </em><em>it gives the impulse inside a sphere of radius R centered at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hydrodynamic impulse, (optional</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bulk term, surface term): 2d array (components, duration)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_impulse_density">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_impulse_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_impulse_density" title="Permalink to this definition"></a></dt>
<dd><p>It returns the density of hydrodynamic impulse
hydrodynamic impulse is defined as
… P = 0.5 [ int r        imes omega dV + int r         imes (n         imes u) dS]</p>
<blockquote>
<div><blockquote>
<div><p>= (Bulk term) + (Surface Term)</p>
</div></blockquote>
<dl class="simple">
<dt>… It is best understood when this form is differentiated</dt><dd><p>dP/dt = (bulk force like gravity) + (surface force: f_i = sigma_ij n_j where sigma is viscous stress tensor)</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a 3D velocity field</em><em> (</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>, </em><em>(</em><em>t: optional</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d grid</em><em>, </em><em>x-coordinate of the udata</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d grid</em><em>, </em><em>y-coordinate of the udata</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d grid</em><em>, </em><em>z-coordinate of the udata</em>) – </p></li>
<li><p><strong>rho</strong> (<em>density of fluid</em><em>, </em><em>default: 0.001</em><em> (</em><em>g/mm^3 for water</em><em>)</em>) – </p></li>
<li><p><strong>crop</strong> (<em>int</em><em>, </em><em>greater</em><em> or </em><em>equal to 0</em>) – … Sets the values of omega near the edge to np.nan</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>5d array: hydrodynamic impulse density (3, y, x, z, t)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_instantaneous_center_of_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_instantaneous_center_of_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_instantaneous_center_of_energy" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates the center of energy from the instantaneous energy field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array with shape</em><em> (</em><em>dim</em><em>, </em><em>width</em><em>, </em><em>height</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>nd array with shape</em><em> (</em><em>width</em><em>, </em><em>height</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>nd array with shape</em><em> (</em><em>width</em><em>, </em><em>height</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>zz</strong> (<em>nd array with shape</em><em> (</em><em>width</em><em>, </em><em>height</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>) </em><em>(</em><em>optional</em><em>)</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index used to define the x-range of the v-field: udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index used to define the x-range of the v-field: udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index used to define the x-range of the v-field: udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index used to define the x-range of the v-field: udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index used to define the x-range of the v-field: udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>...</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index used to define the x-range of the v-field: udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>...</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>centers</strong> – … centers[0, t] = x-coordinate of the center of energy
… centers[1, t] = y-coordinate of the center of energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array with shape (dim, duration), center of energy for each instantenous energy field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_integral_scale_large_eddy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_integral_scale_large_eddy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_integral_scale_large_eddy" title="Permalink to this definition"></a></dt>
<dd><p>dissipation rate (epsilon) is known to be proportional to u’^3 / L.</p>
<p>Some just define an integral scale L as u’^3 / epsilon.
This method just returns this ratio. It is often interpreted as the characteristic scale of large eddies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>numpy array / float</em>) – dissipation rate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>L</strong> – integral length scale (characterisic size of large eddies)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_integral_scales">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_integral_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trapz'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_integral_scales" title="Permalink to this definition"></a></dt>
<dd><p>Returns integral scales computed by using autocorrelation functions
… To have a meaningful result, the autocorrelation functions must be fully resolved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_long</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>array</strong> (<em>g_tran numpy</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>array</strong> – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>array</strong> – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>default: 'trapz'</em>) – … integration method, choose from quadrature or trapezoidal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>L11</strong> (<em>numpy array</em>) – longitudinal integral length scale</p></li>
<li><p><strong>L22</strong> (<em>numpy array</em>) – transverse integral length scale</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_integral_scales_all">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_integral_scales_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_integral_scales_all" title="Permalink to this definition"></a></dt>
<dd><p>Returns integral scales of turbulence
… L = u_irms ** 3 / epsilon
… U = u_irms
… T = L/U #
:param udata:
:type udata: numpy array
:param dx: data spacing in x
:type dx: float
:param dy: data spacing in y
:type dy: float
:param dz: data spacing in z
:type dz: float
:param nu: viscosity
:type nu: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>L_le</strong> (<em>1d array, integral length scale: u_irms *</em> 3 / epsilon*)</p></li>
<li><p><strong>u_L</strong> (<em>1d array: characteristic velocity, characteristic velocity</em>)</p></li>
<li><p><strong>tau_L</strong> (<em>1d array: large eddy turnover time, L_le / u_L</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_integral_scales_iso_spec">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_integral_scales_iso_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_integral_scales_iso_spec" title="Permalink to this definition"></a></dt>
<dd><p>Integral scale defined through energy spectrum.
… Assumes isotropy and a full 1D energy spectrum. Pope 6.260.
… To have a meaningful result, the energy spectrum must be fully resolved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>e_k</strong> (<em>numpy array</em>) – output of get_energy_spectrum()</p></li>
<li><p><strong>k</strong> (<em>numpy array</em>) – output of get_energy_spectrum()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>L_iso_spec</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_integral_scales_using_rij">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_integral_scales_using_rij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_integral_scales_using_rij" title="Permalink to this definition"></a></dt>
<dd><p>[DEPRICATED- computing the autocorrelation tensor could be time-consuming]
Use autocorrelation tensor, Rij to calculate integral length scale</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>Rij</strong> (<em>numpy array</em>) – two-point velocity autocorrelation tensor
… can be obtained by get_two_point_vel_corr_iso(…) but may take a long time</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em>) – The higher n is, the integrand function becomes more smooth</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>L11</strong> (<em>nd array</em>) – … longitudinal integral length scale</p></li>
<li><p><strong>L22</strong> (<em>nd array</em>) – … transverse integral length scale</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_integral_velocity_scale">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_integral_velocity_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_integral_velocity_scale" title="Permalink to this definition"></a></dt>
<dd><p>Return integral velocity scale- identical to u’ (characteristic velocity)
.. See get_characteristic_velocity() for more details</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>numpy array</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>u_irms</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>See get_characteristic_velocity()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_intersecting_vertices">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_intersecting_vertices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_intersecting_vertices" title="Permalink to this definition"></a></dt>
<dd><p>Returns the vertices of intercetion between a plane and a cuboidal volume
… the plane is defined by the equation ax + by + cz = a*x0+ b*y0 + c*z0 = d
…… Note that the normal of the plane is parallel to (a, b, c)
… the cuboidal volume is defined by (xxx, yyy, zzz)
:param xxx:
:type xxx: 3d array, x coordinates of the cuboidal volume
:param yyy:
:type yyy: 3d array, y coordinates of the cuboidal volume
:param zzz:
:type zzz: 3d array, z coordinates of the cuboidal volume
:param a:
:type a: float, x-coefficient of the plane
:param b:
:type b: float, y-coefficient of the plane
:param c:
:type c: float, z-coefficient of the plane
:param x0:
:type x0: float, x-coordinate of the point on the plane
:param y0:
:type y0: float, y-coordinate of the point on the plane
:param z0:
:type z0: float, z-coordinate of the point on the plane</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>verts</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(n, 3) array, coordinates of the vertices of intersection</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_jacobian_xyz_ijk">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_jacobian_xyz_ijk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_jacobian_xyz_ijk" title="Permalink to this definition"></a></dt>
<dd><p>Returns diagonal elements of Jacobian between index space basis and physical space
… This returns xyz_orientations for get_duidxj_tensor().
… Further details can be found in the docstring of get_duidxj_tensor()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>a grid of x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>a grid of y-coordinates</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>a grid of z-coordinates</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>jacobian</strong> – … expected input of xyz_orientations for get_duidxj_tensor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_kgrids">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_kgrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_kgrids" title="Permalink to this definition"></a></dt>
<dd><p>Returns 2d/3d wavenumber grids of an array which is FFT-ed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_kolmogorov_scale">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_kolmogorov_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_kolmogorov_scale" title="Permalink to this definition"></a></dt>
<dd><p>Returns kolmogorov LENGTH scale
… estimates dissipation rate from the rate-of-strain tensor
… eta = (nu ** 3 / epsilon) ** 0.25</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em><em>, </em><em>a velocity field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em>) – data spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – data spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>optional</em>) – data spacing in z</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eta</strong> – kolmogorov length scale</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_kolmogorov_scales_all">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_kolmogorov_scales_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_kolmogorov_scales_all" title="Permalink to this definition"></a></dt>
<dd><p>Returns Kolmogorov scales (Length, Velocity, Time) based on udata and dissipation rate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em>) – data spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – data spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – data spacing in z</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eta</strong> (<em>1d array</em>)</p></li>
<li><p><strong>u_eta</strong> (<em>1d array</em>)</p></li>
<li><p><strong>tau_eta</strong> (<em>1d array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_kurtosis">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_kurtosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_kurtosis" title="Permalink to this definition"></a></dt>
<dd><p>Computes kurtosis of a given velocity field
… DO NOT USE scipy.stats.kurtosis()- which computes skewness in the language of probability
… i.e. probabilistic skewness is defined through its probabilistic moments (X-E[X])^n
… In turbulence, kurotsis is defined using the DERIVATIVES of turbulent velocity
… In turbulence, kurtosis is approximately 7.2 according to Kambe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a velocity field</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kurtosis</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_large_scale_vel_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_large_scale_vel_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_large_scale_vel_field" title="Permalink to this definition"></a></dt>
<dd><p>Returns a velocity field which satisfies k = sqrt(kx^2 + ky^2) &lt; kmax in the original  field (udata)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>components</strong> (<em>...</em><em> velocity field data with shape</em><em> (</em><em># of</em>) – </p></li>
<li><p><strong>depth</strong><strong>)</strong> (<em>physical dimensions</em><em> (</em><em>width x height x</em>) – </p></li>
<li><p><strong>duration</strong><strong>)</strong> – </p></li>
<li><p><strong>kmax</strong> (<em>float</em>) – </p></li>
<li><p><strong>filter</strong> (<em>...</em><em> value of k below which spectrum is kept. i.e. cutoff k for the low-pass</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>y0</strong> (<em>...</em><em> index used to specify a region of a  field in which spectrum is computed.</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>y0</strong> (<em>int</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>y1</strong> (<em>int</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>z0</strong> (<em>int</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>z1</strong> (<em>int</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>window</strong> (<em>2d/3d nd array</em>) – </p></li>
<li><p><strong>FFT</strong> (<em>...</em><em> window used to make input data periodic to surpress spectral leakage in</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em>) – </p></li>
<li><p><strong>k</strong> (<em>...</em><em> z spacing. used to compute</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em>) – </p></li>
<li><p><strong>k</strong> – </p></li>
<li><p><strong>dz</strong> (<em>float</em>) – </p></li>
<li><p><strong>k</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata_ifft</strong> (<em>nd array</em>)</p></li>
<li><p><em>… low-pass filtered velocity field data</em></p></li>
<li><p><strong>coords</strong> (<em>nd array</em>)</p></li>
<li><p><em>… if dim == 2, returns np.asarray([xgrid, ygrid])</em></p></li>
<li><p><em>… if dim == 3, returns np.asarray([xgrid, ygrid, zgrid])</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_mask_for_nan_and_inf">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_mask_for_nan_and_inf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_mask_for_nan_and_inf" title="Permalink to this definition"></a></dt>
<dd><p>Returns a mask for nan and inf values in a multidimensional array U</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>U</strong> (<em>nd array</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mask</strong> – … True if an element is nan or inf, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_mask_for_unphysical">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_mask_for_unphysical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoffU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">99999.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_mask_for_unphysical" title="Permalink to this definition"></a></dt>
<dd><p>Returns a mask (N-dim boolean array). If elements were below/above a cutoff, np.nan, or np.inf, then they get masked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>U</strong> (<em>array-like</em><em>, </em><em>a velocity field</em><em> (</em><em>udata</em><em>)</em>) – </p></li>
<li><p><strong>cutoffU</strong> (<em>float</em>) – if <a href="#id35"><span class="problematic" id="id36">|value|</span></a> &gt; cutoff, this function considers such values unphysical.</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default=99999.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mask</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd boolean array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_mean_flow_field_using_udatapath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_mean_flow_field_using_udatapath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_zeros</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_mean_flow_field_using_udatapath" title="Permalink to this definition"></a></dt>
<dd><p>Returns mean_field when a path to udata is provided
… recommended to use if udata is large (&gt; half of your memory size)
… only a snapshot of data exists on memory while time-averaging is performed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em>) – … path to udata</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>slicez</strong> (<em>int</em><em>, </em><em>default: None</em>) – … Option to return a 2D time-averaged field at z=slicez from 4D udata
… This is mostly for the sake of fast turnout of analysis</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … time increment to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>default: np.inf</em>) – … energy &gt; thd will be replaced by fill_value. (Manual screening of data)</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default: np.nan</em>) – … value used to fill the data when data value is greater than a threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata_m</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d or 3d arrya</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_phase_average">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_phase_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_masked_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_phase_average" title="Permalink to this definition"></a></dt>
<dd><p>Returns phase average of a ND array (generalization of get_average_data_from_periodic_data)
… Assume x is a periodic data, and you are interested in averaging data by locking the phase.</p>
<blockquote>
<div><p>This function returns time (a cycle), phase-averaged data, std of the data</p>
</div></blockquote>
<dl>
<dt>… Two methods to do this</dt><dd><p>1. This is easy IF data is evenly spaced in time
… average [x[0], x[period], x[period*2], …],</p>
<blockquote>
<div><p>then average [x[1], x[1+period], x[1+period*2], …], …</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><dl class="simple">
<dt>Provide a time array as well as data.</dt><dd><dl class="simple">
<dt>… For example, one can give unevenly spaced data (ND array) in time</dt><dd><p>one can take phase average by taking a histogram appropriately</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
</dd>
<dt>… Required arguments for each method:</dt><dd><ol class="arabic simple">
<li><p>x, period_ind</p></li>
<li><p>x, time, freq</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ND array</em><em>, </em><em>data</em>) – … one of the array shape must must match len(time) if time is given</p></li>
<li><p><strong>period_ind</strong> (<em>int</em>) – … period in the unit of index</p></li>
<li><p><strong>time</strong> (<em>1d array</em><em>, </em><em>default: None</em>) – … time of data</p></li>
<li><p><strong>freq</strong> (<em>float</em>) – … frequency of the periodicity of the data</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – … number of points to probe data in the period</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>default:-1</em>) – … axis number to specify the temporal axis of the data</p></li>
<li><p><strong>return_std</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … If False, it returns the standard error instead of standard deviation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t_p</strong> (<em>time (a single cycle)</em>) – … For the method 1, it returns np.arange(nbins)</p></li>
<li><p><strong>x_pavg</strong> (<em>phase-averaged data (N-1)D array</em>)</p></li>
<li><p><strong>x_perr</strong> (<em>std of the data by phase averaging (N-1)D array or standard error</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_phase_averaged_udata_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_phase_averaged_udata_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_masked_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_phase_averaged_udata_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns the phase-averaged udata (velocity field) without loading the entire udata from dpath</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path to the udata</em><em> (</em><em>h5</em><em>)</em>) – … the h5 file must contain ux and uy at /ux and /uy, respectively</p></li>
<li><p><strong>freq</strong> (<em>float</em><em>, </em><em>frequency of the peridocity in data</em>) – </p></li>
<li><p><strong>time</strong> (<em>1D array</em><em>, </em><em>time</em>) – … time unit must be the same as the inverse of the unit of ‘freq’</p></li>
<li><p><strong>deltaT</strong> (<em>float</em><em>, </em><em>default: None</em>) – … time window of a phase used for averaging
… data in [T, T+deltaT), [2T, 2(T+deltaT)], [3T, 3(T+deltaT)], … will be considered to be at the same phase</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tp</strong> (<em>1D array, time of phase-averaged data</em>) – … tp = [0, period]
… phase = tp * freq</p></li>
<li><p><strong>udata_pavg</strong> (<em>2D array, phase-averaged udata</em>) – … This is a phase-dependent mean flow.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_pressure">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_pressure" title="Permalink to this definition"></a></dt>
<dd><p>Returns pressure from a 3D+1 udata
… This is a poisson solver of an incompressible NS equation using FFT
… The solvalbility condition is F(p(x))|(kx=0, ky=0, kz=0) = pk(kx=0, ky=0, kz=0) = 0
…… The zeroth term of the Fourier decomposition of the pressure field is zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>4d/5d array</em><em>, </em><em>v-field data with shape</em><em> (</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>) or </em><em>(</em><em>3</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>, </em><em>t</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>positional grid about x</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>positional grid about y</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>positional grid about z</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>viscosity</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pressure, 4d array with shape (h, w, d, t)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_radial_enstrophy_dist_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_radial_enstrophy_dist_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'median_filter':</span> <span class="pre">False,</span> <span class="pre">'method':</span> <span class="pre">'nn',</span> <span class="pre">'u_cutoff':</span> <span class="pre">inf}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_radial_enstrophy_dist_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns the radial enstrophy profile (i.e. angular average)
… This function loads udata frame by frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>path</em><em> (</em><em>h5</em><em>) </em><em>to udata</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>it uses every &quot;inc&quot; frames to compute the radial profile</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>uses tqdm_notebook instead of tqdm to display progress</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>x-coordinate of the origin of the polar/spherical coordinate system</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>y-coordinate of the origin of the polar/spherical coordinate system</em>) – </p></li>
<li><p><strong>zc</strong> (<em>float</em><em>, </em><em>z-coordinate of the origin of the polar/spherical coordinate system</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of bins in the radial profile</em>) – </p></li>
<li><p><strong>clean</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it cleans udata before computing the enstrophy</em>) – </p></li>
<li><p><strong>clean_kwargs</strong> (dict, kwargs for clean_udata(udata, <a href="#id5"><span class="problematic" id="id6">**</span></a>clean_kwargs)) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r</strong> (<em>1d array, radial coordinate</em>)</p></li>
<li><p><strong>enstrophy_vs_r</strong> (<em>2d array, average enstrophy at distance r with shape (# of bins about r, duration)</em>)</p></li>
<li><p><strong>enstrophy_vs_r_err</strong> (<em>2d array, standard error for enstrophy_vs_r</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_radial_profile">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_radial_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_radial_profile" title="Permalink to this definition"></a></dt>
<dd><p>See get_spatial_profile for documentation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_rescaled_dissipation_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_rescaled_dissipation_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0034</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_rescaled_dissipation_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Return rescaled dissipation spectra
D(k)/(u_eta^3) vs k * eta
… convention: k =  2pi/ L</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>D_k_norm</strong> (<em>nd array</em>) – Scaled dissipation spectrum values with shape (# of data points, duration)</p></li>
<li><p><strong>D_k_err_norm</strong> (<em>nd array</em>) – Scaled dissipation spectrum error with shape (# of data points, duration)</p></li>
<li><p><strong>k_norm</strong> (<em>nd array</em>) – Scaled wavenumber with shape (# of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_rescaled_energy_spectra_jhtd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_rescaled_energy_spectra_jhtd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_rescaled_energy_spectra_jhtd" title="Permalink to this definition"></a></dt>
<dd><p>Returns values to plot rescaled energy spectrum from JHTD, computed by Takumi in 2019
Call get_energy_spectra_jhtd for dimensionful energy spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>datadict</strong> – data stored in jhtd_e_specs.h5 is stored: Scaled k, Scaled ek</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_rescaled_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_rescaled_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0034</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nkout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_signal_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_rescaled_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Returns SCALED energy spectrum E(k), its error, and wavenumber.</dt><dd><ul class="simple">
<li><p>E(k) is sometimes called the 3D energy spectrum since it involves 3D FT of a velocity field.</p></li>
<li><p>ALWAYS greater than E11(k) and E22(k) which involve 1D FT of the velocity field along a specific direction.</p></li>
<li><p>Returns wavenumber with shape (# of data points, duration) instead of (# of data points, ).</p></li>
</ul>
<p>… This seems redundant; however, values in the wavenumber array at a given time may fluctuate in principle
due to a method how it computes the histogram (spectrum.) It should never fluctuate with the current method but
is subject to a change by altering the method of determining the histogram. Therefore, this method outputs
the wavenumber array with shape (# of data points, duration).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>nd array</em><em> or </em><em>float</em><em>, </em><em>default: None</em>) – dissipation rate used for scaling energy spectrum
If not given, it uses the values estimated using the rate-of-strain tensor</p></li>
<li><p><strong>nu</strong> (<em>flaot</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>t1</strong> (<em>int</em>) – index to specify a portion of data in which autocorrelation funciton is computed. Use data u[y0:y1, x0:x1, t0:t1].</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – spacing in z</p></li>
<li><p><strong>nkout</strong> (<em>int</em><em>, </em><em>default: None</em>) – number of bins to compute energy/dissipation spectrum</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Use tqdm.tqdm_notebook if True. Use tqdm.tqdm otherwise</p></li>
<li><p><strong>window</strong> (<em>str</em>) – <p>Windowing reduces undesirable effects due to the discreteness of the data.
A wideband window such as ‘flattop’ is recommended for turbulent energy spectra.</p>
<p>For the type of available window function, choose from below:
boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs decay scale),
tukey (needs taper fraction)</p>
</p></li>
<li><p><strong>correct_signal_loss</strong> (<em>bool</em>) – If True, it would compensate for the loss of the signals due to windowing.
Always recommended to obtain accurate spectral densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>e_k_norm</strong> (<em>numpy array</em>) – Scaled energy spectrum with shape (number of data points, duration)</p></li>
<li><p><strong>e_k_err_norm</strong> (<em>numpy array</em>) – Scaled energy spectrum with shape (number of data points, duration)</p></li>
<li><p><strong>k_norm</strong> (<em>numpy array</em>) – Scaled energy spectrum with shape (number of data points, duration)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_rescaled_energy_spectrum_saddoughi">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_rescaled_energy_spectrum_saddoughi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_rescaled_energy_spectrum_saddoughi" title="Permalink to this definition"></a></dt>
<dd><p>Returns values to plot rescaled energy spectrum from Saddoughi (1992)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>e</strong> (<em>numpy array</em>) – spectral energy density: energy stored between [k, k+dk)</p></li>
<li><p><strong>k</strong> (<em>numpy array</em>) – wavenumber</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_rescaled_structure_function_saddoughi">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_rescaled_structure_function_saddoughi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_rescaled_structure_function_saddoughi" title="Permalink to this definition"></a></dt>
<dd><p>Returns the values of rescaled structure function reported in Saddoughi and Veeravalli 1994 paper: r_scaled, dll
… this is a curve about a specific Reynolds number! i.e. there is no universal structure function</p>
<p>p: int
… order of the structure function</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>r_scaled</strong> (<em>nd array, distance with respect to Kolmogorov length scale</em>)</p></li>
<li><p><strong>dll</strong> (<em>nd array, rescaled structure function</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_running_avg_1d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_running_avg_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_running_avg_1d" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the running average of a 1D array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>t</strong> (<em>float</em><em>, </em><em>number of time steps to average over</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it uses tqdm_notebook instead of tqdm to show a progress bar</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, running average of x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_running_avg_nd">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_running_avg_nd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_running_avg_nd" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the running average of a nD array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a vector field</em>) – </p></li>
<li><p><strong>t</strong> (<em>float</em><em>, </em><em>number of time steps to average over</em>) – </p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>axis along which to average</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it uses tqdm_notebook instead of tqdm to show a progress bar</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vdata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, running average of udata along the specified axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_sample_turb_field_3d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_sample_turb_field_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_sample_turb_field_3d" title="Permalink to this definition"></a></dt>
<dd><p>Returns udata=(ux, uy, uz) of a slice of isotropic, homogeneous turbulence data (DNS, JHTD)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>return_coord</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … If True, it returns a positional grid (xxx, yyy, zzz)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – velocity field</p></li>
<li><p><strong>xx</strong> (<em>numpy array</em>) – x-coordinate of 3D grid</p></li>
<li><p><strong>yy</strong> (<em>numpy array</em>) – y-coordinate of 3D grid</p></li>
<li><p><strong>zz</strong> (<em>numpy array</em>) – z-coordinate of 3D grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_scalar_data_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_scalar_data_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pressure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_scalar_data_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns a scalar data from a path of udata
… There could be a case that a scalar data such as temperature and pressure is also stored in udata.h5
… This function serves as a reader of such a quantity
If return_xy is True, it returns udata, xx(2d grid), yy(2d grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>a path to udata</em>) – </p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>name of the dataset in the udata h5</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>inc</strong> (<em>int</em>) – time increment of data to load from udatapath, default: 1</p></li>
<li><p><strong>frame</strong> (<em>array-like</em><em> or </em><em>int</em><em>, </em><em>default: None</em>) – <p>If an integer is given, it returns a velocity field at that instant of time
If an array or a list is given, it returns a velocity field at the given time specified by the array/list.</p>
<p>By default, it loads data by a specified increment “inc”.
If “frame” is given, it is prioritized over the incremental loading.</p>
</p></li>
<li><p><strong>return_xy</strong> (<em>bool</em><em>, </em><em>defualt: False</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, return the time it took to load udata to memory</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pdata</strong> (<em>ndarray, scalar data with shape (y, x, (z), t)</em>)</p></li>
<li><p><strong>xx, yy, zz(if 3D)</strong> (<em>ndarray, 2/3d positional grid with shape (y, x, (z))</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_skewness">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_skewness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_skewness" title="Permalink to this definition"></a></dt>
<dd><p>Computes skewness of a given velocity field
… DO NOT USE scipy.stats.skew()- which computes skewness in the language of probability
… i.e. probabilistic skewness is defined through its probabilistic moments (X-E[X])^n
… In turbulence, skewnesss is defined using the DERIVATIVES of turbulent velocity
… In turbulence, skewness is approximately -0.4 according according to Kambe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a velocity field</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index to specify the region of interest in udata; udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>(</em><em>z0:z1</em><em>)</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>skewness</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_spatial_avg_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_spatial_avg_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use3comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_spatial_avg_energy" title="Permalink to this definition"></a></dt>
<dd><p>Returns energy averaged over a spatial region</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>start index along x- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>end index along x</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>start index along y</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>end index along y</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>start index along z</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>end index along z</em>) – </p></li>
<li><p><strong>use3comp</strong> (<em>bool</em><em>, </em><em>If udata is 3D v-field</em><em>, </em><em>this function returns 3D energy if True</em><em>, </em><em>2D energy</em><em> (</em><em>ux^2 + uy^2</em><em>)</em><em>/2 if False</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>energy_vs_t</strong> (<em>nd array, spatially averaged energy</em>)</p></li>
<li><p><strong>… shape</strong> (<em>(duration, )</em>)</p></li>
<li><p><em>… this array can be plotted against time</em></p></li>
<li><p><strong>energy_vs_t_err</strong> (<em>nd array, standard error of spatially averaged energy</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_spatial_avg_energy_inside_r_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_spatial_avg_energy_inside_r_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_spatial_avg_energy_inside_r_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns energy averaged inside a circle with radius r at (xc, yc)
.. ONLY AVAILABLE TO 2D v-field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>a path to the udata</em>) – </p></li>
<li><p><strong>r</strong> (<em>float</em><em>, </em><em>radius</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>x-coordinate of the circle</em><em> (</em><em>in real space</em><em>)</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>y-coordinate of the circle</em><em> (</em><em>in real space</em><em>)</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it uses tqdm_notebook instead of tqdm</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>esavg_in</strong> (<em>1d array, energy averaged over space inside the circle</em>)</p></li>
<li><p><strong>esavg_out</strong> (<em>1d array, energy averaged over space outside the circle</em>)</p></li>
<li><p><strong>esavg_in_err</strong> (<em>1d array, standard error for esavg_in</em>)</p></li>
<li><p><strong>esavg_out_err</strong> (<em>1d array, standard error for esavg_out</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_spatial_avg_enstrophy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_spatial_avg_enstrophy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_spatial_avg_enstrophy" title="Permalink to this definition"></a></dt>
<dd><p>Returns spatially averaged enstrophy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>v-field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>x-spacing</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>y-spacing</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>z-spacing</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>an index used to load udata from dpath- udata</em><em>[</em><em>:</em><em>, </em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>:</em><em>]</em>) – </p></li>
<li><p><strong>xx</strong> (<em>2/3d array</em><em>, </em><em>x-coordinates- this is alternative to passing</em><em> (</em><em>dx</em><em>, </em><em>dy</em><em>, </em><em>dz</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2/3d array</em><em>, </em><em>y-coordinates- this is alternative to passing</em><em> (</em><em>dx</em><em>, </em><em>dy</em><em>, </em><em>dz</em><em>)</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>z-coordinates- this is alternative to passing</em><em> (</em><em>dx</em><em>, </em><em>dy</em><em>, </em><em>dz</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>enstrophy_vs_t</strong> (<em>1d array, spatially averaged enstrophy</em>)</p></li>
<li><p><strong>enstrophy_vs_t_err</strong> (<em>1d array, standard error for enstrophy_vs_t</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_spatial_profile">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_spatial_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_spatial_profile" title="Permalink to this definition"></a></dt>
<dd><p>Returns a spatial profile (radial distribution) of 3D object with shape (height, width, duration)
… Computes a histogram of a given quantity as a function of distance from the center (xc, yc)
… If (xc, yc) are not given, it uses the center of the mass of the quantity at the first frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2/3d array</em><em>, </em><em>x-coordinates of the qty</em><em>, </em><em>shape</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2/3d array</em><em>, </em><em>y-coordinates of the qty shape</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>qty</strong> (<em>3/4D numpy array</em>) – </p></li>
<li><p><strong>energy</strong> (<em>...</em>) – </p></li>
<li><p><strong>enstrophy</strong> – </p></li>
<li><p><strong>(</strong><strong>height</strong> (<em>etc. with shape</em>) – </p></li>
<li><p><strong>width</strong> – </p></li>
<li><p><strong>(</strong><strong>depth</strong><strong>)</strong> – </p></li>
<li><p><strong>duration</strong><strong>)</strong> – </p></li>
<li><p><strong>xc</strong> (<em>float</em>) – </p></li>
<li><p><strong>coordinate</strong> (<em>...</em><em> y-coordinate of the origin of the polar</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em>) – </p></li>
<li><p><strong>coordinate</strong> – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>xx</strong><strong>[</strong><strong>y0</strong> (<em>...</em><em> used to specify a portion of data for computing the histogram</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: None</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>default: None</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em>) – </p></li>
<li><p><strong>histograms</strong> (<em>...</em><em> number of bins for the computed</em>) – </p></li>
<li><p><strong>return_center</strong> (<em>bool</em><em>, </em><em>default: False</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2/3d array</em><em>, </em><em>z-coordinates of the qty</em><em>, </em><em>shape</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>zc</strong> (<em>float</em>) – </p></li>
<li><p><strong>coordinate</strong> – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>xx</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>xx</strong><strong>[</strong><strong>y0</strong> – </p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default: None</em><em>, </em><em>method to clean the &quot;qty&quot; array if it contains nan values</em>) – … ‘nn’ - nearest neighbor interpolation (recommended)
… ‘linear’ - linear interpolation
… ‘cubic’ - cubic interpolation</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>default: np.inf</em>) – … <a href="#id37"><span class="problematic" id="id38">|qty|</span></a> &lt; cutoff will be ignored from the statistics</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>it will use tqdm_notebook instead of tqdm to display a progress bar</em>) – </p></li>
<li><p><strong>showtqdm</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>it will display a progress bar</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rs</strong> (<em>2d numpy array</em>)</p></li>
<li><p><em>… radial distance with shape (n, duration)</em></p></li>
<li><p><strong>qty_ms</strong> (<em>2d numpy array</em>)</p></li>
<li><p><em>… mean values of the quantity between r and r+dr with shape (n, duration)</em></p></li>
<li><p><strong>qty_errs</strong> (<em>2d numpy array</em>)</p></li>
<li><p><em>… std of the quantity between r and r+dr with shape (n, duration)- not standard error</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_speed">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_speed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_speed" title="Permalink to this definition"></a></dt>
<dd><p>Returns the speed of the v-field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>v-field data</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>speed</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(n-1)d array, speed of the v-field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_streamfunction_about_a_lifting_cylinder">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_streamfunction_about_a_lifting_cylinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.7853981633974483</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_streamfunction_about_a_lifting_cylinder" title="Permalink to this definition"></a></dt>
<dd><p>Returns a stream function about a lifting cylinder</p>
<p>Source: <a class="reference external" href="http://www-mdp.eng.cam.ac.uk/web/library/enginfo/aerothermal_dvd_only/aero/fprops/poten/node38.html">http://www-mdp.eng.cam.ac.uk/web/library/enginfo/aerothermal_dvd_only/aero/fprops/poten/node38.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y-coordinates</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>x-coordinate of cylinder</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>y-coordinate of cylinder</em>) – </p></li>
<li><p><strong>u</strong> (<em>float</em><em>, </em><em>default: 1</em><em>, </em><em>magnitude of the stream velocity</em>) – </p></li>
<li><p><strong>a</strong> (<em>radius of cylinder</em>) – </p></li>
<li><p><strong>beta</strong> (<em>angle of the stream</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, streamfunction values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_streamfunction_about_a_rankine_vortex">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_streamfunction_about_a_rankine_vortex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_streamfunction_about_a_rankine_vortex" title="Permalink to this definition"></a></dt>
<dd><p>Returns a streamfunction about a rankine vortex.
Source: <a class="reference external" href="http://www-mdp.eng.cam.ac.uk/web/library/enginfo/aerothermal_dvd_only/aero/fprops/poten/node38.html">http://www-mdp.eng.cam.ac.uk/web/library/enginfo/aerothermal_dvd_only/aero/fprops/poten/node38.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y-coordinates</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>x-coordinate of vortex</em>) – </p></li>
<li><p><strong>y0</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>y-coordinate of vortex</em>) – </p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>default: 1</em><em>, </em><em>circulation of vortex</em>) – </p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>default: 1</em><em>, </em><em>radius of vortex</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, streamfunction values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_streamfunction_hill_spherical_vortex">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_streamfunction_hill_spherical_vortex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lab'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cylindrical_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_streamfunction_hill_spherical_vortex" title="Permalink to this definition"></a></dt>
<dd><p>Returns ax streamfunction values for a Hill’s spherical vortex in a lab frame</p>
<p>Source: <a class="reference external" href="https://link.springer.com/chapter/10.1007/978-3-319-55164-7_34">https://link.springer.com/chapter/10.1007/978-3-319-55164-7_34</a> (by Emmanuel Branlard, p.413)</p>
<p>Hill’s spherical vortex is an axisymmetric flow.
… Radial distance to the extremum of streamfunction inside the bubble is a/sqrt(2)=0.707a.
… In the ‘lab’ frame, psi=0 defines the vortex atmosphere.
…… The streamfunction has an extremeum at rho=a/sqrt(2)=0.707a.
…… The vorticity center (rho weighted by omega(rho, z, theta)) is at rho=0.75a.
…… The velocity at the center is -1.5u hat{z}.
… In the ‘vortex’ frame, the vortex is at rest.
…… The velocity at the center is 0.
… In the ‘wind’ or ‘absolute’ frame, the environment is at rest. velocity outside the vortex decays to zero at infinity.
…… The velocity at the center is -2.5u hat{z}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>positional grid</em><em> (</em><em>x</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>positional grid</em><em> (</em><em>y</em><em>)</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>default: 0</em>) – … center of the spherical vortex is at (x0, y0)</p></li>
<li><p><strong>y0</strong> (<em>float</em><em>, </em><em>default: 0</em>) – … center of the spherical vortex is at (x0, y0)</p></li>
<li><p><strong>u</strong> (<em>float</em>) – … stream velocity
… The center of the vortex moves at (-1.5u, 0)
… gamma = 5 * a * u # circulaton of gamma</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>default: None</em>) – … if given, u will be overwritten</p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>&gt;0</em>) – … radius of the spherical vortex</p></li>
<li><p><strong>reference_frame</strong> (<em>str</em><em>, </em><em>default- 'lab'</em>) – … Choose reference_frame from [lab, wind, vortex]
… “lab” refers to the rest frame
… “vortex” refers to the frame of reference of the vortex
… “wind”/”absolute” refers to a frame of reference such that the -2.5u.</p></li>
<li><p><strong>return_cylindrical_coords</strong> (<em>bool</em><em>, </em><em>default- False</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, streamfunction</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>import velocity as vel
import graph
n = 101
L = 200
a=50
x, y = np.linspace(-L/2, L/2, n), np.linspace(0, L/2, n)
XX, YY = np.meshgrid(x, y)
dx, dy = vel.get_grid_spacing(XX, YY)</p>
<dl class="simple">
<dt>psi, zz, rrho = vel.get_streamfunction_hill_spherical_vortex(XX, YY, x0=0, y0=0, gamma=1, a=50,</dt><dd><p>return_cylindrical_coords=True, reference_frame=’lab’)</p>
</dd>
</dl>
<p>wdata = vel.psi2udata_cylindrical(psi, zz=zz, rrho=rrho, return_cartesian=False)
omega = vel.curl(wdata, xx=XX, yy=YY)[…, 0]</p>
<p>fig, ax, Q = graph.quiver(XX, YY, wdata[0, …], wdata[1, …], color=’darkgreen’, zorder=100, inc=5)
graph.contour(XX, YY, psi, levels=[-1.5, -1, -0.5, 0], colors=’k’, linewidths=1)
graph.color_plot(XX, YY, omega, ax=ax, cmap=’bwr’)
# graph.color_plot(XX, YY, psi, ax=ax, cmap=’bwr’)
graph.scatter([0], [a/np.sqrt(2)], ax=ax) # psi has an extremum at a/sqrt(2)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_streamfunction_poisson_solver">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_streamfunction_poisson_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_streamfunction_poisson_solver" title="Permalink to this definition"></a></dt>
<dd><p>Computes the streamfunction by solving a poisson equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>ndarray</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>omega</strong> (<em>ndarray</em><em>, </em><em>vorticity field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y</em>) – </p></li>
<li><p><strong>xx</strong> (<em>ndarray</em><em>, </em><em>x grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>ndarray</em><em>, </em><em>y grid</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>print progress</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>psi</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_streamfunction_thin_cored_vring">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_streamfunction_thin_cored_vring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lab'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cylindrical_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_streamfunction_thin_cored_vring" title="Permalink to this definition"></a></dt>
<dd><p>Returns a streamfunction of a thin-cored vortex ring in cylindrical coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>positional grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>positional grid</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>x-coordinate of the origin of the cylindrical coordinate</em>) – </p></li>
<li><p><strong>y0</strong> (<em>float</em><em>, </em><em>x-coordinate of the origin of the cylindrical coordinate</em>) – </p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>circulation of a vortex ring</em>) – </p></li>
<li><p><strong>R</strong> (<em>float</em><em>, </em><em>radius of a vortex ring</em>) – </p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>cora radius of a vortex ring</em>) – </p></li>
<li><p><strong>reference_frame</strong> (<em>str</em><em>, </em><em>default- 'lab'</em>) – … Choose reference_frame from [lab, wind, vortex]
… “lab” refers to the rest frame
… “vortex” refers to the frame of reference of the vortex</p></li>
<li><p><strong>uc</strong> (<em>float</em><em>, </em><em>self-induced velocity of a vortex ring</em><em>, </em><em>default: None</em>) – … If a&lt;&lt;r, uc = -gamma / (4 * np.pi * R) * (np.log(8 * R / a) - 0.25)
… For reference_frame==’vortex’, it assumes that the induced velocity is</p></li>
<li><p><strong>return_cylindrical_coords</strong> (<em>bool</em><em>, </em><em>default- False</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default- True</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default- True</em><em>, </em><em>whether to use tqdm_notebook instead of tqdm</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>psi</strong> (<em>2d array, streamfunction(zz, rrho)</em>)</p></li>
<li><p><strong>zz, rrho</strong> (<em>2d arrays, cylindrical coordinates, optional</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_streamfunction_vloop">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_streamfunction_vloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lab'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cylindrical_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_streamfunction_vloop" title="Permalink to this definition"></a></dt>
<dd><p>Returns a streamfunction of a vortex loop in cylindrical coordinates
… A loop consists of a vortex filament. i.e. the vorticity is concentrated on a point (zero cross-section)
… This makes the streamfunction on the filament to diverge.
… Similarly, the energy density diverges like rho*gamma^2*R*log(R/epsilon) as it approaches to the filament by epsilon.</p>
<p>y(input) =&gt; rho in the cylindrical axis (distance from the symmetry axis)
^
|
|
————————–&gt; x(input) = z-axis in the cylindrical coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>positional grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>positional grid</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>x-coordinate of the origin of the cylindrical coordinate</em>) – </p></li>
<li><p><strong>y0</strong> (<em>float</em><em>, </em><em>x-coordinate of the origin of the cylindrical coordinate</em>) – </p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>circulation of a vortex loop</em>) – </p></li>
<li><p><strong>R</strong> (<em>float</em><em>, </em><em>radius of a vortex loop</em>) – </p></li>
<li><p><strong>reference_frame</strong> (<em>str</em><em>, </em><em>default- 'lab'</em>) – … Choose reference_frame from [lab, wind, vortex]
… “lab” refers to the rest frame
… “vortex” refers to the frame of reference of the vortex</p></li>
<li><p><strong>return_cylindrical_coords</strong> (<em>bool</em><em>, </em><em>default- False</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>psi</strong> (<em>2d array, streamfunction(rrho, zz)</em>)</p></li>
<li><p><strong>rrho</strong> (<em>2d array</em>)</p></li>
<li><p><strong>zz</strong> (<em>2d array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_structure_function">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_structure_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'long'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_structure_function" title="Permalink to this definition"></a></dt>
<dd><p>Compute the structure function of the velocity field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>ndarray</em><em>, </em><em>2/3D velocity field</em>) – </p></li>
<li><p><strong>x</strong> (<em>ndarray</em><em>, </em><em>x-coordinates of the velocity field</em>) – </p></li>
<li><p><strong>y</strong> (<em>ndarray</em><em>, </em><em>y-coordinates of the velocity field</em>) – </p></li>
<li><p><strong>z</strong> (<em>ndarray</em><em>, </em><em>z-coordinates of the velocity field</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>kinematic viscosity</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index used to specify a temporal region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index used to specify a temporal region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>p</strong> (<em>int</em><em>, </em><em>order of the structure function</em>) – </p></li>
<li><p><strong>nr</strong> (<em>int</em><em>, </em><em>number of points</em><em> (</em><em>distances</em><em>) </em><em>at which the structure function is evaluated</em>) – </p></li>
<li><p><strong>nd</strong> (<em>int</em><em>, </em><em>number of pairs considered to compute the structure function value at a given distance</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>'long'</em><em> or </em><em>'trans'</em>) – … Specify whether longitudinal or transverse correlations is evaluated</p></li>
<li><p><strong>time_thd</strong> (<em>float</em><em>, </em><em>threshold for the computation time</em><em> (</em><em>in sec</em><em>) </em><em>to determine a correlation value at a given distance r</em>) – … default: 10. sec</p></li>
<li><p><strong>spacing</strong> (<em>str</em><em>, </em><em>'log'</em><em> or </em><em>'linear'</em>) – … Specify whether the considered distance r is evenly spaced logarithmically or linearly</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it will use tqdm_notebook instead of tqdm to display a progress bar</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rrs</strong> (<em>2d array, distances at which the structure function is evaluated, shape: (nr, duration)</em>)</p></li>
<li><p><strong>Dijks</strong> (<em>2d array, structure function values at the distances rrs, shape: (nr, duration)</em>)</p></li>
<li><p><strong>Dijk_errs</strong> (<em>2d array, standard errors of the structure function values at the distances rrs, shape: (nr, duration)</em>)</p></li>
<li><p><strong>rrs_scaled</strong> (<em>2d array, rrs / eta, eta: Kolmogorov length scale estimated from the rate-of-strain tensor</em>)</p></li>
<li><p><strong>Dijks_scaled</strong> (<em>2d array, Dijks / (epsilon * rrs *</em> (p/3)), epsilon: Kolmogorov length scale estimated from the rate-of-strain tensor*)</p></li>
<li><p><strong>Dijk_errs_scaled</strong> (<em>2d array, Dijk_errs / (epsilon * rrs *</em> (p/3)), epsilon: Kolmogorov length scale estimated from the rate-of-strain tensor*)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_structure_function_long">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_structure_function_long</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ux'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_structure_function_long" title="Permalink to this definition"></a></dt>
<dd><p>DEPRECATED! Use get_structure_function()</p>
<p>Structure tensor Dij is essentially the covariance of the two-point velocity difference
There is one-to-one correspondence between Dij and Rij. (Pope 6.36)
This method returns the LONGITUDINAL STRUCTURE FUNCTION.
If p=2, this returns D_LL.
… Returns rrs, Dxxs, Dxx_errs, rrs_scaled, Dxxs_scaled, Dxx_errs_scaled
:param udata:
:param x: x-coordinate of the spatial grid corresponding to the given udata</p>
<blockquote>
<div><p>… it does not have to ve equally spaced</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>numpy array</em>) – y-coordinate of the spatial grid corresponding to the given udata
… it does not have to ve equally spaced</p></li>
<li><p><strong>z</strong> (<em>numpy array</em>) – z-coordinate of the spatial grid corresponding to the given udata
… it does not have to ve equally spaced</p></li>
<li><p><strong>p</strong> (<em>float</em><em> or </em><em>int</em>) – order of structure function</p></li>
<li><p><strong>roll_axis</strong> (<em>int</em>) – “u” and “roll_axis” determines whether this method returns the longitudinal or transverse structure function
If you want longitudinal, match “u” and “roll_axis”. e.g.- u=’ux’ and roll_axis=1, u=’uy’ and roll_axis=0
If you want transverse, do not match “u” and “roll_axis”. e.g.- u=’ux’ and roll_axis=0, u=’uy’ and roll_axis=1</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=None</em>) – number of bins used to take a histogram of velocity difference</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscosity</p></li>
<li><p><strong>u</strong> (<em>str</em><em>, </em><em>default='ux'</em>) – velocity component used to compute the structure functions. Choices are ‘ux’, ‘uy’, ‘uz’</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Specified the region of udata to compute the structure function.
This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: None</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>default</strong> (<em>None</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>int</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>default</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>int</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>default</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>coarse</strong> (<em>float</em><em>, </em><em>(</em><em>0</em><em>, </em><em>1</em><em>]</em><em>, </em><em>default: 1</em>) – the first parameter to save computation time related sampling frequency
… The higher “coarse” is, it samples more possible data points.
… If “coarse” == 1, it samples all possible data points.
… If “coarse” == 0.5, it samples only a half of possible data points. Could overestimate Taylor microscale.</p></li>
<li><p><strong>coarse2</strong> (<em>float</em><em>, </em><em>(</em><em>0</em><em>, </em><em>1</em><em>]</em><em>, </em><em>default: 0.2</em>) – the second parameter to save computation time related to making a histogram
… Determines how many sampled data points to be used to make a histogram
… If “coarse” == 1, it uses all data points to make a histogram.
… If “coarse” == 0.5, it uses only a half of data points to make a histogram</p></li>
<li><p><strong>notebook</strong> (<em>bool</em>) – … if True, it uses tqdm.tqdm_notebook instead of tqdm.tqdm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rrs</strong> (<em>numpy array</em>) – two-point separation distance for the structure function</p></li>
<li><p><strong>Dxxs</strong> (<em>numpy array</em>) – values of the structure function</p></li>
<li><p><strong>Dxx_errs</strong> (<em>numpy array</em>) – error of the structure function</p></li>
<li><p><strong>rrs_scaled</strong> (<em>numpy array</em>) – two-point separation distance for the SCALED structure function</p></li>
<li><p><strong>Dxxs_scaled</strong> (<em>numpy array</em>) – values of the SCALED structure function</p></li>
<li><p><strong>Dxx_errs_scaled</strong> (<em>numpy array</em>) – error of the SCALED structure function</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_structure_function_roll">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_structure_function_roll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('x',</span> <span class="pre">'x')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_structure_function_roll" title="Permalink to this definition"></a></dt>
<dd><p>DEPRECATED! Use get_structure_function()
A method to compute a generalized structure function</p>
<p>Structure tensor Dij…k is essentially the generalized variance of the two-point velocity difference
This method returns the STRUCTURE FUNCTION D_{ij…k}(r x_m) where the tensor indices are “indices”
and the subscript of x_m, m, is expressed as roll_axis.</p>
<p>If indices=(0, 0) &amp; roll_axis=1, this returns D_{xx}(r hat{x}).  # longitudinal, 2nd order
If indices=(1, 1) &amp; roll_axis=0, this returns D_{yy}(r hat{y}).  # longitudinal, 2nd order
If indices=(1, 1) &amp; roll_axis=0, this returns D_{yy}(r hat{x}).  # transverse, 2nd order
If indices=(0, 0, 0) &amp; roll_axis=1, this returns D_{xxx}(r hat{x}).  # longitudinal, 3nd order
If indices=(0, 1, 0) &amp; roll_axis=1, this returns D_{xyx}(r hat{x}).  # (1, 2, 1)-component of the 3rd order structure function tensor</p>
<p>… Returns rrs, Dijks, Dijk_errs, rrs_scaled, Dijks_scaled, Dijk_errs_scaled</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>x</strong> (<em>numpy array</em>) – x-coordinate of the spatial grid corresponding to the given udata
… it does not have to ve equally spaced</p></li>
<li><p><strong>y</strong> (<em>numpy array</em>) – y-coordinate of the spatial grid corresponding to the given udata
… it does not have to ve equally spaced</p></li>
<li><p><strong>z</strong> (<em>numpy array</em>) – z-coordinate of the spatial grid corresponding to the given udata
… it does not have to ve equally spaced</p></li>
<li><p><strong>indices</strong> (<em>array-like</em><em>, </em><em>default:</em><em> (</em><em>1</em><em>, </em><em>1</em><em>)</em>) – … tensor indices of the structure function tensor: D_{i,j,…, k}
… indices=(1,1) corresponds to D_{xx}.
… For a 3D spatial field, x, y, z corresponds to 1, 0, 2 respectively. Recall udata.shape = (height, width, depth, duration)
… For a 2D spatial field, x, y corresponds to 1, 0 respectively. Recall udata.shape = (height, width, duration)</p></li>
<li><p><strong>roll_axis</strong> (<em>int</em>) – “u” and “roll_axis” determines whether this method returns the longitudinal or transverse structure function
If you want longitudinal, match “u” and “roll_axis”. e.g.- u=’ux’ and roll_axis=1, u=’uy’ and roll_axis=0
If you want transverse, do not match “u” and “roll_axis”. e.g.- u=’ux’ and roll_axis=0, u=’uy’ and roll_axis=1</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=None</em>) – number of bins used to take a histogram of velocity difference</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscosity</p></li>
<li><p><strong>u</strong> (<em>str</em><em>, </em><em>default='ux'</em>) – velocity component used to compute the structure functions. Choices are ‘ux’, ‘uy’, ‘uz’</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Specified the region of udata to compute the structure function.
This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: None</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>default</strong> (<em>None</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>int</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>default</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>int</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>default</strong> – This method uses only udata[y0:y1, x0:x1, z0:z1, t0:t1].</p></li>
<li><p><strong>coarse</strong> (<em>float</em><em>, </em><em>(</em><em>0</em><em>, </em><em>1</em><em>]</em><em>, </em><em>default: 1</em>) – the first parameter to save computation time related to sampling frequency
… The higher “coarse” is, it samples more possible data points.
… If “coarse” == 1, it samples all possible data points.
… If “coarse” == 0.5, it samples only a half of possible data points.</p></li>
<li><p><strong>coarse2</strong> (<em>float</em><em>, </em><em>(</em><em>0</em><em>, </em><em>1</em><em>]</em><em>, </em><em>default: 0.2</em>) – the second parameter to save computation time related to making a histogram
… Determines how many sampled data points to be used to make a histogram
… If “coarse” == 1, it uses all data points to make a histogram.
… If “coarse” == 0.5, it uses only a half of data points to make a histogram</p></li>
<li><p><strong>notebook</strong> (<em>bool</em>) – … if True, it uses tqdm.tqdm_notebook instead of tqdm.tqdm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rrs</strong> (<em>numpy array</em>) – two-point separation distance for the structure function</p></li>
<li><p><strong>Dxxs</strong> (<em>numpy array</em>) – values of the structure function</p></li>
<li><p><strong>Dxx_errs</strong> (<em>numpy array</em>) – error of the structure function</p></li>
<li><p><strong>rrs_scaled</strong> (<em>numpy array</em>) – two-point separation distance for the SCALED structure function</p></li>
<li><p><strong>Dxxs_scaled</strong> (<em>numpy array</em>) – values of the SCALED structure function</p></li>
<li><p><strong>Dxx_errs_scaled</strong> (<em>numpy array</em>) – error of the SCALED structure function</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_suggested_inds">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_suggested_inds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_suggested_inds" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of the recommended indices of the udata stored in udatapath
… e.g.</p>
<blockquote>
<div><p>inds = read_suggested_inds(udatapath)
udata = read_udata_from_path(udatapath, <a href="#id7"><span class="problematic" id="id8">**</span></a>inds)
… This will load udata[y0:y1, x0:x1, z0:z1, :] onto the memory
… The motivation behind this is that STB sometimes results a lot of empty data especially when no particles can be tracked in the region.</p>
<blockquote>
<div><p>… This is often the case due to the limited depth of the field that the STB may resolve.
… suggest_udata_dim2load(udatapath) computes the statistics, and suggests the indices one should use so that one avoids loading
the empty data which could bias the data and cause problems for many analyses such as a Fourier analysis.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>a path to the h5 file where udata is stored</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inds</strong> – … inds = {“x0”: x0, “x1”: x1, “y0”: y0, “y1”: y1, “z0”: z0, “z1”: z1}
… udata[y0:y1, x0:x1, z0:z1, :]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict, the suggested indices of the udata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_taylor_microscales">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_taylor_microscales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.015</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_taylor_microscales" title="Permalink to this definition"></a></dt>
<dd><p>Returns Taylor microscales as the curvature of the autocorrelation functions at r=0
… Algorithm:
…     (1) Polynomial fit (cubic) the long./trans. autocorr functions
…     (2) Evaluate its second derivate at r=0.
…     (3) Relate that value to the taylor microscale
… Feed the results from get_two_point_vel_corr_iso().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_long</strong> (<em>numpy 2d array with shape</em><em> (</em><em>no. of elements</em><em>, </em><em>duration</em><em>)</em>) – … r for longitudinal autoorrelation values</p></li>
<li><p><strong>f_long</strong> (<em>numpy 2d array with shape</em><em> (</em><em>no. of elements</em><em>, </em><em>duration</em><em>)</em>) – … longitudinal autoorrelation values</p></li>
<li><p><strong>r_tran</strong> (<em>numpy 2d array with shape</em><em> (</em><em>no. of elements</em><em>, </em><em>duration</em><em>)</em>) – … r for longitudinal autoorrelation values</p></li>
<li><p><strong>g_tran</strong> (<em>numpy 2d array with shape</em><em> (</em><em>no. of elements</em><em>, </em><em>duration</em><em>)</em>) – … longitudinal autoorrelation values</p></li>
<li><p><strong>residual_thd</strong> (<em>float</em>) – … threshold for the residuals of the polynomial fit</p></li>
<li><p><strong>deg</strong> (<em>int</em><em>, </em><em>default 2</em><em>, </em><em>degree of the polynomial fit</em>) – </p></li>
<li><p><strong>return_err</strong> – </p></li>
<li><p><strong>bool</strong> – </p></li>
<li><p><strong>False</strong> (<em>default</em>) – </p></li>
<li><p><strong>fit</strong> (<em>whether to return the error of the polynomial</em>) – </p></li>
<li><p><strong>npt_min</strong> (<em>int</em><em>, </em><em>default 4</em><em>, </em><em>minimum number of points for the polynomial fit to compute Taylor's microscale</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lambda_f</strong> (<em>numpy 2d array with shape (duration, )</em>) – … Longitudinal Taylor microscale</p></li>
<li><p><strong>lambda_g</strong> (<em>numpy 2d array with shape (duration, )</em>) – … Transverse Taylor microscale</p></li>
<li><p><strong>lambda_err_f</strong> (<em>numpy 2d array with shape (duration, ), optional</em>)</p></li>
<li><p><strong>lambda_err_g</strong> (<em>numpy 2d array with shape (duration, ), optional</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_taylor_microscales_all">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_taylor_microscales_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_taylor_microscales_all" title="Permalink to this definition"></a></dt>
<dd><p>Returns Taylor microscales (Length, Velocity, Time) based on autocorrelation functions
… More time-consuming than get_taylor_microscales_all_iso() but more basic
…… the time-consuming part is the estimation of the autocorrelation functions: r_long, f_long, r_tran, g_tran</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – velocity field array</p></li>
<li><p><strong>r_long</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>f_long</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>r_tran</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>g_tran</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lambda_f</strong> (<em>1d array</em>) – Taylor microscale (length)</p></li>
<li><p><strong>u_lambda</strong> (<em>1d array</em>) – Taylor microscale (velocity)</p></li>
<li><p><strong>tau_lambda</strong> (<em>1d array</em>) – Taylor microscale (time)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_taylor_microscales_all_iso">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_taylor_microscales_all_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_taylor_microscales_all_iso" title="Permalink to this definition"></a></dt>
<dd><p>Returns Taylor microscales using isotropic formula based on udata and dissipation rate
… Quick but only applicable to isotropic turbulence
… a dissipation rate must be accurately estimated to have a meaningful result</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – velocity field array</p></li>
<li><p><strong>epsilon</strong> (<em>numpy array</em>) – disspation rate</p></li>
<li><p><strong>nu</strong> (<em>numpy array</em>) – viscosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lambda_f_iso</strong> (<em>1d array</em>) – Taylor microscale (length)</p></li>
<li><p><strong>u_lambda_iso</strong> (<em>1d array</em>) – Taylor microscale (velocity)</p></li>
<li><p><strong>tau_lambda_iso</strong> (<em>1d array</em>) – Taylor microscale (time)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_taylor_microscales_iso">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_taylor_microscales_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_taylor_microscales_iso" title="Permalink to this definition"></a></dt>
<dd><p>Return Taylor microscales computed by isotropic formulae: lambda_g_iso = (15 nu * u_irms^2 / epsilon) ^ 0.5</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em> or </em><em>array with the same length as udata</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscoty</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lambda_f_iso</strong> (<em>numpy array</em>) – longitudinal Taylor microscale</p></li>
<li><p><strong>lambda_g_iso</strong> (<em>numpy array</em>) – transverse Taylor microscale</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_taylor_re">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_taylor_re</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_tran</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_taylor_re" title="Permalink to this definition"></a></dt>
<dd><p>Returns Taylor reynolds number (Pope 6.63) from autocorrelation functions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – velocity field array</p></li>
<li><p><strong>r_long</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>f_long</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>r_tran</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>g_tran</strong> (<em>numpy array</em>) – … output of get_two_point_vel_corr_iso(…)</p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>default: 1.004</em><em> (</em><em>water</em><em>, </em><em>in mm^2/s</em><em>)</em>) – viscosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Re_lambda</strong> – Taylor Reynolds number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_taylor_re_iso">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_taylor_re_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_taylor_re_iso" title="Permalink to this definition"></a></dt>
<dd><p>Returns Taylor reynolds number (Pope 6.63) using isotropic formula</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – velocity field array</p></li>
<li><p><strong>epsilon</strong> (<em>numpy array</em>) – disspation rate</p></li>
<li><p><strong>nu</strong> (<em>numpy array</em>) – viscosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Re_lambda_iso</strong> – Taylor Reynolds number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_avg_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_avg_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_avg_energy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a time-averaged energy field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>time-averaged energy field</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>energy_avg</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_avg_energy_from_udatapath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_avg_energy_from_udatapath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udata_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_avg_energy_from_udatapath" title="Permalink to this definition"></a></dt>
<dd><p>Returns time-averaged energy when a path to udata is provided
… recommended to use if udata is large (&gt; half of your memory size)
… only a snapshot of data exists on memory while time-averaging is performed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em>) – … path to udata</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>slicez</strong> (<em>int</em><em>, </em><em>default: None</em>) – … Option to return a 2D time-averaged field at z=slicez from 4D udata
… This is mostly for the sake of fast turnout of analysis</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … time increment to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>default: np.inf</em>) – … energy &gt; thd will be replaced by fill_value. (Manual screening of data)</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default: np.nan</em>) – … value used to fill the data when data value is greater than a threshold</p></li>
<li><p><strong>udata_mean</strong> (<em>array</em><em>, </em><em>default: None</em>) – … It subtracts the given array from the udata. This feature can be used to compute the mean fluctuating energy.</p></li>
<li><p><strong>clean</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it runs clean_udata</em><em>(</em><em>) </em><em>before computing energy</em>) – … it is often recommmended to pass an additional kwarg ‘showtqdm=False’ for concise output.
… if method=’idw’, this process could take time so ‘showtqdm=True’ makes sense to monitor this cleaning process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eavg</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, time-averaged energy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_avg_enstrophy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_avg_enstrophy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_avg_enstrophy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a time-averaged enstrophy field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>spacing along x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>spacing along y</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>spacing along z</em><em> (</em><em>optional</em><em>, </em><em>applicable to 3D data</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>nd array</em><em>, </em><em>x coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>nd array</em><em>, </em><em>y coordinates</em>) – </p></li>
<li><p><strong>zz</strong> (<em>nd array</em><em>, </em><em>z coordinates</em><em> (</em><em>optional</em><em>, </em><em>applicable to 3D data</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>enstrophy_avg</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, time-averaged enstrophy field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_avg_enstrophy_from_udatapath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_avg_enstrophy_from_udatapath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udata_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_avg_enstrophy_from_udatapath" title="Permalink to this definition"></a></dt>
<dd><p>Returns time-averaged energy from a path to udata
… recommended to use if udata is large (&gt; half of your memory size)
… only a snapshot of data exists on memory while time-averaging is performed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em>) – … path to udata</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>slicez</strong> (<em>int</em><em>, </em><em>default: None</em>) – … Option to return a 2D time-averaged field at z=slicez from 4D udata
… This is mostly for the sake of fast turnout of analysis</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … time increment to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>default: np.inf</em>) – … energy &gt; thd will be replaced by fill_value. (Manual screening of data)</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default: np.nan</em>) – … value used to fill the data when data value is greater than a threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>enstavg</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray, time-averaged enstrophy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_avg_field_from_udatapath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_avg_field_from_udatapath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_avg_field_from_udatapath" title="Permalink to this definition"></a></dt>
<dd><p>Returns time-averaged velocity field when a path to udata is provided
… recommended to use if udata is large (&gt; half of your memory size)
… only a snapshot of data exists on memory while time-averaging is performed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em>) – … path to udata</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>slicez</strong> (<em>int</em><em>, </em><em>default: None</em>) – … Option to return a 2D time-averaged field at z=slicez from 4D udata
… This is mostly for the sake of fast turnout of analysis</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … time increment to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>default: np.inf</em>) – … energy &gt; thd will be replaced by fill_value. (Manual screening of data)</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>default: np.nan</em>) – … value used to fill the data when data value is greater than a threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>u_m</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray, mean velocity field with shape (dim, height, width, (depth))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns real time that corresponds to udata
… time = np.arange(t0, t1, inc) / fps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>a path where a velocity field is stored</em>) – </p></li>
<li><p><strong>fps</strong> (<em>float</em><em>, </em><em>frame rate in FPS</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>increment</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>starting frame number</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>ending frame number</em>) – </p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it adds the created 1d array at /t</em>) – </p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>if True AND save is True</em><em>, </em><em>it saves the created 1d array at /t even if the data already exists there.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>realtimes</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, time (in sec)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_time_indices_for_selfsimilar_movie">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_time_indices_for_selfsimilar_movie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_time_indices_for_selfsimilar_movie" title="Permalink to this definition"></a></dt>
<dd><p>Returns indices of a time array required to make a self-similar movie</p>
<p>… Let t_i be the time at frame i.
To preserve the displacement between two frames when energy decays in a power law (E ~ (t-t0)^n),
t_i must satisfy the following recurrence relation.</p>
<p>t_{i+2} = {2t_{i+1}^m - 2t_{i}^m }^{1/m}</p>
<p>where m = n/2 + 1.</p>
<p>… This function returns indices for the given array “time”. To do so, one needs t0, t1, and n.
… t1 = t0 + dt
… exponent is “n”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>1d array</em>) – … time. this does not have to be evenly spaced.
… e.g. [0.0, 0.005, 0.010, 0.020, …]</p></li>
<li><p><strong>t0</strong> (<em>float/int</em>) – … the first</p></li>
<li><p><strong>dt</strong> (<em>float/int</em>) – … t1 = t0 + dt. If not clear, read about the recurrence relation above</p></li>
<li><p><strong>exponent</strong> (<em>exponent of energy decay</em><em>, </em><em>default=-1</em>) – … Some best estimate on this is around -1.2 for the initial period of decay.</p></li>
<li><p><strong>nmax</strong> (<em>int</em><em>, </em><em>default=None</em>) – … number of elements of the output array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>t_indices</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, indices of a time array required to make a self-similar movie</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_turbulence_intensity_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_turbulence_intensity_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writeData</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_turbulence_intensity_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Computes the turbulence intensity of udata in a given path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>a path</em><em> (</em><em>h5</em><em>) </em><em>to the udata</em>) – </p></li>
<li><p><strong>writeData</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it writes the turbulence intensity to the h5 file</em>) – </p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it overwrites the turbulence intensity if it already exists</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it uses tqdm_notebook instead of tadm to display the progress</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ti</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, turbulence intensity with shape (height, width, (optional: depth))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_turbulence_intensity_local">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_turbulence_intensity_local</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_turbulence_intensity_local" title="Permalink to this definition"></a></dt>
<dd><p>Turbulence intensity is defined as u/U where
u = sqrt((ux**2 + uy**2 + uz**2)/3) # characteristic turbulent velocity
U = sqrt((Ux**2 + Uy**2 + Uz**2))   # norm of the rms velocity</p>
<p>Note that this is ill-defined for turbulence with zero-mean flow !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a velocity field</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ti_local</strong> – … a field of a turbulent intensity (a scaler field)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_turbulence_re">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_turbulence_re</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_turbulence_re" title="Permalink to this definition"></a></dt>
<dd><p>Returns turbulence reynolds number (Pope 6.59)
… Integral Reynolds number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>numpy array</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em>) – data spacing in x</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – data spacing in y</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – data spacing in z</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Re_L</strong> – Turbulence Reynolds number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_two_point_vel_corr">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_two_point_vel_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_two_point_vel_corr" title="Permalink to this definition"></a></dt>
<dd><p>Returns the normalized two-point velocity tatistics (rrs, fs, f_errs, rrs, gs, g_errs)</p>
<p>… f(r): longitudinal two-pt  stat
… g(r): transverse two-pt  stat
… In order for f(r) and g(r) to have a meaning, the flow MUST be isotropic
… Algorithm:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Choose two points A and B. Let r be the displacement vector (x_A - x_B)</p></li>
<li><p>Create a right-handed orthogonal basis (hat{r}, n) or (hat{r}, n1, n2)</p></li>
<li><p>f(r) = &lt; (u(A) cdot r) u(B) cdot r)&gt; /   &lt; <a href="#id9"><span class="problematic" id="id10">|</span></a>u(A) cdot r|^2&gt;
g(r) = &lt; (u(A) cdot n) u(B) cdot n)&gt; /   &lt; <a href="#id11"><span class="problematic" id="id12">|</span></a>u(A) cdot r|^2&gt;</p></li>
</ol>
</div></blockquote>
<p>… The v-field must be isotropic for this result to make sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>a velocity field</em>) – </p></li>
<li><p><strong>x</strong> (<em>2/3d array</em><em>, </em><em>x-coordinates of the velocity field</em>) – </p></li>
<li><p><strong>y</strong> (<em>2/3d array</em><em>, </em><em>y-coordinates of the velocity field</em>) – </p></li>
<li><p><strong>z</strong> (<em>2/3d array</em><em>, </em><em>z-coordinates of the velocity field</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index used to specify a temporal region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index used to specify a temporal region in which the statistics is computed udata</em><em>[</em><em>:</em><em>, </em><em>x0:x1</em><em>, </em><em>y0:y1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>nd</strong> (<em>int</em><em>, </em><em>number of bins in the histogram- the bin width is roughly rmax/nd</em>) – </p></li>
<li><p><strong>nr</strong> (<em>int</em><em>, </em><em>number of pairs of points used to compute the two-point correlation function at a particular distance r</em>) – </p></li>
<li><p><strong>rmax</strong> (<em>float</em><em>, </em><em>maximum distance to compute the two-point correlation function</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>tqdm_notebook is used instead of tqdm</em>) – </p></li>
<li><p><strong>periodic</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>the velocity field is assumed to be periodic</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>autocorrs</strong> (<em>tuple</em>)</p></li>
<li><p><em>… autocorrs = (rrs, fs, f_errs, rrs, gs, g_errs)</em></p></li>
<li><p><strong>… rrs</strong> (<em>2d array, radial distances with shape (nd, duration)</em>)</p></li>
<li><p><strong>… fs</strong> (<em>2d array, longitudinal velocity correlation funciton (nd, duration)</em>)</p></li>
<li><p><strong>… f_errs</strong> (<em>2d array, longitudinal velocity correlation funciton error (nd, duration)</em>)</p></li>
<li><p><strong>… rrs</strong> (<em>2d array, radial distances with shape (nd, duration)</em>)</p></li>
<li><p><em>…… same as the first return value (this is returned for consistency)</em></p></li>
<li><p><strong>… gs</strong> (<em>2d array, transverse velocity correlation funcitonwith shape (nd, duration)</em>)</p></li>
<li><p><strong>… g_errs</strong> (<em>2d array, transverse velocity correlation funciton error with shape (nd, duration)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_two_point_vel_corr_iso">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_two_point_vel_corr_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rij</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_two_point_vel_corr_iso" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns two-point velocity autocorrelation tensor, and autocorrelation functions.
Uses the x-component of velocity. (CAUTION required for unisotropic flows)
… Pope Eq. 6.44</p>
<dl class="simple">
<dt>udata: 5D or 4D numpy array, 5D if the no. of spatial dimensions is 3. 4D if the no. of spatial dimensions is 2.</dt><dd><p>… (ux, uy, uz) or (ux, uy)
… ui has a shape (height, width, depth, duration) or (height, width, depth) (3D)
… ui may have a shape (height, width, duration) or (height, width) (2D)</p>
</dd>
</dl>
<p>x: 2d/3d grid, x coordinate of a field
y: 2d/3d grid, y coordinate of a field
z: 2d/3d grid, y coordinate of a field
roll_axis: int, direction of a displacement vector between two points</p>
<blockquote>
<div><p>… 0: y, 1: x, 2:z</p>
</div></blockquote>
<p>n_bins: int, nuber of bins used to compute the two-point statistics
x0: int, index used to specify a spatial region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
x1: int, index used to specify a spatial region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
y0: int, index used to specify a spatial region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
y1: int, index used to specify a spatial region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
z0: int, index used to specify a spatial region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
z1: int, index used to specify a spatial region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
t0: int, index used to specify a temporal region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
t1: int, index used to specify a temporal region in which the statistics is computed [y0:y1, x0:x1, z0:z1, t0:t1]
coarse: float, (0, 1], default: 1</p>
<blockquote>
<div><p>the first parameter to save computation time related sampling frequency
… The higher “coarse” is, it samples more possible data points.
… If “coarse” == 1, it samples all possible data points.
… If “coarse” == 0.5, it samples only a half of possible data points. Could overestimate Taylor microscale.</p>
</div></blockquote>
<dl class="simple">
<dt>coarse2: float, (0, 1], default: 0.2</dt><dd><p>the second parameter to save computation time related to making a histogram
… Determines how many sampled data points to be used to make a histogram
… If “coarse” == 1, it uses all data points to make a histogram.
… If “coarse” == 0.5, it uses only a half of data points to make a histogram</p>
</dd>
</dl>
<p>notebook: bool, if True, it uses tqdm_notebook instead of tqdm to display a progress bar
return_rij: bool,</p>
<blockquote>
<div><dl class="simple">
<dt>… If True, it returns a funciton (the autocorrealtion tensor Rij with aarguments (i, j, r, t, udata))</dt><dd><p>AND autocorrs = (r_long, f_long, f_err_long, r_tran, g_tran, g_err_tran)</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>autocorrs: tuple, (r_long, f_long, f_err_long, r_tran, g_tran, g_err_tran)</dt><dd><p>… r_long: 2D numpy array, distance for f_long, shape: (nbins, duration)
… f_long: longitudinal autocorrelation values, shape: (nbins, duration)
… f_err_long: longitudinal autocorrelation errors, shape: (nbins, duration)
… r_tran: 2D numpy array, distance for g_tran, shape: (nbins, duration)
… g_tran: transverse autocorrelation values, shape: (nbins, duration)
… g_err_tran: transverse autocorrelation errors, shape: (nbins, duration)</p>
</dd>
<dt>rij: funciton with arguments (r, t, i, j), autocorrelation tensor ,optional</dt><dd><p>… Rij (</p>
</dd>
</dl>
</div></blockquote>
<p>ec{r} , t) = &lt;u_j(
ec{x}) u_j(
ec{x}+
ec{r})&gt; / &lt;u_j(
ec{x})^2&gt;</p>
<blockquote>
<div><dl class="simple">
<dt>… If system is homogeneous and isotropic,</dt><dd><p>Rij (</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>ec{r} , t) = u_rms^2 [g(r,t) delta_ij + {f(r,t) - g(r,t)} r_i * r_j / r^2]</dt><dd><p>where f, and g are long. and transverse autocorrelation functions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_two_point_vel_corr_roll">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_two_point_vel_corr_roll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roll_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_two_point_vel_corr_roll" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Returns a two-point velocity correlation function &lt;ui(x) ui(x+r)&gt; / &lt; <a href="#id13"><span class="problematic" id="id14">|</span></a>ui(x)|^2 &gt;    … Redirects to compute_spatial_autocorr2d OR compute_spatial_autocorr3d!</dt><dd><p>… Spatial autocorrelation function and two-pt vel corr function are the same things.</p>
</dd>
<dt>… This function is primarily used to compute the longitudnal/transverse two-pt vel correlation functions</dt><dd><p>… f(r) =  &lt;u1(x) u1(x+r hat{x_1})&gt; / &lt; <a href="#id15"><span class="problematic" id="id16">|</span></a>u1(x)|^2 &gt;            … ui = udata[0, …], roll_axis=1
… g(r) =  &lt;u1(x) u1(x+r hat{x_2})&gt; / &lt; <a href="#id17"><span class="problematic" id="id18">|</span></a>u1(x)|^2 &gt;            … ui = udata[1, …], roll_axis=1</p>
</dd>
</dl>
<p>… One can deduce Taylor microscale, energy spectrum from f(r) and g(r)
… One can compute Rii with the outputs of this function.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>R11 = f(r) * &lt; ux^2 &gt;</p></li>
<li><p>R22 = g(r) * &lt; uy^2 &gt;
… This g(r) can be obtained by (ui = udata[1, …], roll_axis=1)</p></li>
<li><p>R33 = g(r) * &lt; uy^2 &gt;
… This g(r) can be obtained by (ui = udata[2, …], roll_axis=1)</p></li>
</ol>
<dl>
<dt>… Important quantities to check are one-dimensional spectra Eii.</dt><dd><p>… Eii = 2 x Fourier Transform of(Rii)
… This may not yield the cleanest spectra; however, one should always check</p>
<blockquote>
<div><p>the following equality
… &lt; ux^2 &gt; = int_0^infty E11(kappa1) dkappa1
… &lt; uy^2 &gt; = int_0^infty E22(kappa1) dkappa1
… &lt; uz^2 &gt; = int_0^infty E33(kappa1) dkappa1
i.e. (Turbulent) Energy = 0.5  int_0^infty Eii(kappa1) dkappa1</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ui</strong> (<em>nd array</em><em>, </em><em>ux</em><em>, </em><em>uy</em><em> or </em><em>uz</em>) – </p></li>
<li><p><strong>udata</strong><strong>[</strong><strong>0</strong> (<em>...</em><em> e.g.</em>) – </p></li>
<li><p><strong>ux</strong> (<em>...</em><em>] </em><em>for</em>) – </p></li>
<li><p><strong>x</strong> (<em>2d/3d grid</em><em>, </em><em>x coordinate of a field</em>) – </p></li>
<li><p><strong>y</strong> (<em>2d/3d grid</em><em>, </em><em>y coordinate of a field</em>) – </p></li>
<li><p><strong>z</strong> (<em>2d/3d grid</em><em>, </em><em>y coordinate of a field</em>) – </p></li>
<li><p><strong>roll_axis</strong> (<em>int</em><em>, </em><em>direction of a displacement vector between two points</em>) – … 0: y, 1: x, 2:z</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>nuber of bins used to compute the two-point statistics</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index used to specify a spatial region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index used to specify a temporal region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index used to specify a temporal region in which the statistics is computed</em><em> [</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>coarse</strong> (<em>float</em><em>, </em><em>(</em><em>0</em><em>, </em><em>1</em><em>]</em><em>, </em><em>default: 1</em>) – the first parameter to save computation time related sampling frequency
… The higher “coarse” is, it samples more possible data points.
… If “coarse” == 1, it samples all possible data points.
… If “coarse” == 0.5, it samples only a half of possible data points. Could overestimate Taylor microscale.</p></li>
<li><p><strong>coarse2</strong> (<em>float</em><em>, </em><em>(</em><em>0</em><em>, </em><em>1</em><em>]</em><em>, </em><em>default: 0.2</em>) – the second parameter to save computation time related to making a histogram
… Determines how many sampled data points to be used to make a histogram
… If “coarse” == 1, it uses all data points to make a histogram.
… If “coarse” == 0.5, it uses only a half of data points to make a histogram</p></li>
<li><p><strong>periodic</strong> (<em>bool</em><em>, </em><em>default False</em>) – … turn this on to correctly account for the periodicty of the field</p></li>
<li><p><strong>Lx</strong> (<em>float</em><em>, </em><em>size of the periodic box in the x-direction</em><em> (</em><em>not index</em><em>)</em>) – </p></li>
<li><p><strong>Ly</strong> (<em>float</em><em>, </em><em>size of the periodic box in the y-direction</em><em> (</em><em>not index</em><em>)</em>) – </p></li>
<li><p><strong>Lz</strong> (<em>float</em><em>, </em><em>size of the periodic box in the z-direction</em><em> (</em><em>not index</em><em>)</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it uses tqdm_notebook instead of tqdm</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rr</strong> (<em>2d numpy array, distance (distance, time)</em>)</p></li>
<li><p><strong>corr</strong> (<em>2d numpy array, (two-point correlation values, time)</em>)</p></li>
<li><p><strong>corr_err</strong> (<em>2d numpy array, (std of two-point correlation, time)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_udata" title="Permalink to this definition"></a></dt>
<dd><p>Returns udata from a path to udata
If return_xy is True, it returns udata, xx(2d grid), yy(2d grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>inc</strong> (<em>int</em>) – time increment of data to load from udatapath, default: 1</p></li>
<li><p><strong>frame</strong> (<em>array-like</em><em> or </em><em>int</em><em>, </em><em>default: None</em>) – <p>If an integer is given, it returns a velocity field at that instant of time
If an array or a list is given, it returns a velocity field at the given time specified by the array/list.</p>
<p>By default, it loads data by a specified increment “inc”.
If “frame” is given, it is prioritized over the incremental loading.</p>
</p></li>
<li><p><strong>return_xy</strong> (<em>bool</em><em>, </em><em>defualt: False</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, return the time it took to load udata to memory</p></li>
<li><p><strong>ind</strong> (<em>int</em><em>, </em><em>id for a file with multiple piv data</em><em> (</em><em>udata</em><em>)</em>) – … A file may include ux, uy, x, y under /piv/piv000/, /piv/piv001, /piv/piv001, … when piv is conducted on the same footage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array with shape (dim, height, width, (depth), duration)</em>) – … udata[0, …]: ux, udata[1, …]: uy, udata[2, …]: uz
… udata[0, …, t] is a 2D/3D array which stores the x-component of the velocity field.
… Intuitively speaking, udata is organized like udata[dim, y, x, (z), time]</p></li>
<li><p><em>(optional)</em></p></li>
<li><p><strong>xx</strong> (<em>2d/3d array of a positional grid (x) stored in the given file</em>)</p></li>
<li><p><strong>yy</strong> (<em>2d/3d array of a positional grid (y) stored in the given file</em>)</p></li>
<li><p><strong>zz</strong> (<em>2d/3d array of a positional grid (z) stored in the given file</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_udata_dim">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_udata_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_udata_dim" title="Permalink to this definition"></a></dt>
<dd><p>Returns the array size of ux stored in the given path</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_udata_from_path">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_udata_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_udata_from_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns udata from a path to udata
If return_xy is True, it returns udata, xx(2d grid), yy(2d grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>inc</strong> (<em>int</em>) – time increment of data to load from udatapath, default: 1</p></li>
<li><p><strong>frame</strong> (<em>array-like</em><em> or </em><em>int</em><em>, </em><em>default: None</em>) – <p>If an integer is given, it returns a velocity field at that instant of time
If an array or a list is given, it returns a velocity field at the given time specified by the array/list.</p>
<p>By default, it loads data by a specified increment “inc”.
If “frame” is given, it is prioritized over the incremental loading.</p>
</p></li>
<li><p><strong>return_xy</strong> (<em>bool</em><em>, </em><em>defualt: False</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, return the time it took to load udata to memory</p></li>
<li><p><strong>ind</strong> (<em>int</em><em>, </em><em>id for a file with multiple piv data</em><em> (</em><em>udata</em><em>)</em>) – … A file may include ux, uy, x, y under /piv/piv000/, /piv/piv001, /piv/piv001, … when piv is conducted on the same footage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array with shape (dim, height, width, (depth), duration)</em>) – … udata[0, …]: ux, udata[1, …]: uy, udata[2, …]: uz
… udata[0, …, t] is a 2D/3D array which stores the x-component of the velocity field.
… Intuitively speaking, udata is organized like udata[dim, y, x, (z), time]</p></li>
<li><p><em>(optional)</em></p></li>
<li><p><strong>xx</strong> (<em>2d/3d array of a positional grid (x) stored in the given file</em>)</p></li>
<li><p><strong>yy</strong> (<em>2d/3d array of a positional grid (y) stored in the given file</em>)</p></li>
<li><p><strong>zz</strong> (<em>2d/3d array of a positional grid (z) stored in the given file</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_udata_from_path_nested">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_udata_from_path_nested</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicez</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_udata_from_path_nested" title="Permalink to this definition"></a></dt>
<dd><p>A function to read udata from a hdf5 file
… This function is suited for a nested structure Takumi used temporarily  between 2017-18.</p>
<blockquote>
<div><p>This format stores udata generated by multiple PIV settings
(different Dt, interrogation window size, etc) on the same movie</p>
</div></blockquote>
<dl class="simple">
<dt>… The hdf5 should have a following structure</dt><dd><p>/piv/exp/__quantity_like_piston_velocity_piston_position_etc
/piv/piv000/__quantity_like_ux_uy_x_y_lambda_etc
/piv/piv001/__quantity_like_ux_uy_x_y_lambda_etc
…
/piv/piv010/__quantity_like_ux_uy_x_y_lambda_etc</p>
</dd>
</dl>
<p>… Specify which udata to load via “ind”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> – </p></li>
<li><p><strong>str</strong> – </p></li>
<li><p><strong>ind</strong> (<em>int</em><em>, </em><em>index to specify which piv data to load in a nested h5</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>inc</strong> (<em>int</em>) – </p></li>
<li><p><strong>frame</strong> (<em>int</em>) – </p></li>
<li><p><strong>return_xy</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it retursn a 2D/3D grid which can be used for pcolormesh etc.</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it reports progress</em>) – </p></li>
<li><p><strong>slicez</strong> (<em>int</em><em>, </em><em>default: None</em>) – <dl class="simple">
<dt>… Feature for loading a planar udata from a volumetric udata</dt><dd><p>If given, it returns a (ux, uy, uz) on a plane z=slizez (in index space)</p>
</dd>
</dl>
</p></li>
<li><p><strong>crop</strong> (<em>int</em><em>, </em><em>default: None</em>) – If given, it will make x0=y0=z0=crop, x1=y1=z1=-crop
… This literally “crops” a velocity field in a square/cubic mannar</p></li>
<li><p><strong>reverse_x</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it reverses the order of x</em>) – <dl class="simple">
<dt>… This is sometimes useful if external function requires a monotonically increasing array.</dt><dd><p>e.g. interpolation in scipy/numpy</p>
</dd>
</dl>
</p></li>
<li><p><strong>reverse_y</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it reverses the order of y</em>) – </p></li>
<li><p><strong>reverse_z</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it reverses the order of z</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array, velocity field</em>)</p></li>
<li><p><strong>xx, yy, zz</strong> (<em>2D/3D array, position grid, (if return_xy is True)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_udata_phys_dim">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_udata_phys_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udatapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_udata_phys_dim" title="Permalink to this definition"></a></dt>
<dd><p>Returns the physical dimensions of the velocity field stored in the standard format in the given path
… the h5 file must contain the following datasets:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>ux at /ux</p></li>
<li><p>uy at /uz</p></li>
<li><p>uz at /uy</p></li>
<li><p>x at /x</p></li>
<li><p>y at /y</p></li>
<li><p>z at /z</p></li>
</ul>
</div></blockquote>
<p>width, height, and the depth of the udata in physical dimensions (probably in mm)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>path to the h5 file containing the velocity field</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data (xx[y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data (xx[y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data (xx[y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data (xx[y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data (xx[y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data (xx[y0:y1, x0:x1, z0:z1])</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>w, h, (d- if applicable)</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, physical dimensions of the velocity field (width, height, depth)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_unidirectional_flow">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_unidirectional_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_unidirectional_flow" title="Permalink to this definition"></a></dt>
<dd><p>Returns udata of a unidirectional flow. The forwarding direciton is described by a tangent vector t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y coordinates</em>) – </p></li>
<li><p><strong>t</strong> (<em>1d array with two elements specifying a direction of the flow</em><em> (</em><em>y</em><em>, </em><em>x</em><em>)</em>) – </p></li>
<li><p><strong>U</strong> (<em>float</em><em>, </em><em>velocity magnitude</em>) – </p></li>
<li><p><strong>c</strong> (<em>float</em><em>, </em><em>a parameter relevant for decay=='linear'</em><em> or </em><em>'exponential</em>) – … This parameter determines where the field starts to decrease either linearly or exponentially
… e.g. c = 100, decay==’linear’, t=(0, 1)
…… This makes a field with a constant flow up to xx&lt;c (c and xx must share the units)
…… Then, the field linearly decays to zero at max(xx)</p></li>
<li><p><strong>decay</strong> (<em>str</em><em>, </em><em>options:</em><em> [</em><em>&quot;linear&quot;</em><em>, </em><em>&quot;exponential&quot;</em><em>] </em><em>default: None</em>) – … If given, the field decays to zero at the edge of the field</p></li>
<li><p><strong>decay_scale</strong> (<em>float</em><em>, </em><em>a relevant parameter for an exponentially decaying field</em><em>, </em><em>default: 1.</em>) – … The higher, decay_scale is, the flow decays faster to zero.
… udata = U * np.exp(- decay_scale * dd / np.max(dd))
… If given, the field decays to zero</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>3d numpy array of a unidirectional field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.get_window_radial">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">get_window_radial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hamming'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.get_window_radial" title="Permalink to this definition"></a></dt>
<dd><p>General method to get a window with shape (xx.shape[:], duration) or (xx.shape[:]) if duration is None
… Window types:</p>
<blockquote>
<div><p>boxcar, triang, blackman, hamming, hann, bartlett, flattop, parzen, bohman, blackmanharris, nuttall, barthann,
kaiser (needs beta), gaussian (needs standard deviation), general_gaussian (needs power, width),
slepian (needs width), chebwin (needs attenuation), exponential (needs a decay scale),
tukey (needs taper fraction)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>nd array</em>) – x-coordinate of the spatial grid of udata</p></li>
<li><p><strong>yy</strong> (<em>nd array</em>) – y-coordinate of the spatial grid of udata</p></li>
<li><p><strong>zz</strong> (<em>nd array</em>) – y-coordinate of the spatial grid of udata</p></li>
<li><p><strong>wtype</strong> (<em>str</em>) – name of window function such as ‘hamming’, ‘flattop’</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – window function returns zero for r &gt; rmax</p></li>
<li><p><strong>duration</strong> (<em>int</em><em>, </em><em>default: None</em>) – specifies the temporal dimension of the returning window function.</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – used to specify the region of the returning window function.
When coordinates outside the specified region is given to the window function, it returns 0.</p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: None</em>) – used to specify the region of the returning window function.
When coordinates outside the specified region is given to the window function, it returns 0.</p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>default: None</em>) – used to specify the region of the returning window function.
When coordinates outside the specified region is given to the window function, it returns 0.</p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>default: None</em>) – used to specify the region of the returning window function.
When coordinates outside the specified region is given to the window function, it returns 0.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>default: 500</em>) – number of data points when 1D window function is called for the first time.
The higher n is, the returning windowing function is more accurate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>window/windows</strong> (<em>nd array</em>)</p></li>
<li><p><strong>… window</strong> (<em>hamming window with the shape as xx</em>)</p></li>
<li><p><strong>… window</strong> (<em>hamming window with the shape (xx.shape[:], duration)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.grad">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.grad" title="Permalink to this definition"></a></dt>
<dd><p>Computes divergence of a velocity field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>U</strong> (<em>numpy array</em>) – … U has a shape (height, width, depth, duration) or (height, width, depth) (3D)
… U may have a shape (height, width, duration) or (height, width) (2D)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grad_U</strong> – … grad_U has a shape (3, height, width, depth, duration) (3D) or (2, height, width, duration) (2D)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.griddata_easy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">griddata_easy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.griddata_easy" title="Permalink to this definition"></a></dt>
<dd><p>Conduct 2D interpolation of data from a nonuniformly spaced rectangular grid
… A wrapper of scipy.interplate.griddata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>nd array-like</em>) – x-coordinate of scattered data
this will be flattened when passed to griddata</p></li>
<li><p><strong>yy</strong> (<em>nd array-like</em>) – y-coordinate of scattered data
this will be flattened when passed to griddata</p></li>
<li><p><strong>data</strong> (<em>nd array-like</em>) – values of scattered data
this will be flattened when passed to griddata</p></li>
<li><p><strong>xi</strong> (<em>1d array</em>) – x-coordinate of the interpolated grid
… The array must be monotonically increasing.
… If None, xi = np.arange(xmin, xmax, dx)</p></li>
<li><p><strong>yi</strong> (<em>1d array</em>) – y-coordinate of the interpolated grid
… The array must be monotonically increasing.
… If None, yi = np.arange(ymin, ymax, dy)</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – spacing of ‘xi’ if ‘xi’ is not given</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – spacing of ‘xi’ if ‘xi’ is not given</p></li>
<li><p><strong>nx</strong> (<em>int</em>) – if ‘dx’ were not given, dx is set as (xmax-xmin)/nx</p></li>
<li><p><strong>ny</strong> (<em>int</em>) – if ‘dy’ were not given, dx is set as (ymax-ymin)/ny</p></li>
<li><p><strong>method</strong> (<em>method of 2D interpolation</em>) – … Options: ‘nearest’, ‘linear’, ‘cubic’</p></li>
<li><p><strong>xmin</strong> (<em>float</em><em>, </em><em>minimum x value of the interpolated grid</em>) – </p></li>
<li><p><strong>xmax</strong> (<em>float</em><em>, </em><em>maximum x value of the interpolated grid</em>) – </p></li>
<li><p><strong>ymin</strong> (<em>float</em><em>, </em><em>minimum y value of the interpolated grid</em>) – </p></li>
<li><p><strong>ymax</strong> (<em>float</em><em>, </em><em>maximum y value of the interpolated grid</em>) – </p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em>, </em><em>value to fill in the interpolated grid</em><em>, </em><em>default is None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xxi</strong> (<em>2d array</em>) – x-coordinate of the grid</p></li>
<li><p><strong>yyi</strong> (<em>2d array</em>) – y-coordinate of the grid</p></li>
<li><p><strong>data_i</strong> (<em>2d array</em>) – values on the grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.interpolate_scalar_field_at_instant_of_time">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">interpolate_scalar_field_at_instant_of_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.interpolate_scalar_field_at_instant_of_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns an interpolating function a scalar field (energy, enstrophy etc.) at instant of time
using scipy.interpolate.RegularGridInterpolator
… field_i( (y, x, z) ): the field at (x, y, z)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>ndarray</em><em>, </em><em>scalar field</em><em>, </em><em>shape</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>duration</em><em>)</em>) – … The most right index of “field” is the time index.</p></li>
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>x-grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>y-grid</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>z-grid</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>t</strong> (<em>int</em><em>, </em><em>time index</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>bounds_error</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, when interpolating outside of the input data, raise a ValueError.</p></li>
<li><p><strong>kwargs</strong> (<em>kwargs will be passed to scipy.interpolate.RegularGridInterpolator</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>field_i</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>interpolating function of the scalar field at time t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.interpolate_udata_at_instant_of_time">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">interpolate_udata_at_instant_of_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.interpolate_udata_at_instant_of_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns interpolating functions of each spatial component of a velocity field at instant of time
using scipy.interpolate.RegularGridInterpolator
… Returns a tuple (f_ux, f_uy, f_uz)
… f_ux( (y, x, z) ) gives ux at (x, y, z)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>x-grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>y-grid</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>z-grid</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>t</strong> (<em>int</em><em>, </em><em>default: 0</em>) – This function generates interpolating functions of udata at time index of</p></li>
<li><p><strong>bounds_error</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, when interpolating outside of the input data, raise a ValueError.</p></li>
<li><p><strong>kwargs</strong> (<em>kwargs will be passed to scipy.interpolate.RegularGridInterpolator</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f_ux</strong> (<em>interpolating function of ux at time t</em>)</p></li>
<li><p><strong>f_uy</strong> (<em>interpolating function of uy at time t</em>)</p></li>
<li><p><strong>f_uz</strong> (<em>interpolating function of uz at time t, optional</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.interpolate_vector_field_at_instant_of_time">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">interpolate_vector_field_at_instant_of_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vfield</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.interpolate_vector_field_at_instant_of_time" title="Permalink to this definition"></a></dt>
<dd><p>Returns interpolating functions of a vector field (e.g. vorticity field: omega)
using scipy.interpolate.RegularGridInterpolator
… e.g.</p>
<blockquote>
<div><p>Input: vorticity field (omega) with shape (3, height, width, depth, duration)
Output: a list of interpolating functions for each spatial direction- [omega_x, omega_y, omega_z]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vfield</strong> (<em>ndarray</em><em>, </em><em>vector field</em><em>, </em><em>shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>2d/3d array</em><em>, </em><em>x-grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d/3d array</em><em>, </em><em>y-grid</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d/3d array</em><em>, </em><em>z-grid</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>t</strong> (<em>int</em><em>, </em><em>time index</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>bounds_error</strong> (<em>bool</em><em>, </em><em>default: False</em>) – </p></li>
<li><p><strong>True</strong> (<em>...</em><em> If</em>) – </p></li>
<li><p><strong>data</strong> (<em>when interpolating outside of the input</em>) – </p></li>
<li><p><strong>ValueError.</strong> (<em>raise a</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>kwargs will be passed to scipy.interpolate.RegularGridInterpolator</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>funcs</strong> – … funcs[n] is the interpolating function of the vfield[n, …, t]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, interpolating functions</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.isRingFormed">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">isRingFormed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">160.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">18000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.isRingFormed" title="Permalink to this definition"></a></dt>
<dd><p>Returns if a commanded ring is formed in the turbulent blob experiment
… A ring is formed regardless of commanded stroke length and velocity; however, the piston may not move as commanded
… This function tells if a ring was formed cleanly
… Condition 1: L/D&lt;=4… Ring is accompanied by a jet if L/D&gt;4
… Condition 2: Piston moves with finite acceleration. Effective velocity, veff, is always less than a certain value.
… Condition 3: Oscillatory motion sets the minimum velocity of the piston needs to be.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sl</strong> (<em>float/1d array</em><em>, </em><em>commanded stroke length in mm</em>) – </p></li>
<li><p><strong>sv</strong> (<em>float/1d array</em><em>, </em><em>commanded stroke velocity in mm/s</em>) – </p></li>
<li><p><strong>f</strong> (<em>float/1d array</em><em>, </em><em>driving frequency of the piston</em>) – </p></li>
<li><p><strong>P</strong> (<em>float</em><em>, </em><em>velocity shape factor &lt;v^2&gt;/&lt;v&gt;^2&gt;=1. Experimentally</em><em>, </em><em>this is around 1.2.</em>) – </p></li>
<li><p><strong>do</strong> (<em>float</em><em>, </em><em>diameter of the orifice</em>) – </p></li>
<li><p><strong>dp</strong> (<em>float</em><em>, </em><em>diameter of the piston</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of orifices of the chamber</em>) – </p></li>
<li><p><strong>amax</strong> (<em>float</em><em>, </em><em>maximum acceleration of the piston. Experimentally</em><em>, </em><em>this is 1.8e4 mm/s2. Relevant to Condition2.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>isRingFormed</strong> (<em>bool, True if the ring could be formed at the given driving frequency</em>)</p></li>
<li><p><em>(the formed ring would have the same or similar properties as the rings formed by a corresponding pulse)</em></p></li>
<li><p><em>False if the formed ring would have different properties from the rings formed by a corresponding pulse.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.is_data_derived">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">is_data_derived</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datanames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.is_data_derived" title="Permalink to this definition"></a></dt>
<dd><p>Check whether quantities of your interest is derived
Returns True if the quantities exist in the h5 file, False otherwise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savepath</strong> (<em>str</em><em>, </em><em>path to the h5 file</em>) – </p></li>
<li><p><strong>datanames</strong> (<em>list of str</em><em>, </em><em>names of the quantities of interest</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>whether to print out the names of the quantities that are not found</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>'hard'</em><em> or </em><em>'easy'</em>) – <dl class="simple">
<dt>… if mode==’easy’,</dt><dd><p>it checks whether quantities of derive_easy() are in savepath</p>
</dd>
<dt>… if mode==’hard’,</dt><dd><p>it checks whether quantities of derive_hard() are in savepath</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.kolmogorov_53">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">kolmogorov_53</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.kolmogorov_53" title="Permalink to this definition"></a></dt>
<dd><p>Customizable Kolmogorov Energy spectrum
Returns the value(s) of k0 * k^{-5/3}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>array-like</em><em>, </em><em>wavenumber: convention is k= 1/L NOT 2pi/L</em>) – </p></li>
<li><p><strong>k0</strong> (<em>float</em><em>, </em><em>coefficient</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>e_k</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>power-law spectrum with exponent -5/3 for a given k and k0</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.kolmogorov_53_uni">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">kolmogorov_53_uni</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.kolmogorov_53_uni" title="Permalink to this definition"></a></dt>
<dd><p>Universal Kolmogorov Energy spectrum
Returns the value(s) of C epsilon^{2/3} k^{-5/3}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>array-like</em><em>, </em><em>wavenumber</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>dissipation rate</em>) – </p></li>
<li><p><strong>c</strong> (<em>float</em><em>, </em><em>Kolmogorov constant c=1.6</em><em> (</em><em>default</em><em>)</em>) – </p></li>
<li><p><strong>k^</strong><strong>(</strong><strong>-5/3</strong><strong>)</strong> (<em>...</em><em> E22</em><em>(</em><em>k</em><em>) </em><em>= c2 epsilon^</em><em>(</em><em>2/3</em><em>)</em>) – </p></li>
<li><p><strong>k^</strong><strong>(</strong><strong>-5/3</strong><strong>)</strong> – </p></li>
<li><p><strong>k^</strong><strong>(</strong><strong>-5/3</strong><strong>)</strong> – </p></li>
<li><p><strong>c1</strong> (<em>...</em>) – </p></li>
<li><p><strong>1.6</strong> (<em>...</em><em> If c =</em>) – </p></li>
<li><p><strong>0.491</strong> (<em>c1 =</em>) – </p></li>
<li><p><strong>1.125</strong> (<em>c2 =</em>) – </p></li>
<li><p><strong>values</strong> (<em>...</em><em> Exp.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>e_k</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like, Kolmogorov energy spectrum for a given range of k</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.kronecker_delta">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">kronecker_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.kronecker_delta" title="Permalink to this definition"></a></dt>
<dd><p>kronecker_delta Delta function: delta_{i, j}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>tensor index</em>) – </p></li>
<li><p><strong>j</strong> (<em>tensor index</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1 if i==j, 0 otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.lamb_oseen_vortex_2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">lamb_oseen_vortex_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.lamb_oseen_vortex_2d" title="Permalink to this definition"></a></dt>
<dd><p>Return a 2D velocity field with a single Rankine vortex at (x0, y0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>numpy array</em>) – x-coordinate, 2d grid</p></li>
<li><p><strong>yy</strong> (<em>numpy array</em>) – y-coordinate, 2d grid</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – x-coordinate of the position of the rankine vortex</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – y-coordinate of the position of the rankine vortex</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – circulation of the rankine vortex</p></li>
<li><p><strong>a</strong> (<em>float</em>) – core radius of the rankine vortex</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong> – … udata[0] = ux
… udata[1] = uy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, velocity field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.lamb_oseen_vortex_line_3d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">lamb_oseen_vortex_line_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ux0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uy0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uz0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.lamb_oseen_vortex_line_3d" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns a velocity field (udata with shape (3, nrows, ncols, nstacks) induced by
a Lamb-Oseen voretx line of a diameter a0 and circulation gamma
… Lambd-Oseen vortex core grows as sqrt{a0**2 + 4</p>
</div></blockquote>
<dl>
<dt>u t}</dt><dd><p>… Azimuthal velocity: utheta = gamma / (2 * np.pi * rr) * (1 - np.exp(- rr ** 2 / a ** 2))
… an orientation of a vortex can be specified
… a rectilinear stream can be added along the x-/y-/z-direction</p>
<p>xx: 3d array, x-coordinate
yy: 3d array, y-coordinate
zz: 3d array, y-coordinate
x0: float, x-coordinate of the point where the vortex line penetrates
y0: float, y-coordinate of the point where the vortex line penetrates
z0: float, z-coordinate of the point where the vortex line penetrates
gamma: float, circulation
a0: float, core radius
nu: float, kinematic viscosity
t: float, time,</p>
<blockquote>
<div><p>… Lambd-Oseen vortex core grows as sqrt{a0**2 + 4</p>
</div></blockquote>
</dd>
<dt>u t}</dt><dd><p>ux0: float, a stream velocity, default = 0
uy0: float, a stream velocity, default = 0
uz0: float, a stream velocity, default = 0
axis: int, axis of the symmetry,  default = 2 (z-axis)</p>
<blockquote>
<div><p>… Choose from [0, 1, 2] corresponding to (y, x, z)</p>
</div></blockquote>
<p>udata: 4d array, a velocity field (3, nrows, ncols, nstacks)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.laplacian">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">il</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.laplacian" title="Permalink to this definition"></a></dt>
<dd><p>Returns Laplacian of p, d^2p/dx^2 + d^2/dy^2.
If needed, specify how to grab the image of a point outside
the domain.  Otherwise, the d^2p/dx^2 or d^2/dy^2 term is not included
on the boundary.</p>
<p>Source: <a class="reference external" href="https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933">https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933</a></p>
<dl class="simple">
<dt>e.g. # Compute vorticity from a stream function</dt><dd><p>laplacian(streamfunction, dx, dy)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>2d array</em><em>, </em><em>a scalar field</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y</em>) – </p></li>
<li><p><strong>il</strong> – </p></li>
<li><p><strong>ir</strong> – </p></li>
<li><p><strong>jb</strong> – </p></li>
<li><p><strong>jt</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lapl</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.low_pass_filter">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">low_pass_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.low_pass_filter" title="Permalink to this definition"></a></dt>
<dd><p>Apply low-pass filter to a 1D data (signal)
… the signal must be sampled evenly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>1d array-like</em>) – </p></li>
<li><p><strong>fc</strong> (<em>float</em><em>, </em><em>cutoff frequency</em>) – </p></li>
<li><p><strong>fs</strong> (<em>float</em><em>, </em><em>sampling frequency of data</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filtered</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, low-pass filtered signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.mag">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.mag" title="Permalink to this definition"></a></dt>
<dd><p>Returns a norm of of udata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array with a shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>umag</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array with shape () or (duration, )</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.make_blocks_from_2d_array">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">make_blocks_from_2d_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.make_blocks_from_2d_array" title="Permalink to this definition"></a></dt>
<dd><p>Return an array of shape (n, nrows, ncols) where n * nrows * ncols = arr.size
If arr is a 2D array, the returned array should look like n subblocks with
each subblock preserving the “physical” layout of arr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>M x N list</em><em> or </em><em>numpy array</em>) – </p></li>
<li><p><strong>nrows</strong> (<em>int</em><em>, </em><em>number of rows in each block</em>) – </p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>number of columns in each block</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>blocks</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array with shape (n, nrows, ncols)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.make_movie">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">make_movie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">movname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indexsz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'05'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgColor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgWidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgHeight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_into_subdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_commands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffmpeg_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/takumi/Documents/git/tflow/tflow/ffmpeg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.make_movie" title="Permalink to this definition"></a></dt>
<dd><p>Create a movie from a sequence of images using the ffmpeg supplied with ilpm.
Options allow for deleting folder automatically after making movie.
Will run ‘./ffmpeg’, ‘-framerate’, str(int(framerate)), ‘-i’, imgname + ‘%’ + indexsz + ‘d.png’, movname + ‘.mov’,</p>
<blockquote>
<div><p>‘-vcodec’, ‘libx264’, ‘-profile:v’, ‘main’, ‘-crf’, ‘12’, ‘-threads’, ‘0’, ‘-r’, ‘100’, ‘-pix_fmt’, ‘yuv420p’])</p>
</div></blockquote>
<dl class="simple">
<dt>… ffmpeg is not smart enough to recognize a pattern like 0, 50, 100, 150… etc.</dt><dd><p>It tries up to an interval of 4. So 0, 3, 6, 9 would work, but this hinders practicality.
Use the glob feature in that case. i.e. option=’glob’</p>
</dd>
<dt>… As for images with transparent background, ffmpeg outputs a bad quality movie.</dt><dd><p>In that case, provide [bkgColor=’white’, bkgWidth=800, bkgHeight=800]
… bkgWidth and bkgHeight must have the same aspect ratio as the images
… this uses an option -filter_complex which is not compatible with the other filtering option -vf.
… If one would like to use -vf for inverting images for example, one must code it differently</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgname</strong> (<em>str</em>) – … path and filename for the images to turn into a movie
… could be a name of directory where images are stored if option is ‘glob’</p></li>
<li><p><strong>movname</strong> (<em>str</em>) – path and filename for output movie (movie name)</p></li>
<li><p><strong>indexsz</strong> (<em>str</em>) – string specifier for the number of indices at the end of each image (ie ‘file_000.png’ would merit ‘03’)</p></li>
<li><p><strong>framerate</strong> (<em>int</em><em> (</em><em>float may be allowed</em><em>)</em>) – The frame rate at which to write the movie</p></li>
<li><p><strong>crf</strong> (<em>int</em><em>, </em><em>0-51</em>) – … constant rate factor- the lower the value is, the better the quality becomes</p></li>
<li><p><strong>rm_images</strong> (<em>bool</em>) – Remove the images from disk after writing to movie</p></li>
<li><p><strong>save_into_subdir</strong> (<em>bool</em>) – The images are saved into a folder which can be deleted after writing to a movie, if rm_images is True and
imgdir is not None</p></li>
<li><p><strong>option</strong> (<em>str</em>) – If “glob”, it globs all images with the extention in the directory.
Therefore, the images does not have to be numbered.</p></li>
<li><p><strong>add_commands</strong> (<em>list</em>) – A list to add extra commands for ffmpeg. The list will be added before output name
i.e. ffmpeg -i images command add_commands movie_name
exmaple: add_commands=[‘-vf’, ‘ pad=ceil(iw/2)*2:ceil(ih/2)*2’]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.make_time_evo_movie_from_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">make_time_evo_movie_from_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$\\frac{1}{2}</span> <span class="pre">U_i</span> <span class="pre">U_i$</span> <span class="pre">($mm^2/s^2$)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scientific'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x$</span> <span class="pre">($mm$)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$y$</span> <span class="pre">($mm$)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qtyname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'qty'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffmpeg_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/takumi/Documents/git/tflow/tflow/ffmpeg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.make_time_evo_movie_from_udata" title="Permalink to this definition"></a></dt>
<dd><p>Make a movie about the running average (number of frames to average is specified by “t”)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qty</strong> (<em>3D array</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>duration</em><em>)</em>) – … quantity to show as a movie (energy, enstrophy, vorticity, etc)</p></li>
<li><p><strong>xx</strong> (<em>2D array</em><em>, </em><em>x-coordinates</em><em> (</em><em>height</em><em>, </em><em>width</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2D array</em><em>, </em><em>y-coordinates</em><em> (</em><em>height</em><em>, </em><em>width</em><em>)</em>) – </p></li>
<li><p><strong>time</strong> (<em>1D array</em><em>, </em><em>time</em>) – </p></li>
<li><p><strong>t</strong> (<em>int</em><em>, </em><em>number of frames to average</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>number of frames to skip between two frames</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>label of the quantity</em><em>, </em><em>default is '$frac{1}{2} U_i U_i$</em><em> (</em><em>$mm^2/s^2$</em><em>)</em><em>'</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>z1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>default: 0</em><em>, </em><em>color range minimum</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>default: None</em><em>, </em><em>color range minimum</em>) – </p></li>
<li><p><strong>draw_box</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>draw a box around the heatmap</em>) – </p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>default: '$x$</em><em> (</em><em>$mm$</em><em>)</em><em>'</em>) – </p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>default: '$y$</em><em> (</em><em>$mm$</em><em>)</em><em>'</em>) – </p></li>
<li><p><strong>savedir</strong> (<em>str</em><em>, </em><em>default: './'</em><em>, </em><em>directory where the movie is saved</em>) – </p></li>
<li><p><strong>qtyname</strong> (<em>str</em><em>, </em><em>default: 'qty'</em><em>, </em><em>name of the quantity</em>) – </p></li>
<li><p><strong>framerate</strong> (<em>int</em><em>, </em><em>default: 10</em><em>, </em><em>framerate of the movie</em>) – </p></li>
<li><p><strong>ffmpeg_path</strong> (<em>str</em><em>, </em><em>path to ffmpeg</em>) – </p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>it overwrites the existing movie</em>) – </p></li>
<li><p><strong>redo</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>it generates the images again even if the movie exists</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>use the notebook to make the movie</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.mask_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">mask_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.mask_udata" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy.masked array of udata
… The shape of the mask must be one of ushape, ushape[1:], ushape[1:-1] where ushape=udata.shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>v-field data</em>) – </p></li>
<li><p><strong>mask</strong> (<em>md boolean array</em>) – </p></li>
<li><p><strong>ushape=udata.shape</strong> (<em>...</em><em> The shape of the mask must be one of</em>) – </p></li>
<li><p><strong>ushape</strong><strong>[</strong><strong>1</strong> (<em>]</em><em>, </em><em>ushape</em><em>[</em><em>1:-1</em><em>] </em><em>where ushape=udata.shape</em>) – </p></li>
<li><p><strong>array</strong> (<em>...</em><em> The mask must be a boolean</em>) – </p></li>
<li><p><strong>hide</strong> (<em>where True indicates values to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy masked nd array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.median_filter_scaar_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">median_filter_scaar_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.median_filter_scaar_field" title="Permalink to this definition"></a></dt>
<dd><p>Filter input with a median filter using scipy.signal.medfilt()
… data must have a shape of (…, duration)</p>
<blockquote>
<div><p>A median filter will be applied on the stacks (span by axis=0, 1, …, -2)
… The last axis is interpreted as a temporal axis of data</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>kernel_radius</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … radius of the kernel of the median filter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filtered</strong> – … Filtered data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.median_filter_vector_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">median_filter_vector_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.median_filter_vector_field" title="Permalink to this definition"></a></dt>
<dd><p>Filter a vector field with a median filter using scipy.signal.medfilt()
… data must have a shape of (dim, …, duration)</p>
<blockquote>
<div><p>A median filter will be applied on the stacks (span by axis= 1, …, -2)
… The last axis is interpreted as a temporal axis of data</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>nd array</em>) – </p></li>
<li><p><strong>kernel_radius</strong> (<em>int</em><em>, </em><em>default: 1</em>) – … radius of the kernel of the median filter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filtered</strong> – … Filtered data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.merge_simple_hdf5s">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">merge_simple_hdf5s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path2masterh5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths2h5s2add</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.merge_simple_hdf5s" title="Permalink to this definition"></a></dt>
<dd><p>This function merges the datasets in H5FILES to H5MASTER
… datasets in H5FILES must be located under the top directory (/DATASET1, /DATASET2, …)
… If H5MASTER already contains the dataset(s), this function does not overwrite the existing data unless specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path2masterh5</strong> (<em>str</em><em>, </em><em>a path to the master h5 file</em><em> (</em><em>where the data in paths2h5s2add will be added</em><em>)</em>) – </p></li>
<li><p><strong>paths2h5s2add</strong> (<em>list of str</em><em>, </em><em>paths where the data to be added to the master h5 are stored.</em>) – </p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>default: False. If True</em><em>, </em><em>the data in path2masterh5 will be overwritten by the data in paths2h5s2add if it exists.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="tflow.velocity.moddirpath">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">moddirpath</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'/Users/takumi/Documents/git/tflow/tflow'</span></em><a class="headerlink" href="#tflow.velocity.moddirpath" title="Permalink to this definition"></a></dt>
<dd><p>Module designed to process a planar/volumetric velocity field
- energy, enstrophy, vorticity fields
- energy spectra
- n-th order structure functions
- dissipation rate
- turbulent length scales</p>
<p>Philosophy:
Prepare a velocity field array “udata”.
Pass it to functions in this module to obtain any quantities related to turbulence.
It should require a single line to obtain the desired quantity from a velocity field
unless an intermediate step is computationally expensive.
The primary example for this is an autocorrelation function which is used for various quantities like Taylor microscale.</p>
<p>udata = (ux, uy, uz) or (ux, uy)
each ui has a shape (height, width, (depth), duration)</p>
<p>If ui-s are individually given, make udata like
udata = np.stack((ux, uy))</p>
<p>Dependencies:
h5py, tqdm, numpy, scipy, matplotlib</p>
<p>author: takumi matsuzawa</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.model_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">model_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.78</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.model_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns a model energy spectrum E(k)=c epsilon^(2/3) * k**(-5/3) f(kL) g(kEta)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>1d array</em><em>, </em><em>wavenumbers</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>float/1d array</em><em>, </em><em>dissipation rate</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>L</strong> (<em>float</em><em>, </em><em>integral length scale</em>) – </p></li>
<li><p><strong>c</strong> (<em>float</em><em>, </em><em>kolmogorov constant</em><em> (</em><em>default: 1.6</em><em>)</em>) – </p></li>
<li><p><strong>p0</strong> (<em>float</em><em>, </em><em>power in the energy containing regime</em><em> (</em><em>default: 2</em><em>, </em><em>p0=4: Karman spectrum</em><em>)</em>) – </p></li>
<li><p><strong>cL</strong> (<em>float</em><em>, </em><em>a parameter related to the onset of the inertial range</em><em> (</em><em>cL=6.78</em><em>, </em><em>Pope p233</em><em>)</em>) – </p></li>
<li><p><strong>ceta</strong> (<em>float</em><em>, </em><em>a parameter related to the onset of the inertial range</em><em> (</em><em>ceta=0.4</em><em>, </em><em>Pope p233</em><em>)</em>) – </p></li>
<li><p><strong>beta</strong> (<em>float: strength of the exponential in the dissipation range</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ek</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, energy spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.natural_sort">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">natural_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.natural_sort" title="Permalink to this definition"></a></dt>
<dd><p>natural-sorts elements in a given array
alist.sort(key=natural_keys) sorts in human order
<a class="reference external" href="http://nedbatchelder.com/blog/200712/human_sorting.html">http://nedbatchelder.com/blog/200712/human_sorting.html</a>
(See Toothy’s implementation in the comments)</p>
<p>e.g.-  arr = [‘a28’, ‘a01’, ‘a100’, ‘a5’]
… WITHOUT natural sorting,</p>
<blockquote>
<div><p>-&gt; [‘a01’, ‘a100’, ‘a28’, ‘a5’]</p>
</div></blockquote>
<dl class="simple">
<dt>… WITH natural sorting,</dt><dd><p>-&gt; [‘a01’, ‘a5’, ‘a28’, ‘a100’]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>list</em><em> or </em><em>numpy array of strings</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sorted_array</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>natural-sorted</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.norm">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.norm" title="Permalink to this definition"></a></dt>
<dd><p>Returns a normalized udata (a vector stored at every location is normalized)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array with a shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>(</em><em>depth</em><em>)</em><em>, </em><em>(</em><em>duration</em><em>)</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>normalized udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>: nd array with the same shape as udata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.normalize_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">normalize_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.normalize_udata" title="Permalink to this definition"></a></dt>
<dd><p>Returns the normalized v-field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>v-field data</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>norm_udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, normalized v-field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_energy_spectra">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_energy_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flattop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_e22</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ek</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_energy_spectra" title="Permalink to this definition"></a></dt>
<dd><p>A method to quickly plot the 1D energy spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em><em>,</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x-direction</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y-direction</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>grid spacing in z-direction</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>y1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>default: 'flattop'</em><em>, </em><em>window function to be used in the FFT</em><em>, </em><em>see scipy.signal.get_window</em><em>(</em><em>) </em><em>for more options</em>) – </p></li>
<li><p><strong>epsilon_guess</strong> (<em>float</em><em>, </em><em>default: 10 ** 5</em><em>, </em><em>estimate of the dissipation rate of the flow</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>default: 1.004</em><em>, </em><em>kinematic viscosity of the fluid</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>default: ''</em><em>, </em><em>label of the plot</em><em> (</em><em>e.g. 'Data on MM/DD/YY'</em><em>)</em>) – </p></li>
<li><p><strong>plot_e22</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>plot the E22 energy spectrum</em>) – </p></li>
<li><p><strong>plot_ek</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>plot the 3D energy spectrum</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>default: 1</em><em>, </em><em>figure number</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: 0</em><em>, </em><em>index of the time to specify the instantaneous v-field</em>) – </p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>plot legend</em>) – </p></li>
<li><p><strong>loc</strong> (<em>int</em><em>, </em><em>default: 3</em><em>, </em><em>location of the legend</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure, figure object</em>)</p></li>
<li><p><strong>axes</strong> (<em>tuple of two matplotlib.axes._subplots.AxesSubplot objects</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_energy_spectra_avg_w_energy_heatmap">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_energy_spectra_avg_w_energy_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flattop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_e11</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_e22</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ek</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_sv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yoffset_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_txtloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">0.1,</span> <span class="pre">0.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errorfill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_spectra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_energy_spectra_avg_w_energy_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>A method to quickly plot the energy spectra (Time-averaged) and time-averaged energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em><em>,</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x-direction</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y-direction</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>grid spacing in z-direction</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>y1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>default: 'flattop'</em><em>, </em><em>window function to be used in the FFT</em><em>, </em><em>see scipy.signal.get_window</em><em>(</em><em>) </em><em>for more options</em>) – </p></li>
<li><p><strong>epsilon_guess</strong> (<em>float</em><em>, </em><em>default: 10 ** 5</em><em>, </em><em>estimate of the dissipation rate of the flow</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>default: 1.004</em><em>, </em><em>kinematic viscosity of the fluid</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>default: ''</em><em>, </em><em>label of the plot</em><em> (</em><em>e.g. 'Data on MM/DD/YY'</em><em>)</em>) – </p></li>
<li><p><strong>plot_e22</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>plot the E22 energy spectrum</em>) – </p></li>
<li><p><strong>plot_ek</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>plot the 3D energy spectrum</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>default: 1</em><em>, </em><em>figure number</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: 0</em><em>, </em><em>index of the time to specify the instantaneous v-field</em>) – </p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>plot legend</em>) – </p></li>
<li><p><strong>loc</strong> (<em>int</em><em>, </em><em>default: 3</em><em>, </em><em>location of the legend</em>) – </p></li>
<li><p><strong>crop_edges</strong> (<em>int</em><em>, </em><em>default: 5</em><em>, </em><em>crop the edges of the energy spectra to remove the high frequency noise</em>) – </p></li>
<li><p><strong>yoffset_box</strong> (<em>int</em><em>, </em><em>default: 20</em><em>, </em><em>y-offset of the energy heatmap with respect to the center of the box</em>) – </p></li>
<li><p><strong>sb_txtloc</strong> (<em>tuple</em><em>, </em><em>default:</em><em> (</em><em>-0.1</em><em>, </em><em>0.4</em><em>)</em><em>, </em><em>location of the scale bar text</em>) – </p></li>
<li><p><strong>return_spectra</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>return the values of energy spectra</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure, figure object</em>)</p></li>
<li><p><strong>axes</strong> (<em>tuple of three matplotlib.axes._subplots.AxesSubplot objects</em>)</p></li>
<li><p><strong>spectra_dict</strong> (<em>dict, optional. Returned if return_spectra is True</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_energy_spectra_w_energy_heatmap">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_energy_spectra_w_energy_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flattop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_e22</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ek</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yoffset_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_txtloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">0.1,</span> <span class="pre">0.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">63095.7344480193</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_energy_spectra_w_energy_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>A method to quickly plot the energy spectra (snapshot) and time-averaged energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em><em>,</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x-direction</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y-direction</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>grid spacing in z-direction</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>y1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>default: 'flattop'</em><em>, </em><em>window function to be used in the FFT</em><em>, </em><em>see scipy.signal.get_window</em><em>(</em><em>) </em><em>for more options</em>) – </p></li>
<li><p><strong>epsilon_guess</strong> (<em>float</em><em>, </em><em>default: 10 ** 5</em><em>, </em><em>estimate of the dissipation rate of the flow</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>default: 1.004</em><em>, </em><em>kinematic viscosity of the fluid</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>default: ''</em><em>, </em><em>label of the plot</em><em> (</em><em>e.g. 'Data on MM/DD/YY'</em><em>)</em>) – </p></li>
<li><p><strong>plot_e22</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>plot the E22 energy spectrum</em>) – </p></li>
<li><p><strong>plot_ek</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>plot the 3D energy spectrum</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>default: 1</em><em>, </em><em>figure number</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: 0</em><em>, </em><em>index of the time to specify the instantaneous v-field</em>) – </p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>default: True</em><em>, </em><em>if True</em><em>, </em><em>plot legend</em>) – </p></li>
<li><p><strong>loc</strong> (<em>int</em><em>, </em><em>default: 3</em><em>, </em><em>location of the legend</em>) – </p></li>
<li><p><strong>crop_edges</strong> (<em>int</em><em>, </em><em>default: 5</em><em>, </em><em>crop the edges of the energy spectra to remove the high frequency noise</em>) – </p></li>
<li><p><strong>yoffset_box</strong> (<em>int</em><em>, </em><em>default: 20</em><em>, </em><em>y-offset of the energy heatmap with respect to the center of the box</em>) – </p></li>
<li><p><strong>sb_txtloc</strong> (<em>tuple</em><em>, </em><em>default:</em><em> (</em><em>-0.1</em><em>, </em><em>0.4</em><em>)</em><em>, </em><em>location of the scale bar text</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure, figure object</em>)</p></li>
<li><p><strong>axes</strong> (<em>tuple of three matplotlib.axes._subplots.AxesSubplot objects</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_mean_flow">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_mean_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yoffset_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_mean_flow" title="Permalink to this definition"></a></dt>
<dd><p>A method to quickly plot the mean flow (Only applicable to 2D v-field), time-averaged energy and time-averaged  enstrophy
… dependencies: tflow.graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velcity field</em>) – </p></li>
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x-coordinates</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y-coordinates</em>) – </p></li>
<li><p><strong>f_p</strong> (<em>float</em><em>, </em><em>forcing frequency</em>) – </p></li>
<li><p><strong>crop_edges</strong> (<em>int</em><em>, </em><em>default: 5</em><em>, </em><em>crop the edges of the energy spectra to remove the high frequency noise</em>) – </p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>frame rate of the udata</em>) – </p></li>
<li><p><strong>data_spacing</strong> (<em>int</em><em>, </em><em>default=1</em><em>,  </em><em>Forcing period = tau_p = int</em><em>(</em><em>1. / f_p * fps / data_spacing</em><em>)</em>) – </p></li>
<li><p><strong>umin</strong> (<em>float</em><em>, </em><em>ignore velocity values below this value</em>) – </p></li>
<li><p><strong>umax</strong> (<em>float</em><em>, </em><em>ignore velocity values above this value</em>) – </p></li>
<li><p><strong>tau0</strong> (<em>float</em><em>, </em><em>used to plot vertical bands</em>) – </p></li>
<li><p><strong>tau1</strong> (<em>float</em><em>, </em><em>used to plot vertical bands</em>) – </p></li>
<li><p><strong>yoffset_box</strong> (<em>int</em><em>, </em><em>default: 20</em><em>, </em><em>y-offset of the energy heatmap with respect to the center of the box</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure, figure object</em>)</p></li>
<li><p><strong>axes</strong> (<em>tuple of three matplotlib.axes._subplots.AxesSubplot objects</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_spatial_avg_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_spatial_avg_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$\\frac{1}{2}</span> <span class="pre">\\langle</span> <span class="pre">U_i</span> <span class="pre">U_i\\rangle~(mm^2/s^2)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$t~(s)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_spatial_avg_energy" title="Permalink to this definition"></a></dt>
<dd><p>Plots spatially averaged energy vs time
… &lt;0.5 ux^2 + uy^2 + uz^2&gt;_space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array- velocity field data</em>) – </p></li>
<li><p><strong>xx</strong> (<em>2d array- positional grids</em><em> (</em><em>x-coordinate</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array- positional grids</em><em> (</em><em>y-coordinate</em><em>)</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>] </em><em>will be plotted</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>] </em><em>will be plotted</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>] </em><em>will be plotted</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>] </em><em>will be plotted</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>This function considers udata</em><em>[</em><em>...</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>This function considers udata</em><em>[</em><em>...</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>xlabel</em>) – </p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>ylabel</em>) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>default: None</em><em>, </em><em>color range</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>default: None</em><em>, </em><em>color range</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>passed to pcolormesh</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>figure</em>)</p></li>
<li><p><strong>ax</strong> (<em>axes</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_time_avg_energy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_time_avg_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$\\frac{1}{2}</span> <span class="pre">\\langle</span> <span class="pre">U_i</span> <span class="pre">U_i\\rangle~(mm^2/s^2)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x~(mm)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$y~(mm)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_time_avg_energy" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> – </p></li>
<li><p><strong>xx</strong> – </p></li>
<li><p><strong>yy</strong> – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>x0</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>t1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>int</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
<li><p><strong>default</strong> – … index to specify temporal range of data used to compute time average (udata[…, t0:t1:inc])</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.plot_time_avg_enstrophy">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">plot_time_avg_enstrophy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$\\frac{1}{2}</span> <span class="pre">\\langle</span> <span class="pre">\\omega_z</span> <span class="pre">^2\\rangle~(1/s^2)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x~(mm)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$y~(mm)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.plot_time_avg_enstrophy" title="Permalink to this definition"></a></dt>
<dd><p>Plots time-averaged enstrophy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>velocity field</em><em>,</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x-direction</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y-direction</em>) – </p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>grid spacing in z-direction</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1, t0:t1])</p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>default: None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1, t0:t1])</p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1, t0:t1])</p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>default: None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1, t0:t1])</p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>default: None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1, t0:t1])</p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>default: None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1, t0:t1])</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>default: '$frac{1}{2} langle omega_z ^2rangle~</em><em>(</em><em>1/s^2</em><em>)</em><em>$'</em>) – </p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>xlabel</em>) – </p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>ylabel</em>) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>default: None</em><em>, </em><em>color range</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>default: None</em><em>, </em><em>color range</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>passed to pcolormesh</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>figure</em>)</p></li>
<li><p><strong>ax</strong> (<em>axes</em>)</p></li>
<li><p><strong>cc</strong> (<em>mappable</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.poisson_fft">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">poisson_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vort</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invlapl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.poisson_fft" title="Permalink to this definition"></a></dt>
<dd><p>Solves for psi in del^2 psi = vort</p>
<p>Source: <a class="reference external" href="https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933">https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vort</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>invlapl</strong> (<em>2d array</em>) – … inverse laplacian operator
… can be obtained from poisson_fft_prep()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psi</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.poisson_fft_prep">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">poisson_fft_prep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ny</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lapl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'discrete'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.poisson_fft_prep" title="Permalink to this definition"></a></dt>
<dd><p>Returns the coefficients to multiply the vorticity Fourier amplitudes</p>
<p>Source: <a class="reference external" href="https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933">https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Nx</strong> (<em>int</em><em>, </em><em>number of grid points in x</em>) – </p></li>
<li><p><strong>Ny</strong> (<em>int</em><em>, </em><em>number of grid points in x</em>) – </p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>grid spacing in x</em>) – </p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>grid spacing in y</em>) – </p></li>
<li><p><strong>lapl</strong> (<em>str</em><em>, </em><em>'discrete'</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>invlapl</strong> – … the coefficents for multiplying the vorticity Fourier amplitudes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.pol2cart_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">pol2cart_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udata_pol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.pol2cart_udata" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: Polar coord to Cartesian coord (r, phi, (ur, uphi)) -&gt; (x, y, (ux, uy))
… Returns polar coordiantes AND velocity field in the standard basis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>numpy array</em><em>, </em><em>radial distance</em>) – </p></li>
<li><p><strong>theta</strong> (<em>numpy array</em><em>, </em><em>polar angle</em><em> [</em><em>-pi/2</em><em>, </em><em>pi/2</em><em>] </em><em>(</em><em>angle from the z-axis</em><em>)</em>) – </p></li>
<li><p><strong>udata_pol</strong> (<em>numpy array</em><em>, </em><em>velocity field in the polar basis</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x, y, udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cartesian coordinates and velocity field in the standard basis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.process_large_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">process_large_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">udatapath</span></em>, <em class="sig-param"><span class="pre">func=&lt;function</span> <span class="pre">get_spatial_avg_energy&gt;</span></em>, <em class="sig-param"><span class="pre">t0=0</span></em>, <em class="sig-param"><span class="pre">t1=None</span></em>, <em class="sig-param"><span class="pre">x0=0</span></em>, <em class="sig-param"><span class="pre">x1=None</span></em>, <em class="sig-param"><span class="pre">y0=0</span></em>, <em class="sig-param"><span class="pre">y1=None</span></em>, <em class="sig-param"><span class="pre">z0=0</span></em>, <em class="sig-param"><span class="pre">z1=None</span></em>, <em class="sig-param"><span class="pre">inc=10</span></em>, <em class="sig-param"><span class="pre">notebook=True</span></em>, <em class="sig-param"><span class="pre">reynolds_decomposition=False</span></em>, <em class="sig-param"><span class="pre">clean=False</span></em>, <em class="sig-param"><span class="pre">cutoff=inf</span></em>, <em class="sig-param"><span class="pre">method='nn'</span></em>, <em class="sig-param"><span class="pre">median_filter=False</span></em>, <em class="sig-param"><span class="pre">replace_zeros=True</span></em>, <em class="sig-param"><span class="pre">overwrite_udatam=False</span></em>, <em class="sig-param"><span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.process_large_udata" title="Permalink to this definition"></a></dt>
<dd><p>(Intended for 3D velocity field data)
Given a path to a hdf5 file which stores udata,
it returns the result of functions without loading an entire udata onto RAM
… example:</p>
<blockquote>
<div><dl class="simple">
<dt>results = process_large_udata(udatapath, func=get_spatial_avg_enstrophy,</dt><dd><p>inc=inc, dx=dx, dy=dy, dz=dz)</p>
</dd>
</dl>
<p>enst, enst_err = result</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udatapath</strong> (<em>str</em><em>, </em><em>path to a h5 file which stores udata</em>) – </p></li>
<li><p><strong>func</strong> (<em>function</em>) – … a function to compute a quantity you desire from udata</p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index of the first frame to be processed</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>default: None</em>) – … If t1 were not given, it processes from the beginning to the end.</p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>use every &quot;inc&quot; frames</em><em>, </em><em>default: 10</em>) – … temporal increment at which the function is called</p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>default: 0</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> (<em>z1</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> (<em>None</em>) – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>int</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>default</strong> – … index to specify volume of data to load (udata[:, y0:y1, x0:x1, z0:z1])</p></li>
<li><p><strong>inc</strong> – … inc = 1 means a velocity field at every frame is used for processing.</p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … if True, it will use tqdm_notebook instead of tqdm to show progress</p></li>
<li><p><strong>clean</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … if True, it will clean the v-field data (udata) before processing
… Cleaning involves removing spurious vectors by thresholding and median-filtering.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>default: np.inf</em>) – … if clean=True, it will remove vectors with magnitude smaller than cutoff</p></li>
<li><p><strong>median_filter</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … if True and clean=True, it will apply a median filter to the v-field data.</p></li>
<li><p><strong>replace_zeros</strong> (<em>bool</em><em>, </em><em>default: True</em>) – <p>… if True and clean=True, it will replace zeros with the nearest non-zero value.
… This is sometimes necessary as zero values are default values instead of nan values for some softwares</p>
<blockquote>
<div><p>(DaVis- STB).</p>
</div></blockquote>
</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>, </em><em>default: {}</em><em>, </em><em>additional keyword arguments to be passed to func</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>datalist</strong> – … outputs of the function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.psi2udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">psi2udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1,</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cartesian'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.psi2udata" title="Permalink to this definition"></a></dt>
<dd><p>Derives udata from streamfunction psi.
returns v = dq/dx and u= -dq/dy, on U-grid</p>
<p>Source: <a class="reference external" href="https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933">https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi</strong> (<em>2d array</em><em>, </em><em>streamfunction values</em>) – </p></li>
<li><p><strong>dx</strong> (<em>spacing in x-direction</em>) – </p></li>
<li><p><strong>dy</strong> (<em>spacing in y-direction</em>) – </p></li>
<li><p><strong>xy_orientations</strong> (<em>2d array</em><em>, </em><em>(</em><em>x-orientation</em><em>, </em><em>y-orientation</em><em>)</em>) – … x-orientation: 1 if x increases from left to right, -1 if x decreases from left to right
… y-orientation: 1 if y increases from bottom to top, -1 if y decreases from bottom to top</p></li>
<li><p><strong>xx</strong> (<em>2d array</em><em>, </em><em>x-coordinates of psi</em>) – </p></li>
<li><p><strong>yy</strong> (<em>2d array</em><em>, </em><em>y-coordinates of psi</em>) – </p></li>
<li><p><strong>coordinate_system</strong> (<em>string</em><em>, </em><em>default: 'cartesian'</em><em>, </em><em>must be 'cartesian'</em><em> or </em><em>'cylindrical'</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, velocity field (Cartesian)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.psi2udata_cylindrical">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">psi2udata_cylindrical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rrho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.psi2udata_cylindrical" title="Permalink to this definition"></a></dt>
<dd><p>Derives udata from streamfunction psi in cylindrical basis.</p>
<p>Source: <a class="reference external" href="https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933">https://anaconda.org/bfiedler/n090_streamfunctionvorticity2d/notebook?version=2018.07.28.0933</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi</strong> (<em>2d array</em><em>, </em><em>streamfunction values</em>) – </p></li>
<li><p><strong>rrho</strong> (<em>2d array</em><em>, </em><em>rho-coordinates of psi</em>) – </p></li>
<li><p><strong>zz</strong> (<em>2d array</em><em>, </em><em>z-coordinates of psi</em>) – </p></li>
<li><p><strong>return_cartesian</strong> (<em>bool</em><em>, </em><em>default: False</em><em>, </em><em>if True</em><em>, </em><em>returns udata in cartesian coordinates</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong> – … if return_cartesian=True: udata = (ux, uy)
… if return_cartesian=False: udata = (uz, urho)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d array, velocity field (cylindrical)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.rankine_vortex_2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">rankine_vortex_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.rankine_vortex_2d" title="Permalink to this definition"></a></dt>
<dd><p>Reutrns a 2D velocity field with a single Rankine vortex at (x0, y0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>numpy array</em>) – x-coordinate, 2d grid</p></li>
<li><p><strong>yy</strong> (<em>numpy array</em>) – y-coordinate, 2d grid</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – x-coordinate of the position of the rankine vortex</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – y-coordinate of the position of the rankine vortex</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – circulation of the rankine vortex</p></li>
<li><p><strong>a</strong> (<em>float</em>) – core radius of the rankine vortex</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong> – … udata[0] = ux
… udata[1] = uy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, velocity field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.rankine_vortex_line_3d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">rankine_vortex_line_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ux0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uy0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uz0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.rankine_vortex_line_3d" title="Permalink to this definition"></a></dt>
<dd><p>Reutrns a 3D velocity field with a Rankine vortex filament at (x0, y0, z)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>3d numpy grid</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d numpy grid</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d numpy grid</em>) – </p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>location of Rankine vortex filament</em>) – </p></li>
<li><p><strong>y0</strong> (<em>float</em><em>, </em><em>location of Rankine vortex filament</em>) – </p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>circulation</em>) – </p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>core radius</em>) – </p></li>
<li><p><strong>uz0</strong> (<em>float</em><em>, </em><em>constant velocity component in the z-direction</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata</strong> – … udata[0] = ux
… udata[1] = uy
… udata[2] = uz</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd array, velocity field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.read_data_from_h5">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">read_data_from_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grpname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.read_data_from_h5" title="Permalink to this definition"></a></dt>
<dd><p>Grabs data in a simply organized h5 file
… Return the data stored at /keys[0], /keys[1], …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5path</strong> (<em>str</em><em>, </em><em>a path to a h5 file</em>) – </p></li>
<li><p><strong>keys</strong> (<em>list</em><em>, </em><em>a list of keys</em>) – if</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>data_read</strong> (<em>list of data stroed in a h5 file- [data0, data1, data2, …]</em>)</p></li>
<li><p><em>or</em></p></li>
<li><p><strong>datadict</strong> (<em>dictionary of data- {name0: data0, name1: data1, name2: data2, …}</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.read_pickle">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">read_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.read_pickle" title="Permalink to this definition"></a></dt>
<dd><p>A wrapper to read a pickle file
… There was a change in the default encoding type during some version update of the pickle package
… This wrapper attempts to read a pickle file with different approaches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em>, </em><em>path to the pickle</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>obj</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object stored in the given path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.read_simple_hdf5">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">read_simple_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datapath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grpname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.read_simple_hdf5" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of data in a hdf5
1. ASSUMED DATA ARCHITECTURE (DEFAULT)
… The hdf5 file must have a simple structure.</p>
<blockquote>
<div><p>… /DataA
… /DataB
… /DataC</p>
</div></blockquote>
<dl class="simple">
<dt>… The returned dictionary has a structure like following.</dt><dd><p>datadit[‘DataA’] = values of DataA
datadit[‘DataB’] = values of DataB …</p>
</dd>
</dl>
<p>2. OPTIONAL ARCHITECTURE
… It is possible to read a COLLECTION of simple data</p>
<blockquote>
<div><p>… /grp0/DataA
… /grp0//DataB
… /grp0//DataC
… /grp1/DataA
… /grp1//DataB
… /grp1//DataC</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datapath</strong> (<em>str</em><em>, </em><em>path to the hdf5 file</em>) – </p></li>
<li><p><strong>grpname</strong> (<em>str</em><em>, </em><em>default: None</em>) – … ‘grpname’ is the name of the group in the h5 nameto be read.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>datadict</strong> – … datadict[‘DataA’] = values of /DataA</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.remove_data_from_h5">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">remove_data_from_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.remove_data_from_h5" title="Permalink to this definition"></a></dt>
<dd><p>Removes datasets from a h5 file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.remove_nans_for_array_pair">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">remove_nans_for_array_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.remove_nans_for_array_pair" title="Permalink to this definition"></a></dt>
<dd><p>remove nans or infs for a pair of 1D arrays, and returns the compressed arrays with the same length
e.g.: arr1 = [0, 0.1, 0.2, np.nan, 0.4, 0.5], arr2 = [-1.2, 19.2. 155., np.inf, 0.1]</p>
<blockquote>
<div><p>-&gt; compressed_arr1 = [0, 0.1, 0.2, 0.5], compressed_arr2 = [-1.2, 19.2., 0.1]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>numpy array</em>) – … may include np.nan and np.inf</p></li>
<li><p><strong>arr2</strong> (<em>numpy array</em>) – … may include np.nan and np.inf</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>compressed_arr1</strong> (<em>numpy array</em>) – … without any np</p></li>
<li><p><strong>compressed_arr2</strong> (<em>numpy array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.replace_nan_w_nn">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">replace_nan_w_nn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.replace_nan_w_nn" title="Permalink to this definition"></a></dt>
<dd><p>Nearest neighbor filling for nans in an array
… Nearest neighbor filling of ND data
… Do not use this function to interpolate udata! Use replace_nan_w_nn_udata(udata) instead.
… This is not designed for udata because NN filling for ND data treats all axes equally. Since individual axis of
udata means (velocity components, height, width, depth, duration), applying this function to udata requires care.
… NN filling occurs from the right to left.</p>
<blockquote>
<div><dl>
<dt>i.e. array[n-3, n-2, n-1, n, n+1] = 100, np.nan, np.nan, np.nan, 200</dt><dd><p>-&gt; 100, np.nan, np.nan, 200, 200 # Step1: Fill from the right first
-&gt; 100, 100, np.nan, 200, 200 # Step2: Then, fill from the left</p>
<blockquote>
<div><p>-&gt; 100, 100, 200, 200, 200  # Repeat Step1: Fill from the right</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ND data with missing values</em><em> (</em><em>np.nan</em><em>)</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, use tqdm_notebook instead of tqdm for a progress bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ND data, missing values are filled with the nearest neighbor values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.replace_nan_w_nn_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">replace_nan_w_nn_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.replace_nan_w_nn_udata" title="Permalink to this definition"></a></dt>
<dd><p>Nearest neighbor filling for nans in udata
The fastest and most robust function to fill the missing values in udata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>ndarray</em><em>, </em><em>velocity field</em><em>, </em><em>shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>, </em><em>duration</em><em>)</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, use tqdm_notebook instead of tqdm for a progress bar</p></li>
<li><p><strong>showtqdm</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … If True, show tqdm progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>udata_filled</strong> – … missing values (np.nan) are filled with the nearest neighbors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ND array with shape (dim, height, width, depth, duration) or  (dim, height, width, duration)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.replace_nans">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">replace_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.replace_nans" title="Permalink to this definition"></a></dt>
<dd><p>Replace NaN elements in an array using an iterative inpainting algorithm.
The algorithm is the following:
1) For each element in the input array, replace it by a weighted average
of the neighbouring elements which are not NaN themselves. The weights depends
of the method type. If <code class="docutils literal notranslate"><span class="pre">method=localmean</span></code> weight are equal to 1/( (2*kernel_size+1)**2 -1 )
2) Several iterations are needed if there are adjacent NaN elements.
If this is the case, information is “spread” from the edges of the missing
regions iteratively, until the variation is below a certain threshold.</p>
<ul class="simple">
<li><p>Generalized to nD array by Takumi Matsuzawa (UChicago) 2020/02/20</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>nd np.ndarray</em>) – </p></li>
<li><p><strong>replaced</strong> (<em>an array containing NaN elements that have to be</em>) – </p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>number of iterations</em>) – </p></li>
<li><p><strong>kernel_radius</strong> (<em>int</em><em>, </em><em>size of the kernel: 2 * kernel_radius + 1</em>) – </p></li>
<li><p><strong>kernel_sigma</strong> (<em>float</em><em>, </em><em>sigma of the gaussian kernel</em>) – </p></li>
<li><p><strong>method</strong> (<em>str</em>) – <dl class="simple">
<dt>… the method used to replace invalid values. Valid options are</dt><dd><ol class="arabic simple">
<li><p>nearest neighbor filling (method = “nn”)- fast</p></li>
<li><p>filling with some constant (method = “fill”)- fast</p></li>
<li><p>filling with local mean (method = “localmean”)- slow</p></li>
<li><p>filling with an idw kernel (method = “idw”) - slow</p></li>
</ol>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filled</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nd np.ndarray, input array with its NaN elements being replaced by some numbers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.resample">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.resample" title="Permalink to this definition"></a></dt>
<dd><p>Resample x, y
… this is particularly useful to crete a evenly spaced data in log from a linearly spaced data, and vice versa</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>y</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of points to resample</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>options are &quot;linear&quot; and &quot;log&quot;</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_new, y_rs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d arrays of new x and new y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.resample2d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">resample2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_x_in_2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.resample2d" title="Permalink to this definition"></a></dt>
<dd><p>Resample x, y
… this is particularly useful to crete a evenly spaced data in log from a linearly spaced data, and vice versa</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>ys</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of points to resample</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>options are &quot;linear&quot; and &quot;log&quot;</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_new, y_rs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d arrays of new x and new y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.reynolds_decomposition">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">reynolds_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.reynolds_decomposition" title="Permalink to this definition"></a></dt>
<dd><p>Apply the Reynolds decomposition to a velocity field
Returns a mean field (time-averaged) and a fluctuating field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>udata</strong> (<em>numpy array</em>) – … (ux, uy, uz) or (ux, uy)
… ui has a shape (height, width, depth, duration) or (height, width, depth) (3D)
… ui may have a shape (height, width, duration) or (height, width) (2D)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>u_mean</strong> (<em>nd array, mean velocity field</em>)</p></li>
<li><p><strong>u_turb</strong> (<em>nd array, turbulent velocity field</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.run_vel_statistics">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">run_vel_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.run_vel_statistics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the statistics of the velocity field stored in dpath, and save the results
… A helper for derive_easy()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path to the h5 file where velocity field is stored</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>increment of the time index to be used to compute the statistics</em>) – … inc==1: use all v-field data
… inc==n: use every n-th frame of the v-field data</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>whether to overwrite the existing data in dpath</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>index of the first frame to be used to compute the statistics</em><em>, </em><em>[</em><em>t0</em><em>, </em><em>t1</em><em>)</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>index of the first frame to be used to compute the statistics</em><em>, </em><em>[</em><em>t0</em><em>, </em><em>t1</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.sample_streamlines">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">sample_streamlines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.sample_streamlines" title="Permalink to this definition"></a></dt>
<dd><p>Returns n streamlines which go through n randomly chosen points inside xx, yy, zz
… How this works: Basically, seed particles at the instant of time, and track how they move by the instantaneous vel field.
… Streamlines are a family of curves that are instantaneously tangent to the velocity vector of the flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>nx</em><em>, </em><em>ny</em><em>, </em><em>nz</em><em>, </em><em>3</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>nx</em><em>, </em><em>ny</em><em>, </em><em>nz</em><em>)</em>) – </p></li>
<li><p><strong>yy</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>nx</em><em>, </em><em>ny</em><em>, </em><em>nz</em><em>)</em>) – </p></li>
<li><p><strong>zz</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>nx</em><em>, </em><em>ny</em><em>, </em><em>nz</em><em>)</em>) – </p></li>
<li><p><strong>npt</strong> (<em>float</em><em>, </em><em>number of streamlines</em>) – … to be precise, this is the number of points through which streamlines are drawn.</p></li>
<li><p><strong>xmin</strong> (<em>int</em>) – <dl class="simple">
<dt>… The initial points were taken from inside the box whose diagonal vertices are</dt><dd><p>(xx[ymin, xmin, zmin], yy[ymin, xmin, zmin], zz[ymin, xmin, zmin])
and
(xx[ymax, xmax, zmax], yy[ymax, xmax, zmax], zz[ymax, xmax, zmax])</p>
</dd>
</dl>
</p></li>
<li><p><strong>xmax</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>ymin</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>ymax</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>zmin</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>zmax</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>t0</strong> (<em>int</em><em>, </em><em>time index</em><em>, </em><em>it gets the streamlines using udata</em><em>[</em><em>...</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>t1</strong> (<em>int</em><em>, </em><em>time index</em><em>, </em><em>it gets the streamlines using udata</em><em>[</em><em>...</em><em>, </em><em>t0:t1</em><em>]</em>) – </p></li>
<li><p><strong>dt</strong> (<em>float</em><em>, </em><em>param to control the accuracy of the 3D streamlines</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>strmlines_master</strong> – … length of the list is duration (t1-t0)
…… strmlines_master[10] are a collection of n streamlines at frame 10
… If t1-t0 == 1 (given udata is a snapshot of the velocity field):</p>
<blockquote>
<div><p>it returns strmlines_master[0]</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.scale_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">scale_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0034</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_k_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.scale_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Scales raw energy spectrum by given dissipation rate and viscosity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e_k</strong> (<em>numpy array</em>) – spectral energy density</p></li>
<li><p><strong>kk</strong> (<em>numpy array</em>) – wavenumber</p></li>
<li><p><strong>epsilon</strong> (<em>numpy array</em><em> or </em><em>float</em>) – dissipation rate used for scaling. It could be 1D numpy array or float.</p></li>
<li><p><strong>float</strong> (<em>nu numpy array or</em>) – viscosity used for scaling. It could be 1D numpy array or float.</p></li>
<li><p><strong>e_k_err</strong> (<em>numpy array</em>) – error of dissipation rate used for scaling. It could be 1D numpy array or float.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>e_k_norm, k_norm if e_k_err is not given</em></p></li>
<li><p><em>e_k_norm, e_k_err_norm, k_norm if e_k_err is given</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.scale_raw_structure_funciton_long">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">scale_raw_structure_funciton_long</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dxxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dxx_errs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.004</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.scale_raw_structure_funciton_long" title="Permalink to this definition"></a></dt>
<dd><p>Returns the scaled structure functions when raw structure function data are given
… This allows users to scale the structure functions with epsilon and nu input by the users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rrs</strong> (<em>numpy array</em>) – separation between two points, output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>Dxxs</strong> (<em>numpy array</em>) – longitudinal structure function, output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>Dxx_errs</strong> (<em>numpy array</em>) – error of longitudinal structure function, output of get_two_point_vel_corr_iso()</p></li>
<li><p><strong>epsilon</strong> (<em>numpy array</em><em> or </em><em>float</em>) – dissipation rate</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – viscosity</p></li>
<li><p><strong>p</strong> (<em>int/float</em>) – order of the structure function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rrs_s</strong> (<em>numpy array</em>) – Scaled r</p></li>
<li><p><strong>Dxxs_s</strong> (<em>numpy array</em>) – Scaled structure function</p></li>
<li><p><strong>Dxx_errs_s</strong> (<em>numpy array (optional)</em>) – Scaled DLL error</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.scaled_model_energy_spectrum">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">scaled_model_energy_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ceta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.scaled_model_energy_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Returns a model energy spectrum rescaled by eta and epsilon
… model spectrum: E(k)=c epsilon^(2/3) * k**(-5/3) f(kL) g(kEta)</p>
<dl class="simple">
<dt>e.g.</dt><dd><p>keta = np.logspace(-3, 0)
plt.plot(keta, vel.scaled_model_energy_spectrum(keta, 1e5, 1.004, 10))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keta</strong> (<em>1d array</em><em>, </em><em>wavenumbers * kolmogorov length</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>float/1d array</em><em>, </em><em>dissipation rate</em>) – </p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>viscosity</em>) – </p></li>
<li><p><strong>L</strong> (<em>float</em><em>, </em><em>integral length scale</em>) – </p></li>
<li><p><strong>c</strong> (<em>float</em><em>, </em><em>kolmogorov constant</em><em> (</em><em>default: 1.6</em><em>)</em>) – </p></li>
<li><p><strong>p0</strong> (<em>float</em><em>, </em><em>power in the energy containing regime</em><em> (</em><em>default: 2</em><em>, </em><em>p0=4: Karman spectrum</em><em>)</em>) – </p></li>
<li><p><strong>cL</strong> (<em>float</em><em>, </em><em>a parameter related to the onset of the inertial range</em><em> (</em><em>cL=6.78</em><em>, </em><em>Pope p233</em><em>)</em>) – </p></li>
<li><p><strong>ceta</strong> (<em>float</em><em>, </em><em>a parameter related to the onset of the inertial range</em><em> (</em><em>ceta=0.4</em><em>, </em><em>Pope p233</em><em>)</em>) – </p></li>
<li><p><strong>beta</strong> (<em>float: strength of the exponential in the dissipation range</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eks</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d array, rescaled energy spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.show_h5_keys">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">show_h5_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.show_h5_keys" title="Permalink to this definition"></a></dt>
<dd><p>Displays a list of dataset names in h5- only the datasets stored under the top</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.show_h5_subkeys">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">show_h5_subkeys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.show_h5_subkeys" title="Permalink to this definition"></a></dt>
<dd><p>Displays a list of dataset names in h5- only the datasets stored under the top</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.slice_3d_scalar_field">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">slice_3d_scalar_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.slice_3d_scalar_field" title="Permalink to this definition"></a></dt>
<dd><p>Returns a spatially 2D udata which is on the cross section of a volumetric data
… There are two ways to return the velocity field on the cross section.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>In the standard basis (xyz, i.e. ux, uy, uz)</p></li>
<li><dl class="simple">
<dt>In the NEW basis (which I call npq basis, i.e. un, up, uq)</dt><dd><p>the basis vector n is identical to the unit area vector of the cross section</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<dl>
<dt>… By default, this function returns a 2D velocity field in the NEW basis (npq) as well as its coordinates in the same basis.</dt><dd><p>… This is a natural choice since the cross section is spanned by the new basis vectors p and q.
… Any postional vector on the cross section is expresed by its linear combinations.</p>
<blockquote>
<div><p>r = c1 hat{p} + c2 hat{q}
(c1, c2) are the coordinates in the pq basis.
(Technically, the basis vectors are n, p, q but the coefficient of the n basis vector is always zero on the cross section.)
By default, this function returns…
1. velocity field in the NEW basis (npq) on the cross section
2. Coordinates in the pq basis (technically npq basis, but the coordinate in the basis vector n is always zero so I don’t return it)</p>
</div></blockquote>
</dd>
<dt>… You CAN retrieve the velocity field in the standard basis (xyz, i.e. ux, uy, uz).</dt><dd><p>Just set “u_basis” equal to “xyz”
If you want both (in npq and xyz basses), set  “u_basis” equal to “both”</p>
</dd>
<dt>… If you want a change-of-basis matrix from basis A to basis B, use ilpm.vector.get_change_of_basis_matrix(basisA, basisB)</dt><dd><dl class="simple">
<dt>e.g.</dt><dd><p>Mab = vec.get_change_of_basis_matrix(basis_xyz, basis_npq) # transformation matrix from xyz coords to npq coords
Mba = np.linalg.inv(Mab) # the change-of-basis matrix is ALWAYS unitary.</p>
</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filed</strong> (<em>spatially 3d udata</em><em> (</em><em>3D</em><em> or </em><em>4D array</em><em>) </em><em>with shape</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>, </em><em>duration</em><em>) or  </em><em>(</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>grid of x-coordinate</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>grid of y-coordinate</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>grid of z-coordinate</em>) – </p></li>
<li><p><strong>n</strong> (<em>1d array-like</em><em>, </em><em>area vector</em><em> (</em><em>it does not have to be normalized</em><em>)</em>) – </p></li>
<li><p><strong>pt</strong> (<em>1d array-like</em><em>, </em><em>xyz coordinates of a point on the plane</em><em> (</em><em>Note that n and pt uniquely defines a plane</em><em>)</em>) – </p></li>
<li><p><strong>spacing</strong> (<em>float</em><em>, </em><em>must be greater than 0. Sampling spatial resolution on the plane</em>) – </p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>tflow.graph</em><em> or </em><em>takumi.graph is required. If True</em><em>, </em><em>it will automatically plot the sampled points on the</em>) – cross section in a 3D view as well as the new basis vectors</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>interpolation method of udata</em><em>, </em><em>options: 'nn'</em><em>, </em><em>'localmean'</em><em>, </em><em>'idw'</em>) – … volumetric udata may contain lots of np.nan, and cleaning udata often results better results.
… ‘nn’: nearest neighbor filling
… ‘localmean’: filling using a direct covolution (inpainting with a neighbor averaging kernel)
… ‘idw’: filling using a direct covolution (inpainting with a Gaussian kernel)</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>basis</strong> (<em>3x3 matrix</em><em>, </em><em>column vectors are the basis vectors.</em>) – … If given, the basis vectors are used to span the crosss section.
… The basis vectors may be rotated or converted to right-handed at the end.
…</p></li>
<li><p><strong>apply_convention</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it enforces the new basis to follow the convention</em><em> (</em><em>right-handed etc.</em><em>)</em>) – </p></li>
<li><p><strong>u_basis</strong> (<em>str</em><em>, </em><em>default: &quot;npq&quot;</em><em>, </em><em>options: &quot;npq&quot;</em><em>, </em><em>&quot;xyz&quot; / &quot;standard&quot; &quot;std&quot;</em><em>, </em><em>&quot;both&quot;</em>) – <p>… the basis used to represent a velocity field on the plane
… “npq”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (un, up, uq)</p>
<blockquote>
<div><dl class="simple">
<dt>(un, up, uq) = (velocity component parallel to the area vector,</dt><dd><p>vel comp parallel to the second basis vector p,
vel comp parallel to the second basis vector q)</p>
</dd>
</dl>
</div></blockquote>
<p>… “xyz”. “standard”, or “std”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (ux, uy, uz)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata_si_npq_basis</strong> (<em>udata in the npq basis on the plane spanned by the basis vectors p and q.</em>) – … its shape is (dim, height, width, duration) = (3, height, width, duration)
… udata_si_npq_basis[0, …] is velocity u cdot hat{n}
… udata_si_npq_basis[1, …] is velocity u cdot hat{p}
… udata_si_npq_basis[2, …] is velocity u cdot hat{q}</p></li>
<li><p><strong>pp</strong> (<em>2d nd array, p-grid</em>)</p></li>
<li><p><strong>qq</strong> (<em>2d nd array, q-grid</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.slice_3d_scalar_field_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">slice_3d_scalar_field_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.slice_3d_scalar_field_old" title="Permalink to this definition"></a></dt>
<dd><p>[DEPRECATED- slice_3d_scalar_field]
Returns a spatially 2D udata which is on the cross section of a volumetric data
… There are two ways to return the velocity field on the cross section.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>In the standard basis (xyz, i.e. ux, uy, uz)</p></li>
<li><dl class="simple">
<dt>In the NEW basis (which I call npq basis, i.e. un, up, uq)</dt><dd><p>the basis vector n is identical to the unit area vector of the cross section</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<dl>
<dt>… By default, this function returns a 2D velocity field in the NEW basis (npq) as well as its coordinates in the same basis.</dt><dd><p>… This is a natural choice since the cross section is spanned by the new basis vectors p and q.
… Any postional vector on the cross section is expresed by its linear combinations.</p>
<blockquote>
<div><p>r = c1 hat{p} + c2 hat{q}
(c1, c2) are the coordinates in the pq basis.
(Technically, the basis vectors are n, p, q but the coefficient of the n basis vector is always zero on the cross section.)
By default, this function returns…
1. velocity field in the NEW basis (npq) on the cross section
2. Coordinates in the pq basis (technically npq basis, but the coordinate in the basis vector n is always zero so I don’t return it)</p>
</div></blockquote>
</dd>
<dt>… You CAN retrieve the velocity field in the standard basis (xyz, i.e. ux, uy, uz).</dt><dd><p>Just set “u_basis” equal to “xyz”
If you want both (in npq and xyz basses), set  “u_basis” equal to “both”</p>
</dd>
<dt>… If you want a change-of-basis matrix from basis A to basis B, use ilpm.vector.get_change_of_basis_matrix(basisA, basisB)</dt><dd><dl class="simple">
<dt>e.g.</dt><dd><p>Mab = vec.get_change_of_basis_matrix(basis_xyz, basis_npq) # transformation matrix from xyz coords to npq coords
Mba = np.linalg.inv(Mab) # the change-of-basis matrix is ALWAYS unitary.</p>
</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filed</strong> (<em>spatially 3d udata</em><em> (</em><em>3D</em><em> or </em><em>4D array</em><em>) </em><em>with shape</em><em> (</em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>, </em><em>duration</em><em>) or  </em><em>(</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>grid of x-coordinate</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>grid of y-coordinate</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>grid of z-coordinate</em>) – </p></li>
<li><p><strong>n</strong> (<em>1d array-like</em><em>, </em><em>area vector</em><em> (</em><em>it does not have to be normalized</em><em>)</em>) – </p></li>
<li><p><strong>pt</strong> (<em>1d array-like</em><em>, </em><em>xyz coordinates of a point on the plane</em><em> (</em><em>Note that n and pt uniquely defines a plane</em><em>)</em>) – </p></li>
<li><p><strong>spacing</strong> (<em>float</em><em>, </em><em>must be greater than 0. Sampling spatial resolution on the plane</em>) – </p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>tflow.graph</em><em> or </em><em>takumi.graph is required. If True</em><em>, </em><em>it will automatically plot the sampled points on the</em>) – cross section in a 3D view as well as the new basis vectors</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>interpolation method of udata</em><em>, </em><em>options: 'nn'</em><em>, </em><em>'localmean'</em><em>, </em><em>'idw'</em>) – … volumetric udata may contain lots of np.nan, and cleaning udata often results better results.
… ‘nn’: nearest neighbor filling
… ‘localmean’: filling using a direct covolution (inpainting with a neighbor averaging kernel)
… ‘idw’: filling using a direct covolution (inpainting with a Gaussian kernel)</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>basis</strong> (<em>3x3 matrix</em><em>, </em><em>column vectors are the basis vectors.</em>) – … If given, the basis vectors are used to span the crosss section.
… The basis vectors may be rotated or converted to right-handed at the end.
…</p></li>
<li><p><strong>apply_convention</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it enforces the new basis to follow the convention</em><em> (</em><em>right-handed etc.</em><em>)</em>) – </p></li>
<li><p><strong>u_basis</strong> (<em>str</em><em>, </em><em>default: &quot;npq&quot;</em><em>, </em><em>options: &quot;npq&quot;</em><em>, </em><em>&quot;xyz&quot; / &quot;standard&quot; &quot;std&quot;</em><em>, </em><em>&quot;both&quot;</em>) – <p>… the basis used to represent a velocity field on the plane
… “npq”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (un, up, uq)</p>
<blockquote>
<div><dl class="simple">
<dt>(un, up, uq) = (velocity component parallel to the area vector,</dt><dd><p>vel comp parallel to the second basis vector p,
vel comp parallel to the second basis vector q)</p>
</dd>
</dl>
</div></blockquote>
<p>… “xyz”. “standard”, or “std”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (ux, uy, uz)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata_si_npq_basis</strong> (<em>udata in the npq basis on the plane spanned by the basis vectors p and q.</em>) – … its shape is (dim, height, width, duration) = (3, height, width, duration)
… udata_si_npq_basis[0, …] is velocity u cdot hat{n}
… udata_si_npq_basis[1, …] is velocity u cdot hat{p}
… udata_si_npq_basis[2, …] is velocity u cdot hat{q}</p></li>
<li><p><strong>pp</strong> (<em>2d nd array, p-grid</em>)</p></li>
<li><p><strong>qq</strong> (<em>2d nd array, q-grid</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.slice_udata_3d">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">slice_udata_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'npq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.slice_udata_3d" title="Permalink to this definition"></a></dt>
<dd><p>Returns a spatially 2D udata which is on the cross section of a volumetric data
… There are two ways to return the velocity field on the cross section.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>In the standard basis (xyz, i.e. ux, uy, uz)</p></li>
<li><dl class="simple">
<dt>In the NEW basis (which I call npq basis, i.e. un, up, uq)</dt><dd><p>the basis vector n is identical to the unit area vector of the cross section</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<dl>
<dt>… By default, this function returns a 2D velocity field in the NEW basis (npq) as well as its coordinates in the same basis.</dt><dd><p>… This is a natural choice since the cross section is spanned by the new basis vectors p and q.
… Any postional vector on the cross section is expresed by its linear combinations.</p>
<blockquote>
<div><p>r = c1 hat{p} + c2 hat{q}
(c1, c2) are the coordinates in the pq basis.
(Technically, the basis vectors are n, p, q but the coefficient of the n basis vector is always zero on the cross section.)
By default, this function returns…
1. velocity field in the NEW basis (npq) on the cross section
2. Coordinates in the pq basis (technically npq basis, but the coordinate in the basis vector n is always zero so I don’t return it)</p>
</div></blockquote>
</dd>
<dt>… You CAN retrieve the velocity field in the standard basis (xyz, i.e. ux, uy, uz).</dt><dd><p>Just set “u_basis” equal to “xyz”
If you want both (in npq and xyz basses), set  “u_basis” as “both”</p>
</dd>
<dt>… If you want a change-of-basis matrix from basis A to basis B, use ilpm.vector.get_change_of_basis_matrix(basisA, basisB)</dt><dd><dl class="simple">
<dt>e.g.</dt><dd><p>Mab = vec.get_change_of_basis_matrix(basis_xyz, basis_npq) # transformation matrix from xyz coords to npq coords
Mba = np.linalg.inv(Mab) # the change-of-basis matrix is ALWAYS unitary.</p>
</dd>
</dl>
</dd>
<dt>… e.g. You want a v-field on a slice whose normal vector is obtained by rotating the unit z vector rotated by +45 degrees</dt><dd><p>theta = np.pi/180.*-45 # Convert degrees to rad
n = [np.cos(theta), np.sin(theta), 0] # This is the normal vector of the slice
pt = [0, 0, 0] # A point on the slice
# Providing the new basis (npq basis) is optional
# but this helps to speed up the process to find all available points on the slice
basis = np.asarray([n, [0, 0, 1], [np.sin(theta), -np.cos(theta), 0]]).T # The transpose is necessary
vdata, pp, qq = vel.slice_udata_3d(udata, xxx, yyy, zzz, n, pt, basis=basis, show=True)
enst = vel.get_enstrophy(vdata[1:, …], xx=pp, yy=qq)
graph.color_plot(pp, qq, enst[…, 0], fignum=1+i)</p>
</dd>
<dt>… e.g. get a v-field on the xy plane (z=0)</dt><dd><p>n = [0, 0, 1] # area vector // unit z vector
pt = [0, 0, 0] # the plane contains the origin
basis = np.asarray([n, [1, 0, 0], [0, 1, 0]]).T
vdata, pp, qq = vel.slice_udata_3d(udata, xxx, yyy, zzz, n, pt, basis=basis, show=True)
enst = vel.get_enstrophy(vdata[1:, …], xx=pp, yy=qq)
graph.color_plot(pp, qq, enst[…, 0], fignum=1+i)</p>
</dd>
<dt>… e.g. Get a slice whose normal vector gets rotated about the y-axis gradually</dt><dd><p>t = 0 # slice the udata in the 1st frame
thetas = np.linspace(0, 2*np.pi, 101)
for i, theta in enumerate(thetas):</p>
<blockquote>
<div><p>n = [np.sin(theta), 0, np.cos(theta)]
vdata, pp, qq = vel.slice_udata_3d(udata[…, t], xxx, yyy, zzz, n, [xc, yc, zc],</p>
<blockquote>
<div><p>basis = np.asarray([n, [np.cos(theta), 0, -np.sin(theta)], [0, 1, 0]]).T,
apply_convention=False)</p>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
<p>Example:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>spatially 3d udata</em><em> (</em><em>4D</em><em> or </em><em>5D array</em><em>) </em><em>with shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>, </em><em>duration</em><em>) or  </em><em>(</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>grid of x-coordinate</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>grid of y-coordinate</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>grid of z-coordinate</em>) – </p></li>
<li><p><strong>n</strong> (<em>1d array-like</em><em>, </em><em>area vector</em><em> (</em><em>it does not have to be normalized</em><em>)</em>) – </p></li>
<li><p><strong>pt</strong> (<em>1d array-like</em><em>, </em><em>xyz coordinates of a point on the plane</em><em> (</em><em>Note that n and pt uniquely defines a plane</em><em>)</em>) – </p></li>
<li><p><strong>spacing</strong> (<em>float</em><em>, </em><em>must be greater than 0. Sampling spatial resolution on the plane</em>) – </p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>tflow.graph</em><em> or </em><em>takumi.graph is required. If True</em><em>, </em><em>it will automatically plot the sampled points on the</em>) – cross section in a 3D view as well as the new basis vectors</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>interpolation method of udata</em><em>, </em><em>options: 'nn'</em><em>, </em><em>'localmean'</em><em>, </em><em>'idw'</em>) – … volumetric udata may contain lots of np.nan, and cleaning udata often results better results.
… ‘nn’: nearest neighbor filling
… ‘localmean’: filling using a direct covolution (inpainting with a neighbor averaging kernel)
… ‘idw’: filling using a direct covolution (inpainting with a Gaussian kernel)</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>basis</strong> (<em>3x3 matrix</em><em>, </em><em>column vectors are the basis vectors.</em>) – … If given, these basis vectors are used to span the crosss section.
… The basis vectors may be rotated or converted to be right-handed at the end.
… See the example above for a sample input</p></li>
<li><p><strong>apply_convention</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it enforces the new basis to follow a convention that is</em>) – … right-handed (n x p // q)</p></li>
<li><p><strong>u_basis</strong> (<em>str</em><em>, </em><em>default: &quot;npq&quot;</em><em>, </em><em>options: &quot;npq&quot;</em><em>, </em><em>&quot;xyz&quot; / &quot;standard&quot; &quot;std&quot;</em><em>, </em><em>&quot;both&quot;</em>) – <p>… the basis used to represent a velocity field on the plane
… “npq”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (un, up, uq)</p>
<blockquote>
<div><dl class="simple">
<dt>(un, up, uq) = (velocity component parallel to the area vector,</dt><dd><p>vel comp parallel to the second basis vector p,
vel comp parallel to the second basis vector q)</p>
</dd>
</dl>
</div></blockquote>
<p>… “xyz”. “standard”, or “std”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (ux, uy, uz)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata_si_npq_basis</strong> (<em>udata in the npq basis on the plane spanned by the basis vectors p and q.</em>) – … its shape is (dim, height, width, duration) = (3, height, width, duration)
… udata_si_npq_basis[0, …] is velocity u cdot hat{n}
… udata_si_npq_basis[1, …] is velocity u cdot hat{p}
… udata_si_npq_basis[2, …] is velocity u cdot hat{q}</p></li>
<li><p><strong>pp</strong> (<em>2d nd array, p-grid</em>)</p></li>
<li><p><strong>qq</strong> (<em>2d nd array, q-grid</em>) – … plt.quiver(pp, qq, udata_si_npq_basis[1, …, 0], udata_si_npq_basis[2, …, 0])</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.slice_udata_3d_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">slice_udata_3d_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'npq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.slice_udata_3d_old" title="Permalink to this definition"></a></dt>
<dd><p>Returns a spatially 2D udata which is on the cross section of a volumetric data
… There are two ways to return the velocity field on the cross section.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>In the standard basis (xyz, i.e. ux, uy, uz)</p></li>
<li><dl class="simple">
<dt>In the NEW basis (which I call npq basis, i.e. un, up, uq)</dt><dd><p>the basis vector n is identical to the unit area vector of the cross section</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<dl>
<dt>… By default, this function returns a 2D velocity field in the NEW basis (npq) as well as its coordinates in the same basis.</dt><dd><p>… This is a natural choice since the cross section is spanned by the new basis vectors p and q.
… Any postional vector on the cross section is expresed by its linear combinations.</p>
<blockquote>
<div><p>r = c1 hat{p} + c2 hat{q}
(c1, c2) are the coordinates in the pq basis.
(Technically, the basis vectors are n, p, q but the coefficient of the n basis vector is always zero on the cross section.)
By default, this function returns…
1. velocity field in the NEW basis (npq) on the cross section
2. Coordinates in the pq basis (technically npq basis, but the coordinate in the basis vector n is always zero so I don’t return it)</p>
</div></blockquote>
</dd>
<dt>… You CAN retrieve the velocity field in the standard basis (xyz, i.e. ux, uy, uz).</dt><dd><p>Just set “u_basis” equal to “xyz”
If you want both (in npq and xyz basses), set  “u_basis” as “both”</p>
</dd>
<dt>… If you want a change-of-basis matrix from basis A to basis B, use ilpm.vector.get_change_of_basis_matrix(basisA, basisB)</dt><dd><dl class="simple">
<dt>e.g.</dt><dd><p>Mab = vec.get_change_of_basis_matrix(basis_xyz, basis_npq) # transformation matrix from xyz coords to npq coords
Mba = np.linalg.inv(Mab) # the change-of-basis matrix is ALWAYS unitary.</p>
</dd>
</dl>
</dd>
<dt>… e.g. You want a v-field on a slice whose normal vector is obtained by rotating the unit z vector rotated by +45 degrees</dt><dd><p>theta = np.pi/180.*-45 # Convert degrees to rad
n = [np.cos(theta), np.sin(theta), 0] # This is the normal vector of the slice
pt = [0, 0, 0] # A point on the slice
# Providing the new basis (npq basis) is optional
# but this helps to speed up the process to find all available points on the slice
basis = np.asarray([n, [0, 0, 1], [np.sin(theta), -np.cos(theta), 0]]).T # The transpose is necessary
vdata, pp, qq = vel.slice_udata_3d(udata, xxx, yyy, zzz, n, pt, basis=basis, show=True)
enst = vel.get_enstrophy(vdata[1:, …], xx=pp, yy=qq)
graph.color_plot(pp, qq, enst[…, 0], fignum=1+i)</p>
</dd>
<dt>… e.g. get a v-field on the xy plane (z=0)</dt><dd><p>n = [0, 0, 1] # area vector // unit z vector
pt = [0, 0, 0] # the plane contains the origin
basis = np.asarray([n, [1, 0, 0], [0, 1, 0]]).T
vdata, pp, qq = vel.slice_udata_3d(udata, xxx, yyy, zzz, n, pt, basis=basis, show=True)
enst = vel.get_enstrophy(vdata[1:, …], xx=pp, yy=qq)
graph.color_plot(pp, qq, enst[…, 0], fignum=1+i)</p>
</dd>
<dt>… e.g. Get a slice whose normal vector gets rotated about the y-axis gradually</dt><dd><p>t = 0 # slice the udata in the 1st frame
thetas = np.linspace(0, 2*np.pi, 101)
for i, theta in enumerate(thetas):</p>
<blockquote>
<div><p>n = [np.sin(theta), 0, np.cos(theta)]
vdata, pp, qq = vel.slice_udata_3d(udata[…, t], xxx, yyy, zzz, n, [xc, yc, zc],</p>
<blockquote>
<div><p>basis = np.asarray([n, [np.cos(theta), 0, -np.sin(theta)], [0, 1, 0]]).T,
apply_convention=False)</p>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
<p>Example:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>spatially 3d udata</em><em> (</em><em>4D</em><em> or </em><em>5D array</em><em>) </em><em>with shape</em><em> (</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>, </em><em>duration</em><em>) or  </em><em>(</em><em>dim</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>depth</em><em>)</em>) – </p></li>
<li><p><strong>xx</strong> (<em>3d array</em><em>, </em><em>grid of x-coordinate</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d array</em><em>, </em><em>grid of y-coordinate</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d array</em><em>, </em><em>grid of z-coordinate</em>) – </p></li>
<li><p><strong>n</strong> (<em>1d array-like</em><em>, </em><em>area vector</em><em> (</em><em>it does not have to be normalized</em><em>)</em>) – </p></li>
<li><p><strong>pt</strong> (<em>1d array-like</em><em>, </em><em>xyz coordinates of a point on the plane</em><em> (</em><em>Note that n and pt uniquely defines a plane</em><em>)</em>) – </p></li>
<li><p><strong>spacing</strong> (<em>float</em><em>, </em><em>must be greater than 0. Sampling spatial resolution on the plane</em>) – </p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>tflow.graph</em><em> or </em><em>takumi.graph is required. If True</em><em>, </em><em>it will automatically plot the sampled points on the</em>) – cross section in a 3D view as well as the new basis vectors</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>interpolation method of udata</em><em>, </em><em>options: 'nn'</em><em>, </em><em>'localmean'</em><em>, </em><em>'idw'</em>) – … volumetric udata may contain lots of np.nan, and cleaning udata often results better results.
… ‘nn’: nearest neighbor filling
… ‘localmean’: filling using a direct covolution (inpainting with a neighbor averaging kernel)
… ‘idw’: filling using a direct covolution (inpainting with a Gaussian kernel)</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>parameter for replacng nans in udata clean_udata</em><em>(</em><em>)</em>) – </p></li>
<li><p><strong>basis</strong> (<em>3x3 matrix</em><em>, </em><em>column vectors are the basis vectors.</em>) – … If given, these basis vectors are used to span the crosss section.
… The basis vectors may be rotated or converted to be right-handed at the end.
… See the example above for a sample input</p></li>
<li><p><strong>apply_convention</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it enforces the new basis to follow a convention that is</em>) – … right-handed (n x p // q)</p></li>
<li><p><strong>u_basis</strong> (<em>str</em><em>, </em><em>default: &quot;npq&quot;</em><em>, </em><em>options: &quot;npq&quot;</em><em>, </em><em>&quot;xyz&quot; / &quot;standard&quot; &quot;std&quot;</em><em>, </em><em>&quot;both&quot;</em>) – <p>… the basis used to represent a velocity field on the plane
… “npq”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (un, up, uq)</p>
<blockquote>
<div><dl class="simple">
<dt>(un, up, uq) = (velocity component parallel to the area vector,</dt><dd><p>vel comp parallel to the second basis vector p,
vel comp parallel to the second basis vector q)</p>
</dd>
</dl>
</div></blockquote>
<p>… “xyz”. “standard”, or “std”: It returns velocity vectors in the npq basis. Returning udata[i, …] = (ux, uy, uz)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>udata_si_npq_basis</strong> (<em>udata in the npq basis on the plane spanned by the basis vectors p and q.</em>) – … its shape is (dim, height, width, duration) = (3, height, width, duration)
… udata_si_npq_basis[0, …] is velocity u cdot hat{n}
… udata_si_npq_basis[1, …] is velocity u cdot hat{p}
… udata_si_npq_basis[2, …] is velocity u cdot hat{q}</p></li>
<li><p><strong>pp</strong> (<em>2d nd array, p-grid</em>)</p></li>
<li><p><strong>qq</strong> (<em>2d nd array, q-grid</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.slicer">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">slicer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.slicer" title="Permalink to this definition"></a></dt>
<dd><p>Returns coordinates on a slice of a volume at a given point</p>
<p>… basisA: Cartesian basis of the volume
… basisB: npq basis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xxx</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>Ny</em><em>, </em><em>Nx</em><em>, </em><em>Nz</em><em>)</em><em>, </em><em>x-coordinates of the volume</em>) – </p></li>
<li><p><strong>yyy</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>Ny</em><em>, </em><em>Nx</em><em>, </em><em>Nz</em><em>)</em><em>, </em><em>y-coordinates of the volume</em>) – </p></li>
<li><p><strong>zzz</strong> (<em>nd array</em><em>, </em><em>shape</em><em> (</em><em>Ny</em><em>, </em><em>Nx</em><em>, </em><em>Nz</em><em>)</em><em>, </em><em>z-coordinates of the volume</em>) – </p></li>
<li><p><strong>n</strong> (<em>tuple/list/1darray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>normal vector of the plane</em><em> (</em><em>nx</em><em>, </em><em>ny</em><em>, </em><em>nz</em><em>)</em>) – </p></li>
<li><p><strong>pt</strong> (<em>tuple/list/1darray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>point on the plane</em><em> (</em><em>x</em><em>, </em><em>y</em><em>, </em><em>z</em><em>)</em>) – </p></li>
<li><p><strong>basis</strong> (<em>3x3 array</em><em>, </em><em>default None</em><em>, </em><em>new basis</em>) – … the new basis vectors are normal vector of the plane (n) and two orthogonal vectors (p, q) on the plane
… the column vectors are the new basis vectors: [n, p, q]
… If p, and q are specified, theses vectors are used to span the plane.</p></li>
<li><p><strong>spacing</strong> (<em>float</em><em>, </em><em>spacing between points spanned on the plane</em>) – </p></li>
<li><p><strong>notebook</strong> (<em>bool</em><em>, </em><em>default True</em>) – … if True, the tqdm_notebook is used instead of tqdm to show progress</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xxp</strong> (<em>3d array, shape (Ny, Nx, Nz), x-coordinates of the slice</em>)</p></li>
<li><p><strong>yyp</strong> (<em>3d array, shape (Ny, Nx, Nz), y-coordinates of the slice</em>)</p></li>
<li><p><strong>zzp</strong> (<em>3d array, shape (Ny, Nx, Nz), z-coordinates of the slice</em>)</p></li>
<li><p><strong>pp</strong> (<em>2d array, p-coordinates of the slice</em>)</p></li>
<li><p><strong>qq</strong> (<em>2d array, q-coordinates of the slice</em>)</p></li>
<li><p><strong>Mab</strong> (<em>3x3 array, change-of-basis matrix from basisA to basisB</em>) – … np.matmul(Mab, vector_in_basiaA) = vector_in_basisB</p></li>
<li><p><strong>Mba</strong> (<em>3x3 array, change-of-basis matrix from basisB to basisA</em>) – … np.matmul(Mba, vector_in_basisB) = vector_in_basisA</p></li>
<li><p><strong>basis_npq</strong> (<em>3x3 array, basisB (npq basis)</em>) – … the column vectors are the new basis vectors: [n, p, q]
… If p and q were not specified, this code randomly generates orthogonal basis to span the plane.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.slicer_old">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">slicer_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.slicer_old" title="Permalink to this definition"></a></dt>
<dd><p>DEPRICATED (this slicer function uses a brute-force approach. Use slicer() instead.</p>
<p>Samples points on the cross section of a volume defined by 3D grid (xx, yy, zz) in two different bases and transformation matrices
… The area vector (normal to the cross section) and a point on the cross section must be supplied.
… It returns xs, ys, zs, ps, qs, ns, Mac, Mca, basisC
(xyz coordinates, coordinates in a different basis, transformation matrices, the new basis)</p>
<dl>
<dt>Details:</dt><dd><p>Cartesian coordinates use a standard basis (e1, e2, e3).
This is not a natural basis for an arbitrary cross section of a cuboid since it is a 2d field embedded in 3d!
Hence, a new basis should be created to extract a 2d slice of a volumetric data.
We denote the coordinates of the pts in the new basis (n, p, q). The first basis vector is a unit area vector of the cross section.
This basis is orthonormal by construction, and the transformation between the bases is unitary (i.e. length conserving)
This way, the final outputs are literally the pts on the cross section of a cuboid.</p>
</dd>
<dt>How it works:</dt><dd><ol class="arabic simple">
<li><p>Create an arbitrary orthonormal basis, one of which is a unit area vector given by you</p></li>
<li><p>Find points which are intersections of the plane and the cuboid</p></li>
</ol>
<p>3. Using the intersecting points and the constructed basis (BasisB), it figures out how much the basis vectors need to
span to cover the entire cross section
4. It samples points within the bounds set by Step 3. (This could take seconds)
5. The basis vectors (of basisB) are not usually aligned with the direction along the longest direction of the cross section.
Fix the basis vector directions based on the sampled points. The new basis is called basisC.
6. Get a change-of-basis matrix from ilpm.vec or tflow.vec between the standard basis (basisA) and basisC
7. Apply conventions on the basisC.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>The diretion with a LONGER side of the cross section is always called p.</p></li>
<li><p>The direction of increase in p is the same direction as x. (The same goes for q and y)</p></li>
<li><p>Enforce the basisC to be right-handed. n x p  = q</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Transform the xyz coordinates into npq coordinates using the matrix obtained in Step 6</p></li>
<li><p>Return xyz coordinates and npq coordinates and tranformation matrices (Mac: change-of-basis matrix FROM basisA to basisC)</p></li>
</ol>
</dd>
<dt>NEW (Dec 2022):</dt><dd><p>Efficient algorithm:</p>
</dd>
</dl>
<p>e.g.
1.</p>
<blockquote>
<div><p># xx, yy, zz = get_equally_spaced_grid(udata_stb) # if you have 3D udata
x, y, z = np.arange(50), np.arange(30), np.arange(40)
xx, yy, zz = np.meshgrid(y, x, z)</p>
<p>n = [0.1, -0.1, 0.4] # Area vector (x, y, z)
pt = [0, 0, 10] # Cartesian coordinates of a point which lives on the plane (x, y, z)
xs, ys, zs, ps, qs, ns, Mac, Mca, basis = slicer(xx, yy, zz, n, pt, show=False)
plt.scatter(ps, qs)</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p># Get a different point on the cross section in xyz
pt_a = np.asarray([0, -10, 20]) # xyz coordinate of a point
pt_c = np.matmul(Mac, pt_a) # npq coordinate of the same point
new_pt_c = pt_c + basis[:, 1] * 2.5 + basis[:, 2] * -4 # another point on the cross seciton but in basisC
new_pt_a = np.matmul(Mca, new_pt_c) # xyz coordinate of the new point</p></li>
<li><p># Get different points on the cross section in xyz
pts_a = np.asarray([0, -10, 20], [-2, -11, 26]).T # xyz coordinate of a point- Shape must be (3, m)
pts_c = np.matmul(Mac, pts_a) # npq coordinate of the same point
new_pts_c = pts_c * 0.5 # points on the cross seciton but in basisC
new_pts_a = np.matmul(Mca, new_pts_c) # xyz coordinate of the new points</p></li>
</ol>
<dl class="simple">
<dt>Tips:</dt><dd><p>If you have Takumi’s plotting module (found at takumi.graph or takumi’s github, or ask takumi)
one can easily visualize the cross section by uncommenting the sections in the function AND setting “show=True”.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>3d numpy array</em><em>, </em><em>x coordinates of udata is assumed</em>) – </p></li>
<li><p><strong>yy</strong> (<em>3d numpy array</em><em>, </em><em>y coordinates of udata is assumed</em>) – </p></li>
<li><p><strong>zz</strong> (<em>3d numpy array</em><em>, </em><em>z coordinates of udata is assumed</em>) – </p></li>
<li><p><strong>n</strong> (<em>1d array-like</em><em>, </em><em>area vector in the standard basis</em><em> (</em><em>no need to be normalized</em><em>)</em>) – </p></li>
<li><p><strong>pt</strong> (<em>1d array-like</em><em>, </em><em>a Cartesian coordinate of a point which lives on the cross section</em><em> (</em><em>x</em><em>, </em><em>y</em><em>, </em><em>z</em><em>)</em>) – </p></li>
<li><p><strong>basis</strong> (<em>1d array-like</em><em>, </em><em>use a user-specified basis instead of a randomly created orthonormal basis for basisB</em>) – … I do not recommend passing a basis unless there is a reason such as repeatability.
This might give you unexpected errors.</p></li>
<li><p><strong>spacing</strong> (<em>float</em><em>, </em><em>value must be greater than 0. Spatial resolution of the sampled grid. If None</em><em>, </em><em>it uses the spacing of xx</em>) – </p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it plots sampled points on the cross section as well as a cuboid</em><em> (</em><em>in a wire frame</em><em>) </em><em>both in 3D and 2D.</em>) – … You must have Takumi’s latest plotting module to work. This is not absolute dependencies for public version.
Therefore, ask Takumi to how to activate it.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>for developers</em>) – … If True, it prints the basisB and basisC at the end of the code.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xs, ys, zs, npq_coords[1,</strong> (<em>], npq_coords[2, :], npq_coords[0, :], Mac, Mca, basisC</em>)</p></li>
<li><p><em>… Cartesian coordinats of points on the cross section defined by its normal vector and a containing point</em></p></li>
<li><p><em>… New coordinates (n, p, q)- for usefulness, the function outputs in order of (p, q, n). n should be always zero.</em></p></li>
<li><p><em>You should print out the values of n whenever you are in doubt.</em></p></li>
<li><p><strong>… Mac</strong> (<em>change-of-basis matrix from basis A (standard basis) to basisC</em>)</p></li>
<li><p><strong>… Mca</strong> (<em>change-of-basis matrix from basis C to basis A (standard basis)- inverse of Mac</em>)</p></li>
<li><p><strong>… basisC</strong> (<em>new basis for npq coordinates</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.smooth">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.smooth" title="Permalink to this definition"></a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with a given signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>the input signal</em>) – </p></li>
<li><p><strong>window_len</strong> (<em>the dimension of the smoothing window; should be an odd integer</em>) – </p></li>
<li><p><strong>window</strong> (<em>the type of window from 'flat'</em><em>, </em><em>'hanning'</em><em>, </em><em>'hamming'</em><em>, </em><em>'bartlett'</em><em>, </em><em>'blackman'</em>) – flat window will produce a moving average smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>the smoothed signal</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>t=linspace(-2,2,0.1)
x=sin(t)+randn(len(t))*0.1
y=smooth(x)</p>
<p>see also:</p>
<p>numpy.hanning, numpy.hamming, numpy.bartlett, numpy.blackman, numpy.convolve
scipy.signal.filter</p>
<p>TODO: the window parameter could be the window itself if an array instead of a string
NOTE: length(output) != length(input), to correct this: return y[(window_len/2-1):-(window_len/2)] instead of just y.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.smoothAlongAxis">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">smoothAlongAxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.smoothAlongAxis" title="Permalink to this definition"></a></dt>
<dd><p>Takes a 2D array, returns a smooth array along a axis using a specified kernel</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.sort_n_arrays_using_order_of_first_array">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">sort_n_arrays_using_order_of_first_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">list_of_arrays</span></em>, <em class="sig-param"><span class="pre">element_dtype=&lt;class</span> <span class="pre">'tuple'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.sort_n_arrays_using_order_of_first_array" title="Permalink to this definition"></a></dt>
<dd><p>Sort a list of N arrays by the order of the first array in the list
e.g. a=[2,1,3], b=[1,9,8], c=[‘a’, ‘b’, ‘c’]</p>
<blockquote>
<div><p>[a, b, c] -&gt; [(1, 2, 3), (9, 1, 8), (‘b’, ‘a’, ‘c’)]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_of_arrays</strong> (<em>a list of lists/1D-arrays</em>) – </p></li>
<li><p><strong>element_dtype</strong> (<em>data type</em><em>, </em><em>default: tuple</em>) – <p>… This argument specifies the data type of the elements in the returned list
… The default data type of the element is tuple because this functon utilizes sorted(zip(…))
… E.g. element_dtype=np.ndarray</p>
<blockquote>
<div><dl class="simple">
<dt>-&gt; [a, b, c] -&gt; [np.array([1, 2, 3]),</dt><dd><p>np.array([9, 1, 8],
np.array([‘b’, ‘a’, ‘c’], dtype=’&lt;U1’]</p>
</dd>
</dl>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>list_of_sorted_arrays</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of sorted lists/1D arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.sph2cart">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">sph2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.sph2cart" title="Permalink to this definition"></a></dt>
<dd><p>Transformation from spherical to cartesian coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>radial distance</em>) – </p></li>
<li><p><strong>theta</strong> (<em>polar angle</em><em> [</em><em>-pi/2</em><em>, </em><em>pi/2</em><em>] </em><em>(</em><em>angle from the z-axis</em><em>)</em>) – </p></li>
<li><p><strong>phi</strong> (<em>azimuthal angle</em><em> [</em><em>-pi</em><em>, </em><em>pi</em><em>] </em><em>(</em><em>angle on the x-y plane</em><em>)</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float</em><em>, </em><em>origin at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float</em><em>, </em><em>origin at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
<li><p><strong>zc</strong> (<em>float</em><em>, </em><em>origin at</em><em> (</em><em>xc</em><em>, </em><em>yc</em><em>, </em><em>zc</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x, y, z</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cartesian coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.sph2cart_velocity">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">sph2cart_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uphi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pphi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.sph2cart_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Transformation: spherical to cartesian (r, theta, phi, (ur, utheta, uphi)) -&gt; (x, y, (ux, uy, uz))</p>
<p>z = r cos theta
y = r sin theta sin phi
x = r sin theta cos phi</p>
<p>Spherical coorrdinates:
(r, theta, phi) = (radial distance, polar angle, azimuthal angle)
r: radius
theta: polar angle [-pi/2, pi/2] (angle from the z-axis)
phi: azimuthal angle [-pi, pi] (angle on the x-y plane)</p>
<p><a class="reference external" href="http://www.astrosurf.com/jephem/library/li110spherCart_en.htm">http://www.astrosurf.com/jephem/library/li110spherCart_en.htm</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ur</strong> (<em>numpy array</em><em>, </em><em>radial component of velocity field in the spherical basis</em>) – </p></li>
<li><p><strong>utheta</strong> (<em>numpy array</em><em>, </em><em>polar component of velocity field in the spherical basis</em>) – </p></li>
<li><p><strong>uphi</strong> (<em>numpy array</em><em>, </em><em>azimuthal component of velocity field in the spherical basis</em>) – </p></li>
<li><p><strong>ttheta</strong> (<em>numpy array</em><em>, </em><em>polar angle</em><em> [</em><em>-pi/2</em><em>, </em><em>pi/2</em><em>] </em><em>(</em><em>angle from the z-axis</em><em>)</em>) – </p></li>
<li><p><strong>pphi</strong> (<em>numpy array</em><em>, </em><em>azimuthal angle</em><em> [</em><em>-pi</em><em>, </em><em>pi</em><em>] </em><em>(</em><em>angle on the x-y plane</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ux</strong> (<em>numpy array, x-component of velocity field (Cartesian)</em>)</p></li>
<li><p><strong>uy</strong> (<em>numpy array, y-component of velocity field (Cartesian)</em>)</p></li>
<li><p><strong>uz</strong> (<em>numpy array, z-component of velocity field (Cartesian)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.square_udata">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">square_udata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.square_udata" title="Permalink to this definition"></a></dt>
<dd><p>Pad zeros to udata to make its spatial dimensions into a square or a cube
… Taking a spectrum of a rectangularly shaped array could cause further aliasing. In order to combat this, one may square/cubidize
udata before taking the spectrum by padding zeros around the obtained field.
:param udata:
:param pad_value:
:type pad_value: float, value used to pad udata</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>squared_udata_padded_with_zero</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.suggest_name2write">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">suggest_name2write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.suggest_name2write" title="Permalink to this definition"></a></dt>
<dd><p>Returns a new filepath with a version number if a file with a given path already exists.
Otherwise, it returns the given string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>newfilepath</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>new filepath with a version number if the file already exists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.suggest_udata_dim2load">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">suggest_udata_dim2load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_tuple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_None</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.suggest_udata_dim2load" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of inds = {“x0”: x0, “x1”: x1, “y0”: y0, “y1”: y1, “z0”: z0, “z1”: z1}
which can be used to load udata via get_udata_from_path(…, <a href="#id19"><span class="problematic" id="id20">**</span></a>inds)
… Estimating a reasonable volume for analysis is crucial to reduce the computation time since inpainting data is the
rate-limiting step most of the time.
… Estimating the reasonable volume in udata is done by counting the number of nans in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpath</strong> (<em>str</em><em>, </em><em>path to a udata</em><em> (</em><em>h5</em><em>)</em>) – </p></li>
<li><p><strong>p</strong> (<em>...</em><em> The higher</em>) – </p></li>
<li><p><strong>domain</strong> (<em>...</em>) – </p></li>
<li><p><strong>p</strong> – … usually, STB-generated udata contains slices with all nans along z.
… You do not want to inpaint this!
… So keep p around 1 to be reasonable.</p></li>
<li><p><strong>volume.</strong> (<em>it returns a bigger</em>) – … usually, STB-generated udata contains slices with all nans along z.
… You do not want to inpaint this!
… So keep p around 1 to be reasonable.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of time slices used for the estimation</em><em>, </em><em>default: 5</em>) – </p></li>
<li><p><strong>usually</strong> (<em>...</em>) – </p></li>
<li><p><strong>much</strong> (<em>the nan distribution does not vary</em>) – </p></li>
<li><p><strong>slices</strong> (<em>so use only a couple of</em>) – </p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>default:True</em>) – </p></li>
<li><p><strong>True</strong> (<em>...</em><em> If</em>) – </p></li>
<li><p><strong>axis</strong> (<em>show nan distribution along each</em>) – </p></li>
<li><p><strong>return_tuple</strong> (<em>bool</em><em>, </em><em>default: False</em>) – </p></li>
<li><p><strong>(</strong><strong>x0</strong> (<em>...</em><em> If one wants</em>) – </p></li>
<li><p><strong>x1</strong> – </p></li>
<li><p><strong>y0</strong> – </p></li>
<li><p><strong>y1</strong> – </p></li>
<li><p><strong>z0</strong> – </p></li>
<li><p><strong>reason</strong> (<em>z1</em><em>) </em><em>instead of a dictionary for some</em>) – </p></li>
<li><p><strong>True.</strong> (<em>set this</em>) – </p></li>
<li><p><strong>Typically</strong> (<em>...</em>) – </p></li>
<li><p><strong>(</strong><strong>&quot;x0&quot;</strong> (<em>one likes to pass this information to a function with the kwargs</em>) – </p></li>
<li><p><strong>&quot;x1&quot;</strong> – </p></li>
<li><p><strong>etc.</strong><strong>)</strong> – </p></li>
</ul>
</dd>
</dl>
<p>:param :
:param so simply pass the default output (which is a dictionary) like <a href="#id21"><span class="problematic" id="id22">**</span></a>dictionary to unpack.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ind_dict</strong> – … ind_dict = {“x0”: x0, “x1”: x1, “y0”: y0, “y1”: y1, “z0”: z0, “z1”: z1}
… e.g.- get_udata_from_path(…, <a href="#id23"><span class="problematic" id="id24">**</span></a>ind_dict)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict, indices that can be used to load udata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.truncateXY">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">truncateXY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.truncateXY" title="Permalink to this definition"></a></dt>
<dd><p>Returns a truncated grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xxx</strong> (<em>2d array</em><em>, </em><em>x-coordinate</em>) – </p></li>
<li><p><strong>yyy</strong> (<em>2d array</em><em>, </em><em>y-coordinate</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index used to truncate a 2d array like xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index used to truncate a 2d array like xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index used to truncate a 2d array like xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index used to truncate a 2d array like xx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xx[y0</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y1, x0:x1], yy[y0:y1, x0:x1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.truncateXYZ">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">truncateXYZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.truncateXYZ" title="Permalink to this definition"></a></dt>
<dd><p>Returns a truncated grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xxx</strong> (<em>3d array</em><em>, </em><em>x-coordinate</em>) – </p></li>
<li><p><strong>yyy</strong> (<em>3d array</em><em>, </em><em>y-coordinate</em>) – </p></li>
<li><p><strong>zzz</strong> (<em>3d array</em><em>, </em><em>z-coordinate</em>) – </p></li>
<li><p><strong>x0</strong> (<em>int</em><em>, </em><em>index used to truncate a 3d array like xxx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>]</em>) – </p></li>
<li><p><strong>x1</strong> (<em>int</em><em>, </em><em>index used to truncate a 3d array like xxx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>]</em>) – </p></li>
<li><p><strong>y0</strong> (<em>int</em><em>, </em><em>index used to truncate a 3d array like xxx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>]</em>) – </p></li>
<li><p><strong>y1</strong> (<em>int</em><em>, </em><em>index used to truncate a 3d array like xxx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>]</em>) – </p></li>
<li><p><strong>z0</strong> (<em>int</em><em>, </em><em>index used to truncate a 3d array like xxx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>]</em>) – </p></li>
<li><p><strong>z1</strong> (<em>int</em><em>, </em><em>index used to truncate a 3d array like xxx</em><em>[</em><em>y0:y1</em><em>, </em><em>x0:x1</em><em>, </em><em>z0:z1</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xxx[y0</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y1, x0:x1, z0:z1], yyy[y0:y1, x0:x1, z0:z1], zzz[y0:y1, x0:x1, z0:z1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.write_hdf5_dict">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">write_hdf5_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datadict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.write_hdf5_dict" title="Permalink to this definition"></a></dt>
<dd><p>Writes data in data_dict = {‘varname0’: var0, ‘varname1’: var1, …} to a h5 file
- A quick function to write multiple data to a h5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – … file path where data will be stored. (Do not include extension- .h5)</p></li>
<li><p><strong>datadict</strong> (<em>dict</em><em>, </em><em>a collection of data to be stored in the h5 file</em>) – <p>… data_dict = {‘varname0’: var0, ‘varname1’: var1, …}
… data will be stored in the h5 file under the group /varname0, /varname1, …</p>
<blockquote>
<div><p>and can be accessed by
… with h5py.File(filepath, mode=’r’):</p>
<blockquote>
<div><p>data = hf[key][:]</p>
</div></blockquote>
</div></blockquote>
</p></li>
<li><p><strong>attrdict</strong> (<em>dict</em><em>, </em><em>default: None</em><em>, </em><em>metadata of the data</em>) – <p>… Attributes of data to be stored in the h5 file
… Organize the attributes of a variable like this:</p>
<blockquote>
<div><p>attrdict = {‘varname0’: {‘attr0’: value0, ‘attr1’: value1, …}, …}
… attrdict = {‘piv000’: {‘int_win’: 32, ‘date’: 01012020, ‘software’: ‘DaVis’},</p>
<blockquote>
<div><p>’piv001’: {‘int_win’: 16, ‘date’: 01012020, ‘software’: ‘PIVLab’},
…}</p>
</div></blockquote>
</div></blockquote>
</p></li>
<li><p><strong>bool</strong> (<em>overwrite</em><em>, </em><em>default: False</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … print where the data is stored</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.velocity.zoom">
<span class="sig-prename descclassname"><span class="pre">tflow.velocity.</span></span><span class="sig-name descname"><span class="pre">zoom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.velocity.zoom" title="Permalink to this definition"></a></dt>
<dd><p>A quick function to linearly interpolate 3D data by an integer factor
… xxx, yyy, zzz = np.meshgrid(x,y,z)
… Returns data and positional grids at different resolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qty</strong> (<em>3d array</em><em>, </em><em>a regular grid</em><em> (</em><em>data at</em><em> (</em><em>x</em><em>, </em><em>y</em><em>, </em><em>z</em><em>)</em>) – </p></li>
<li><p><strong>xxx</strong> (<em>3d array</em><em>, </em><em>a regular grid</em><em> (</em><em>x component of the position</em><em>)</em>) – </p></li>
<li><p><strong>yyy</strong> (<em>3d array</em><em>, </em><em>a regular grid</em><em> (</em><em>y component of the position</em><em>)</em>) – </p></li>
<li><p><strong>zzz</strong> (<em>3d array</em><em>, </em><em>a regular grid</em><em> (</em><em>z component of the position</em><em>)</em>) – </p></li>
<li><p><strong>zf</strong> (<em>float</em><em>, </em><em>(</em><em>positive real number</em><em>)</em>) – … a zoom factor</p></li>
<li><p><strong>bounds_error</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>qty_</strong> (<em>3d array, a regular grid (data at (x, y, z) at a higher resolution)</em>)</p></li>
<li><p><strong>xxx_</strong> (<em>3d array, a regular grid (x component of the position at a higher resolution)</em>)</p></li>
<li><p><strong>yyy_</strong> (<em>3d array, a regular grid (y component of the position at a higher resolution)</em>)</p></li>
<li><p><strong>zzz_</strong> (<em>3d array, a regular grid (z component of the position at a higher resolution)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="plotting-module">
<h2>Plotting module<a class="headerlink" href="#plotting-module" title="Permalink to this headline"></a></h2>
</section>
<section id="module-tflow.graph">
<span id="tflow-graph-module"></span><h2>tflow.graph module<a class="headerlink" href="#module-tflow.graph" title="Permalink to this headline"></a></h2>
<p>Module for plotting and saving figures</p>
<dl class="py class">
<dt class="sig sig-object py" id="tflow.graph.Arrow3D">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">Arrow3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.Arrow3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.patches.FancyArrowPatch</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.Arrow3D.draw">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">renderer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.Arrow3D.draw" title="Permalink to this definition"></a></dt>
<dd><p>Draw the Artist (and its children) using the given renderer.</p>
<p>This has no effect if the artist is not visible (<cite>.Artist.get_visible</cite>
returns False).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>renderer</strong> (<cite>.RendererBase</cite> subclass.) – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is overridden in the Artist subclasses.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tflow.graph.FormatScalarFormatter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">FormatScalarFormatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%03.1f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mathText</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.FormatScalarFormatter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.ticker.ScalarFormatter</span></code></p>
<p>Ad-hoc class to subclass matplotlib.ticker.ScalarFormatter
in order to alter the number of visible digits on color bars</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">LineDrawer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl>
<dt>Class which allows users to draw lines/splines by clicking pts on the plot</dt><dd><p>… Default: lines/splines are closed.
… make sure that matplotlib backend is interactive</p>
</dd>
<dt>Procedure for self.draw_lines() or self.draw_splines:</dt><dd><p>It uses plt.ginput()
1. Add a point by a left click
2. Remove a point by a right click
3. Stop interaction (move onto the next line to draw)</p>
</dd>
<dt>Example</dt><dd><p># Pass matplotlib.axes._subplots.AxesSubplot object whose coordinates are used for extracting pts
ld = LineDrawer(ax)</p>
<p># Draw lines/splines
ld.draw_lines(n=5) # Draw 5 lines (connecting 5 set of points)
# ld.draw_splines(n=2) # Or draw 2 splines based on the clicked points</p>
<p>xs, ys = ld.xs, ld.ys # Retrieve x and y coords of pts used to draw lines/splines
# xis, yis = ld.xis, ld.yis # Retrieve x and y coords for each spline</p>
<p># plot the first contour
plt.plot(xs[0], ys[0]</p>
<p># for example, I could feed this contour to compute a line integral using vel.compute_circulation()</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer.close" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer.draw_lines">
<span class="sig-name descname"><span class="pre">draw_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer.draw_lines" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer.draw_splines">
<span class="sig-name descname"><span class="pre">draw_splines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer.draw_splines" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer.get_contour">
<span class="sig-name descname"><span class="pre">get_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer.get_contour" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer.return_pts_on_splines">
<span class="sig-name descname"><span class="pre">return_pts_on_splines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer.return_pts_on_splines" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.LineDrawer.spline_fit">
<span class="sig-name descname"><span class="pre">spline_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.LineDrawer.spline_fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tflow.graph.PointFinder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">PointFinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.PointFinder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.PointFinder.find_local_center_of_mass">
<span class="sig-name descname"><span class="pre">find_local_center_of_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.PointFinder.find_local_center_of_mass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.PointFinder.get_local_center_of_mass">
<span class="sig-name descname"><span class="pre">get_local_center_of_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.PointFinder.get_local_center_of_mass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tflow.graph.PointFinder.get_pts">
<span class="sig-name descname"><span class="pre">get_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.PointFinder.get_pts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_arrow_to_line">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_arrow_to_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.2,</span> <span class="pre">0.4,</span> <span class="pre">0.6,</span> <span class="pre">0.8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_arrow_to_line" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_arrow_to_line2D">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_arrow_to_line2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.2,</span> <span class="pre">0.4,</span> <span class="pre">0.6,</span> <span class="pre">0.8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrowstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-|&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_arrow_to_line2D" title="Permalink to this definition"></a></dt>
<dd><p>Add arrows to a matplotlib.lines.Line2D at selected locations.</p>
<p>axes:
line: Line2D object as returned by plot command
arrow_locs: list of locations where to insert arrows, % of total length
arrowstyle: style of the arrow
arrowsize: size of the arrow
transform: a matplotlib transform instance, default to data coordinates</p>
<p>arrows: list of arrows</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_arrow_to_line3D">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_arrow_to_line3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.2,</span> <span class="pre">0.4,</span> <span class="pre">0.6,</span> <span class="pre">0.8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_arrow_to_line3D" title="Permalink to this definition"></a></dt>
<dd><p>Add arrows to a matplotlib.lines.Line2D at selected locations.</p>
<p class="rubric">Example</p>
<p># plotting
fig = plt.figure()
ax = fig.add_subplot(111, projection=’3d’)</p>
<p>x = np.linspace(0, 10, 11)
y = np.linspace(0, 10, 11)
z = np.zeros(11)
line, = ax.plot(x,y,z, alpha=1, lw=3, color=’k’)
add_arrow_to_line3D(ax, line, arrow_locs=np.linspace(0., 1., 5), alpha=0.3)</p>
<p>axes:
line: Line2D object as returned by plot command
arrow_locs: list of locations where to insert arrows, % of total length
arrowstyle: style of the arrow
arrowsize: size of the arrow
transform: a matplotlib transform instance, default to data coordinates</p>
<p>arrows: list of arrows</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_color_wheel">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_color_wheel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.54,</span> <span class="pre">7.54)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.68,</span> <span class="pre">0.65,</span> <span class="pre">0.2,</span> <span class="pre">0.2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmapname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">3.141592653589793,</span> <span class="pre">3.141592653589793]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2056</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Phase'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_loc_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_loc_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.3615041393410787</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_color_wheel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_colorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_colorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mappable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'5%'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caxAspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%03.1f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_colorbar" title="Permalink to this definition"></a></dt>
<dd><p>Adds a color bar</p>
<dl class="simple">
<dt>e.g.</dt><dd><p>fig = plt.figure()
img = fig.add_subplot(111)
ax = img.imshow(im_data)
colorbar(ax)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mappable</strong> – </p></li>
<li><p><strong>location</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_colorbar_alone">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_colorbar_alone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'5%'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_colorbar_alone" title="Permalink to this definition"></a></dt>
<dd><p>Add a colorbar to a figure without a mappable
… It creates a dummy mappable with given values</p>
<p>… LOCATION OF CAX
fig, ax = graph.set_fig(1, 111)
w, pad, size = 0.1, 0.05, 0.05
graph.add_colorbar_alone(ax, [0, 1], pad=float2pc(pad), size=float2pc(size), tight_layout=False)
graph.add_subplot_axes(ax, [1-w-(1-1/(1.+pad+size)), 0.8, w, 0.2])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Axes instance</em>) – </p></li>
<li><p><strong>values</strong> (<em>1D array-like- min and max values of values are found from this array</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>cmap instance</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>label of the color bar</em>) – </p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>fontsize of the label</em>) – </p></li>
<li><p><strong>option</strong> (<em>str</em><em>, </em><em>choose from 'normal' and 'scientific'</em>) – </p></li>
<li><p><strong>'scientific'</strong> (<em>...</em><em> if</em>) – </p></li>
<li><p><strong>1x10^exponent</strong> (<em>the color bar is shown in a scientific format like</em>) – </p></li>
<li><p><strong>fformat</strong> (<em>str</em><em>, </em><em>default: None equivalent to &quot;%03.1f&quot;</em>) – </p></li>
<li><p><strong>tight_layout</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>fig.tight_layout</em><em>(</em><em>) </em><em>is called.</em>) – </p></li>
<li><p><strong>ticklabelsize</strong> (<em>float</em>) – </p></li>
<li><p><strong>ticklabel</strong> (<em>1d array-like</em>) – </p></li>
<li><p><strong>aspect</strong> – </p></li>
<li><p><strong>it.</strong> (<em>...</em><em>  Adding a color bar may distort the aspect ratio. Fix</em>) – </p></li>
<li><p><strong>'equal'</strong> (<em>if aspect ==</em>) – ax.set_aspect(‘equal’)</p></li>
<li><p><strong>location</strong> – </p></li>
<li><p><strong>color</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cb</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_colorbar_old">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_colorbar_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mappable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_colorbar_old" title="Permalink to this definition"></a></dt>
<dd><p>Adds a color bar (Depricated. replaced by add_colorbar)
:param mappable:
:type mappable: image like QuadMesh object to which the color bar applies (NOT a plt.figure instance)
:param ax:
:type ax: Parent axes from which space for a new colorbar axes will be stolen
:param label:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_discrete_colorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_discrete_colorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_discrete_colorbar" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_secondary_xaxis">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_secondary_xaxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'top'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_secondary_xaxis" title="Permalink to this definition"></a></dt>
<dd><p>Adds a secondary x-axis at the top
… Must pass a pair of mapping functions between a current x and a new x</p>
<dl>
<dt>e.g.</dt><dd><dl class="simple">
<dt>def deg2rad(x):</dt><dd><p>return x * np.pi / 180</p>
</dd>
<dt>def rad2deg(x):</dt><dd><p>return x * 180 / np.pi</p>
</dd>
</dl>
<p>add_secondary_xaxis(ax, functions=(deg2rad, rad2deg))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>functions</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>secax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_secondary_yaxis">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_secondary_yaxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_secondary_yaxis" title="Permalink to this definition"></a></dt>
<dd><p>Adds a secondary yaxis at the top
… Must pass a pair of mapping functions between a current x and a new x</p>
<dl>
<dt>e.g.</dt><dd><dl class="simple">
<dt>def deg2rad(y):</dt><dd><p>return y * np.pi / 180</p>
</dd>
<dt>def rad2deg(y):</dt><dd><p>return y * 180 / np.pi</p>
</dd>
</dl>
<p>add_secondary_yaxis(ax, functions=(deg2rad, rad2deg))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>functions</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>secax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.add_subplot_axes">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">add_subplot_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axisbg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.add_subplot_axes" title="Permalink to this definition"></a></dt>
<dd><p>Creates a sub-subplot inside the subplot (ax)
rect: list, [x, y, width, height] e.g. rect = [0.2,0.2,0.7,0.7]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>rect</strong> (<em>list</em><em>, </em><em>[</em><em>x</em><em>, </em><em>y</em><em>, </em><em>width</em><em>, </em><em>height</em><em>]  </em><em>e.g. rect =</em><em> [</em><em>0.2</em><em>,</em><em>0.2</em><em>,</em><em>0.7</em><em>,</em><em>0.7</em><em>]</em>) – </p></li>
<li><p><strong>axisbg</strong> (<em>background color of the newly created axes object</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>subax, Axes class object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.addtext">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">addtext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text</span> <span class="pre">goes</span> <span class="pre">here'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npartition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.addtext" title="Permalink to this definition"></a></dt>
<dd><p>Adds text to a plot. You can specify the position where the texts will appear by ‘option’
| tl2    tc2    tr2 |
| tl     tc     tr  |
| tl3    tc3    tr3 |
|                   |
| cl2               |
| cl     cc     cr  |
| cl3               |
|                   |
| bl2           br2 |
| bl      bc    br  |
| bl3           br3 |</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>with a text</em>) – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>text</strong> – </p></li>
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>fontsize</strong> – </p></li>
<li><p><strong>color</strong> – </p></li>
<li><p><strong>option</strong> (<em>default locations</em>) – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>-------</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.adjust_colorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">adjust_colorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tick_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.adjust_colorbar" title="Permalink to this definition"></a></dt>
<dd><p>A helper to modify basic features of a matplotlib Colorbar object</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.apply_custom_cyclers">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">apply_custom_cyclers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['r',</span> <span class="pre">'b',</span> <span class="pre">'g',</span> <span class="pre">'y']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['-',</span> <span class="pre">'-',</span> <span class="pre">'-',</span> <span class="pre">'-']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['o',</span> <span class="pre">'o',</span> <span class="pre">'o',</span> <span class="pre">'o']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.apply_custom_cyclers" title="Permalink to this definition"></a></dt>
<dd><p>This is a simple example to apply a custom cyclers for particular plots.
… This simply updates the rcParams so one must call this function BEFORE ceration of the plots.
… e.g.</p>
<blockquote>
<div><p>fig, ax = set_fig(1, 111)
apply_custom_cyclers(ax, color=[‘r’, ‘b’, ‘g’, ‘y’])
ax.plot(x1, y1)
ax.plot(x2, y2)
…</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>mpl.axes.Axes instance</em>) – </p></li>
<li><p><strong>color</strong> (<em>list of strings</em><em>, </em><em>color</em>) – </p></li>
<li><p><strong>linewidths</strong> (<em>list of float values</em><em>, </em><em>linewidth</em>) – </p></li>
<li><p><strong>linestyles</strong> (<em>list of strings</em><em>, </em><em>linestyle</em>) – </p></li>
<li><p><strong>marker</strong> (<em>list of strings</em><em>, </em><em>marker</em>) – </p></li>
<li><p><strong>s</strong> (<em>list of float values</em><em>, </em><em>marker size</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.approximate_fraction">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">approximate_fraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.approximate_fraction" title="Permalink to this definition"></a></dt>
<dd><p>Return the fraction with the lowest denominator that differs
from x by no more than e.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.arrow">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">arrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.arrow" title="Permalink to this definition"></a></dt>
<dd><p>Adds an arrow on a canvas
… Specify an arrow by its starting point (x, y) and its direction (dx, dy)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>dx</strong> – </p></li>
<li><p><strong>dy</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>fig</strong> – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.arrow3D">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">arrow3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrowstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-|&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x</span> <span class="pre">(mm)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y</span> <span class="pre">(mm)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z</span> <span class="pre">(mm)'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.arrow3D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.axhband">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">axhband</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.axhband" title="Permalink to this definition"></a></dt>
<dd><p>Make a horizontal band between y0 and y1 (highlighting effect)
:param ax:
:type ax: plt.axes.axes object
:param x0:
:type x0: x-coordinate of the left of a band  (x0 &lt; x1). As a default, x0, x1 = ax.get_xlim()
:param x1:
:type x1: x-coordinate of the right of a band (x0 &lt; x1)
:param y0:
:type y0: y-coordinate of the bottom of a band  (y0 &lt; y1)
:param y1:
:type y1: y-coordinate of the top of a band  (y0 &lt; y1)
:param color:
:type color: color of a band
:param alpha:
:type alpha: alpha of a band
:param kwargs:
:type kwargs: kwargs for ax.fill_between()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.axhline">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">axhline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'--'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.axhline" title="Permalink to this definition"></a></dt>
<dd><p>Draw a horizontal line at y=y from xmin to xmax
:param y:
:param x:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.axvband">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">axvband</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.axvband" title="Permalink to this definition"></a></dt>
<dd><p>Make a vertical band between x0 and x1 (highlighting effect)
:param ax:
:type ax: plt.axes.axes object
:param x0:
:type x0: x-coordinate of the left of a band  (x0 &lt; x1)
:param x1:
:type x1: x-coordinate of the right of a band (x0 &lt; x1)
:param y0:
:type y0: y-coordinate of the bottom of a band  (y0 &lt; y1)
:param y1:
:type y1: y-coordinate of the top of a band  (y0 &lt; y1). As a default, y0, y1 = ax.get_ylim()
:param color:
:type color: color of a band
:param alpha:
:type alpha: alpha of a band
:param kwargs:
:type kwargs: kwargs for ax.fill_between()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.axvline">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">axvline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'--'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.axvline" title="Permalink to this definition"></a></dt>
<dd><p>Draw a vertical line at x=x from ymin to ymax
:param x:
:param y:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.bin_and_errorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">bin_and_errorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_bottom_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_left_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.bin_and_errorbar" title="Permalink to this definition"></a></dt>
<dd><p>Takes scattered data points (x, y), bin them (compute avg and std), then plots the results with error bars</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – </p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – </p></li>
<li><p><strong>xerr</strong> (<em>must be a scalar</em><em> or </em><em>numpy array with shape</em><em> (</em><em>N</em><em>,</em><em>1</em><em>) or </em><em>(</em><em>2</em><em>, </em><em>N</em><em>)</em><em>...</em><em> [</em><em>xerr_left</em><em>, </em><em>xerr_right</em><em>]</em>) – … if xerr==0, it removes the error bars in x.</p></li>
<li><p><strong>yerr</strong> (<em>must be a scalar</em><em> or </em><em>numpy array with shape</em><em> (</em><em>N</em><em>,</em><em>) or </em><em>(</em><em>2</em><em>, </em><em>N</em><em>)</em><em>...</em><em> [</em><em>yerr_left</em><em>, </em><em>yerr_right</em><em>]</em>) – </p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>number of bins used to compute a histogram between xmin and xmax</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default: 'linear'</em><em>, </em><em>options are 'linear' and 'log'. Select either linear binning</em><em> or </em><em>logarithmic binning</em>) – <p>… If “linear”, it computes statistics using evenly separated bins between xmin and xmax.
… If “log”, it uses bins evenly separted in the log space. (It assumes that xmin&gt;0)</p>
<blockquote>
<div><p>i.e. The bin edges are like (10^-1.0, 10^-0.5),  (10^-0.5, 10^0),  (10^0, 10^0.5), and so on.</p>
</div></blockquote>
</p></li>
<li><p><strong>bin_center</strong> (<em>bool</em><em>, </em><em>default: True.</em>) – … passed to get_binned_stats()</p></li>
<li><p><strong>return_std</strong> (<em>bool</em><em>, </em><em>default: False.</em>) – … passed to get_binned_stats()
… If False, it uses standard errors as error bars, instead of using standard deviations</p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em>) – </p></li>
<li><p><strong>ax</strong> (<em>Axes object</em><em>, </em><em>default: None</em>) – … If given, this becomes the Axes on which the results are plotted</p></li>
<li><p><strong>marker</strong> (<em>str</em><em>, </em><em>default: 'o'</em><em>, </em><em>marker style</em>) – </p></li>
<li><p><strong>fillstyle</strong> (<em>str</em><em>, </em><em>default: 'full'. Options: 'full'</em><em>, </em><em>'none'. See matplotlib scatter for more details</em>) – </p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>default:'None'</em>) – </p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>linewidth of the error bars</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>label for a legend</em>) – </p></li>
<li><p><strong>mfc</strong> (<em>str</em><em>, </em><em>default:'white'</em><em>, </em><em>marker face color</em>) – … Use this with fillstyle=’none’ in order to change the face color of the marker.
… Common usage: empty circles- fillstyle=’none’, mfc=’white’</p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>three-digit number. e.g.-111</em>) – </p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>default: False. If True</em><em>, </em><em>ax.legend is called at the end.</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size in inches</em>) – </p></li>
<li><p><strong>maskon</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … This hides “suspicious” data points / outliers.
… See the docstr of get_mask4erroneous_pts() for more details</p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>threshold value used for get_mask4erroneous_pts</em><em>(</em><em>) </em><em>to determine the outliers</em>) – </p></li>
<li><p><strong>capsize</strong> (<em>float</em><em>, </em><em>width of the error bars</em>) – </p></li>
<li><p><strong>return_stats</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, it returns the binned results (that are being plotted): x[mask], y[mask], xerr[mask], yerr[mask]</p></li>
<li><p><strong>kwargs</strong> (<em>passed to ax.errorbar</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>If not return_stats (default),</em> – fig, ax: a Figure instance, an Axes instance</p></li>
<li><p><em>If return_stats</em> – fig, ax, x[mask], y[mask], xerr[mask], yerr[mask]: a Figure instance, an Axes instance, binned results (x, y, x_err, y_err)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.cdf">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.cdf" title="Permalink to this definition"></a></dt>
<dd><p>Plots a cummulative distribution function of ND data
… a wrapper for np.histogram and matplotlib
… Returns fig, ax, (optional: bins, hist)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>nd-array</em><em>, </em><em>list</em><em>, or </em><em>tuple</em><em>, </em><em>data used to get a histogram/pdf</em>) – </p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>umber of bins</em>) – </p></li>
<li><p><strong>return_data</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it returns  fig</em><em>, </em><em>ax</em><em>, </em><em>bins</em><em> (</em><em>centers of the bins</em><em>)</em><em>, </em><em>hist</em><em> (</em><em>counts</em><em> or </em><em>probability density values</em><em>)</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>data</em><em>[</em><em>data&gt;vmax</em><em>] </em><em>will be ignored during counting.</em>) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>data</em><em>[</em><em>data&lt;vmin</em><em>] </em><em>will be ignored during counting.</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em><em> (</em><em>the argument called &quot;num&quot; in matplotlib</em><em>)</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size in inch</em><em> (</em><em>width x height</em><em>)</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>matplotlib subplot notation. default: 111</em>) – </p></li>
<li><p><strong>density</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it plots the probability density instead of counts.</em>) – </p></li>
<li><p><strong>analyze</strong> (<em>bool If True</em><em>, </em><em>it adds mean</em><em>, </em><em>mode</em><em>, </em><em>variane to the plot.</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>other kwargs passed to plot</em><em>(</em><em>) </em><em>of the velocity module</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.Figure instance</em>)</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes instance</em>)</p></li>
<li><p><em>(Optional)</em></p></li>
<li><p><strong>bins</strong> (<em>1d array, bin centers</em>)</p></li>
<li><p><strong>hist</strong> (<em>1d array, probability density vales or counts</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.choose_colors">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">choose_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.choose_colors" title="Permalink to this definition"></a></dt>
<dd><p>Equivalent of sns.choose_cubehelix_palette()</p>
<dl class="simple">
<dt>Example: COLOR CURVES BASED ON A QUANTITY ‘Z’</dt><dd><p># What is Z?
z = [0, 0.25, 0.5, 0.75, 1]
# Choose colors
colors = graph.choose_colors()
# Set the colors as a default color cycle
set_default_color_cycle(n=len(z), colors=colors)
# Plot your data…
plot(x1, y1) # color1
plot(x2, y2) # color2
…
# Add a colorbar (On the same figure)
add_colorbar_alone(plt.gca(), z, colors=colors) # plot a stand-alone colorbar in the figure
# Add a colorbar (On the different figure)
plot_colorbar(z, colors=colors, fignum=2) # plot a stand-alone colorbar on a new figure</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>colors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.clf">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">clf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.clf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.close">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">argv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.close" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.cname2hex">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">cname2hex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.cname2hex" title="Permalink to this definition"></a></dt>
<dd><p>Converts a color registered on matplotlib to a HEX code
:param cname:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.color_axis">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">color_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['bottom',</span> <span class="pre">'left',</span> <span class="pre">'right']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['k',</span> <span class="pre">'C0',</span> <span class="pre">'C1']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.color_axis" title="Permalink to this definition"></a></dt>
<dd><p>Colors the axes (axis, ticks, and a label)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>axes.Axes instance</em>) – </p></li>
<li><p><strong>locs</strong> (<em>list of strings</em><em>, </em><em>locations of the axes. choose from 'bottom'</em><em>, </em><em>'left'</em><em>, </em><em>'right'</em><em>, </em><em>'top'</em>) – </p></li>
<li><p><strong>colors</strong> (<em>list of strings</em><em>, </em><em>colors of the axes. e.g.</em><em> [</em><em>'k'</em><em>, </em><em>'C0'</em><em>, </em><em>'C1'</em><em>]</em>) – </p></li>
<li><p><strong>xlabel_color</strong> (<em>str</em><em>, </em><em>color of xlabel. If None</em><em>, </em><em>the same colors as &quot;colors&quot; are used.</em>) – </p></li>
<li><p><strong>ylabel_color</strong> (<em>str</em><em>, </em><em>color of ylabel. If None</em><em>, </em><em>the same colors as &quot;colors&quot; are used.</em>) – </p></li>
<li><p><strong>xtick_color</strong> (<em>str</em><em>, </em><em>color of xtick. If None</em><em>, </em><em>the same colors as &quot;colors&quot; are used.</em>) – </p></li>
<li><p><strong>ytick_color</strong> (<em>str</em><em>, </em><em>color of ytick. If None</em><em>, </em><em>the same colors as &quot;colors&quot; are used.</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.color_plot">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">color_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforceSymmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scientific'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickinc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticklabelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.color_plot" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>y</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>z</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>default is 111</em>) – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>vmin</strong> – </p></li>
<li><p><strong>vmax</strong> – </p></li>
<li><p><strong>log10</strong> – </p></li>
<li><p><strong>label</strong> – </p></li>
<li><p><strong>cbar</strong> – </p></li>
<li><p><strong>cmap</strong> – </p></li>
<li><p><strong>symmetric</strong> – </p></li>
<li><p><strong>aspect</strong> (<em>str</em><em>, </em><em>'equal'</em><em> or </em><em>'auto</em>) – </p></li>
<li><p><strong>option</strong> – </p></li>
<li><p><strong>ntick</strong> – </p></li>
<li><p><strong>tickinc</strong> – </p></li>
<li><p><strong>crop</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
<li><p><strong>cb_kwargs</strong> (<em>dict</em><em>, </em><em>kwargs for add_colorbar</em><em>(</em><em>)</em>) – … e.g. {“fformat”: %.0f}</p></li>
<li><p><strong>return_cb</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … if True, this function returns fig, ax, cc, cb (colorbar instance)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>fig</em></p></li>
<li><p><em>ax</em></p></li>
<li><p><strong>cc</strong> (<em>QuadMesh instance</em>)</p></li>
<li><p><strong>cb</strong> (<em>colorbar instance (optional)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.colorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">colorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.colorbar" title="Permalink to this definition"></a></dt>
<dd><p>Use is DEPRICATED. This method is replaced by add_colorbar(mappable)
I keep this method for old codes which might have used this method
:param fignum:
:param label:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.contour">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%1.3f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.contour" title="Permalink to this definition"></a></dt>
<dd><p>Plot contours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>y</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>psi</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>levels</strong> (<em>int</em><em> or </em><em>1d array-like</em>) – … If int (n), it plots n contours.
… If array-like, it plots contours at the corresponding levels.</p></li>
<li><p><strong>vmin</strong> (<em>int</em>) – … plots contours at the levels in (vmin, vmax)</p></li>
<li><p><strong>vmax</strong> (<em>int</em>) – … plots contours at the levels in (vmin, vmax)</p></li>
<li><p><strong>subplot</strong> (<em>int</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em>) – </p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax.Axes instance</em>) – </p></li>
<li><p><strong>fontsize</strong> – … passed to ax.clabel()</p></li>
<li><p><strong>inline</strong> (<em>bool</em><em>, </em><em>default: True</em>) – … passed to ax.clabel()</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>default: &quot;%.1.3f&quot;</em>) – … passed to ax.clabel()</p></li>
<li><p><strong>label_kwargs</strong> – … passed to ax.clabel()</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – … passed to ax.contour()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>fig, ax, ctrs</em></p></li>
<li><p><strong>… ctrs</strong> (<em>a QuadContourSet instance</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.countcolorcycle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">countcolorcycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">color_cycle=&lt;itertools.cycle</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.countcolorcycle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.create_cmap_from_colors">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">create_cmap_from_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colors_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'newmap'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.create_cmap_from_colors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.create_cmap_using_values">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">create_cmap_using_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'greenyellow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'darkgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.create_cmap_using_values" title="Permalink to this definition"></a></dt>
<dd><p>Create a colormap instance from a list
… same as mpl.colors.LinearSegmentedColormap.from_list()
:param colors:
:param color1:
:param color2:
:param n:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.create_colorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">create_colorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vertical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'qty</span> <span class="pre">(mm)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.create_colorbar" title="Permalink to this definition"></a></dt>
<dd><p>Creates a horizontal/vertical colorbar for reference using pylab.colorbar()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>1d array-like</em><em>, </em><em>used to specify the min and max of the colorbar</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>cmap instance</em><em> or </em><em>str</em><em>, </em><em>default: 'viridis'</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size in inches</em><em>, </em><em>default: None</em>) – </p></li>
<li><p><strong>orientation</strong> (<em>str</em><em>, </em><em>'horizontal'</em><em> or </em><em>'vertical'</em>) – </p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>label of the color bar</em>) – </p></li>
<li><p><strong>fontsize</strong> (<em>fontsize for the label and the ticklabel</em>) – </p></li>
<li><p><strong>labelpad</strong> (<em>float</em><em>, </em><em>padding for the label</em>) – </p></li>
<li><p><strong>ticks</strong> (<em>1d array</em><em>, </em><em>tick locations</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.create_weight_shifted_cmap">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">create_weight_shifted_cmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmapname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.create_weight_shifted_cmap" title="Permalink to this definition"></a></dt>
<dd><p>Creates a cmap instance of a weight-shifted colormap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmapname</strong> (<em>str</em>) – </p></li>
<li><p><strong>ratio</strong> – </p></li>
<li><p><strong>vmin</strong> – </p></li>
<li><p><strong>vmax</strong> – </p></li>
<li><p><strong>vcenter</strong> – </p></li>
<li><p><strong>n</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.default_figure_params">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">default_figure_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.default_figure_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_box">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">351.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">351.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalebar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$mm$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.95,</span> <span class="pre">0.1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_txtloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb_txtcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluidcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounding_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bb_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bb_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_box" title="Permalink to this definition"></a></dt>
<dd><p>Draws a box and fills the surrounding area with color (default: skyblue)
Adds a scalebar by default
… drawn box center coincides with the center of given grids(xx, yy)
… in order to shift the center of the box, use xoffset any yoffset
:param ax:
:type ax: matplotlib.axes.Axes instance
:param xx: x coordinates
:type xx: 2d numpy array
:param yy: y coordinates
:type yy: 2d numpy array
:param w_box: width of the box- used to be set as 325
:type w_box: float/int
:param h_box: height of the box- used to be set as 325
:type h_box: float/int
:param xoffset: real number to shift the box center in the x direction
:type xoffset: float/int
:param yoffset: real number to shift the box center in the x direction
:param linewidth: linewidth of drawn box
:type linewidth: int
:param scalebar: … draws a scalebar inside the drawn box
:type scalebar: bool (default: True)
:param sb_length: … length of the scale bar in physical units.</p>
<blockquote>
<div><p>…… In principle, this can be float. If you want that, edit the code where ax.text() is called.
…… Generalizing to accept the float requires a format which could vary everytime, so just accept integer.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sb_units</strong> (<em>str</em>) – … units of the sb_length. Default: ‘$mm$’</p></li>
<li><p><strong>sb_loc</strong> (<em>tuple</em><em>, </em><em>(</em><em>x</em><em>, </em><em>y</em><em>)</em>) – … location of the scale bar. Range: [0, 1]
… the units are with respect the width and height of the box</p></li>
<li><p><strong>sb_txtloc</strong> (<em>tuple</em><em>, </em><em>(</em><em>x</em><em>, </em><em>y</em><em>)</em>) – … location of the TEXT of the scale bar. Range: [0, 1]
… x=0: LEFT of the scale bar, x=1: RIGHT of the scale bar
… y=0: LEFT of the scale bar, x=1: RIGHT of the scale bar</p></li>
<li><p><strong>sb_lw</strong> (<em>float</em>) – … line width of the scale bar</p></li>
<li><p><strong>facecolor</strong> – </p></li>
<li><p><strong>fluidcolor</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_circle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_circle" title="Permalink to this definition"></a></dt>
<dd><p>Draws a circle on the axes (ax)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib axes object</em>) – </p></li>
<li><p><strong>x</strong> (<em>float</em>) – </p></li>
<li><p><strong>y</strong> (<em>float</em>) – </p></li>
<li><p><strong>r</strong> (<em>float</em>) – </p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – </p></li>
<li><p><strong>edgecolor</strong> – </p></li>
<li><p><strong>facecolor</strong> – </p></li>
<li><p><strong>fill</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_cuboid">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_cuboid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_cuboid" title="Permalink to this definition"></a></dt>
<dd><p>Draws a cuboid (projection=’3d’)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_power_triangle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_power_triangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_base_label_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_power_triangle" title="Permalink to this definition"></a></dt>
<dd><p>Draws a triangle which indicates a power law in the log-log plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes._subplots.AxesSubplot object</em>) – … get it like plt.gca()</p></li>
<li><p><strong>x</strong> (<em>float / int</em>) – … x coordinate of the triangle drawn on the plot</p></li>
<li><p><strong>y</strong> (<em>float / int</em>) – … x coordinate of the triangle drawn on the plot</p></li>
<li><p><strong>exponent</strong> (<em>float / int</em>) – … exponent of the power law
… Y = X^exponent</p></li>
<li><p><strong>w</strong> (<em>float / int</em>) – … number of decades for the drawn triangle to span on the plot
… By default, this function draws a triangle with size of 0.4 times the width of the plot</p></li>
<li><p><strong>h</strong> (<em>float / int</em>) – … number of decades for the drawn triangle to span on the plot</p></li>
<li><p><strong>facecolor</strong> (<em>str</em>) – … face color of the drawn triangle, default: ‘none’ (transparent)
… passed to mpatches.PathPatch object</p></li>
<li><p><strong>edgecolor</strong> (<em>str</em>) – … edge color of the drawn triangle, default: ‘r’
… passed to mpatches.PathPatch object</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em> [</em><em>0</em><em>, </em><em>1</em><em>]</em>) – … alpha value of the drawn triangle</p></li>
<li><p><strong>flip</strong> (<em>bool</em>) – … If True, it will flip the triangle horizontally.</p></li>
<li><p><strong>fontsize</strong> (<em>float / int</em>) – … fontsize of the texts to indicate the exponent aside the triangle</p></li>
<li><p><strong>set_base_label_one</strong> (<em>bool</em><em>, </em><em>default: False</em>) – … If True, it will always annotate the base as ‘1’ and alter the text for the height accordingly.
… By default, it will annotate the base and the height using the closest integer pair.</p></li>
<li><p><strong>beta</strong> (<em>float / int</em><em>, </em><em>default: 20</em>) – … This is used to control the spacing between the text and the drawn triangle
… The higher beta is, the less spacing between the text and the triangle</p></li>
<li><p><strong>zorder</strong> (<em>zorder of triangle</em><em>, </em><em>default: 0</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>the other kwargs will be passed to ax.text</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_rectangle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_rectangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_rectangle" title="Permalink to this definition"></a></dt>
<dd><p>Draws a rectangle in a figure (ax)
:param ax:
:param x:
:param y:
:param width:
:param height:
:param angle:
:param linewidth:
:param edgecolor:
:param facecolor:
:param kwargs:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_sphere">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_sphere" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.draw_sphere_wireframe">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">draw_sphere_wireframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.draw_sphere_wireframe" title="Permalink to this definition"></a></dt>
<dd><p>Draws a sphere using a wireframe
:param ax:
:param xc:
:param yc:
:param zc:
:param r:
:param color:
:param lw:
:param kwargs:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.dummy_scalarMappable">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">dummy_scalarMappable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.dummy_scalarMappable" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dummy scalarMappable that can be used to make a stand-alone color bar
e.g.</p>
<blockquote>
<div><p>sm = dummy_scalarMappable([0, 100], ‘viridis’)
fig = plt.figure(1)
fig.colorbar(sm, pad=0.1)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>list</em><em>, </em><em>array</em><em>, </em><em>this is used to specify the range of the color bar</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>cmap object</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.embed_2dplot_in_3d">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">embed_2dplot_in_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.embed_2dplot_in_3d" title="Permalink to this definition"></a></dt>
<dd><p>This embeds a 2d plot/image in 3D plot. The 2d plot points in +z(+y, or +x) direction.
… This function should be used for a visualization purposes since it is not scientifically informative!
… Use ax.plot_surface to insert a 2d plot on an arbitrary surface embedded in 3D.
… This function can be usd to show three 2D projections of a 3D data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pp</strong> (<em>2d array</em><em>, </em><em>x coordinate of the 2d plot</em>) – </p></li>
<li><p><strong>qq</strong> (<em>2d array</em><em>, </em><em>y coordinate of the 2d plot</em>) – </p></li>
<li><p><strong>qty</strong> (<em>2d array</em><em>, </em><em>data of the 2d plot</em>) – </p></li>
<li><p><strong>zdir</strong> (<em>str</em><em>, </em><em>direction of the normal vector. choices are 'z'</em><em>, </em><em>'x'</em><em>, </em><em>'y'</em>) – </p></li>
<li><p><strong>offset</strong> (<em>float</em><em>,</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>cmap instance</em><em>,</em>) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>colormap spans from vmin to vmap</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>colormap spans from vmin to vmap</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>number of the figure</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>subplot of the figure</em><em> (</em><em>three digit notation</em><em>, </em><em>default: 111</em><em>)</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size in inches</em>) – </p></li>
<li><p><strong>zorder</strong> (<em>int</em><em>, </em><em>zorder of the produced surface</em>) – </p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>alpha of the embedded plot</em>) – </p></li>
<li><p><strong>edgecolors</strong> (<em>str</em><em>, </em><em>edge color that is passed to ax.plot_surface</em><em>(</em><em>)</em><em>- default: 'none'</em>) – </p></li>
<li><p><strong>lw</strong> (<em>float</em><em>, </em><em>linewidth that is passed to ax.plot_surface</em><em>(</em><em>)</em><em>- default: 0</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax, surf</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.errorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">errorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_remove_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.errorbar" title="Permalink to this definition"></a></dt>
<dd><p>errorbar plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – </p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – </p></li>
<li><p><strong>xerr</strong> (<em>must be a scalar</em><em> or </em><em>numpy array with shape</em><em> (</em><em>N</em><em>,</em><em>1</em><em>) or </em><em>(</em><em>2</em><em>, </em><em>N</em><em>)</em><em>...</em><em> [</em><em>xerr_left</em><em>, </em><em>xerr_right</em><em>]</em>) – </p></li>
<li><p><strong>yerr</strong> (<em>must be a scalar</em><em> or </em><em>numpy array with shape</em><em> (</em><em>N</em><em>,</em><em>) or </em><em>(</em><em>2</em><em>, </em><em>N</em><em>)</em><em>...</em><em> [</em><em>yerr_left</em><em>, </em><em>yerr_right</em><em>]</em>) – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>label</strong> – </p></li>
<li><p><strong>color</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>legend</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>fig</em></p></li>
<li><p><em>ax</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.errorfill">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">errorfill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_bottom_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_left_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.errorfill" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.float2pc">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">float2pc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.float2pc" title="Permalink to this definition"></a></dt>
<dd><p>Converts a float into a percentage expression
:param x:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>a string in float (e.g. 0.0052)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.force2showLogMajorTicks">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">force2showLogMajorTicks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.force2showLogMajorTicks" title="Permalink to this definition"></a></dt>
<dd><p>Force to show the minor ticks in the logarithmic axes
… the minor ticks could be suppressed due to the limited space
:param ax:
:type ax: Axes instance
:param subs:
:type subs: str, list, or np.array, ‘all’ is equivalent to np.arange(1, 10)
:param … to:
:param numticks:
:type numticks: int, make this integer high to show the minor ticks</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.force2showLogMinorTicks">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">force2showLogMinorTicks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.force2showLogMinorTicks" title="Permalink to this definition"></a></dt>
<dd><p>Force to show the minor ticks in the logarithmic axes
… the minor ticks could be suppressed due to the limited space
:param ax:
:type ax: Axes instance
:param subs:
:type subs: str, list, or np.array, ‘all’ is equivalent to np.arange(1, 10)
:param numticks:
:type numticks: int, make this integer high to show the minor ticks</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_binned_stats">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_binned_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_binned_stats" title="Permalink to this definition"></a></dt>
<dd><p>Make a histogram out of a pair of 1d arrays.
… Returns arg_bins, var_mean, var_err
… The given arrays could contain nans and infs. They will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg</strong> (<em>1d array</em><em>, </em><em>controlling variable</em>) – </p></li>
<li><p><strong>var</strong> (<em>1d array</em><em>, </em><em>data array to be binned</em>) – </p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default: 100</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>deafult: 'linear'</em>) – If ‘linear’, var will be sorted to equally spaced bins. i.e. bin centers increase linearly.
If ‘log’, the bins will be not equally spaced. Instead, they will be equally spaced in log.
… bin centers will be like… 10**0, 10**0.5, 10**1.0, 10**1.5, …, 10**9</p></li>
<li><p><strong>return_std</strong> (<em>bool</em>) – If True, it returns the STD of the statistics instead of the error = STD / np.sqrt(N-1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>arg_bins</strong> (<em>1d array, bin centers</em>)</p></li>
<li><p><strong>var_mean</strong> (<em>1d array, mean values of data in each bin</em>)</p></li>
<li><p><strong>var_err</strong> (<em>1d array, std of data in each bin</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_color_from_cmap">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_color_from_cmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_color_from_cmap" title="Permalink to this definition"></a></dt>
<dd><p>A simple function which returns a list of RGBA values from a cmap (evenly spaced)
… If one desires to assign a color based on values, use get_colors_and_cmap_using_values()
… If one prefers to get colors between two colors of choice, use get_color_list_gradient()
:param cmapname:
:type cmapname: str, standard cmap name
:param n:
:type n: int, number of colors
:param lut: … If lut is not None it must be an integer giving the number of entries desired in the lookup table,</p>
<blockquote>
<div><p>and name must be a standard mpl colormap name.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>int</strong> – … If lut is not None it must be an integer giving the number of entries desired in the lookup table,
and name must be a standard mpl colormap name.</p>
</dd>
</dl>
<dl class="simple">
<dt>:param<span class="classifier">… If lut is not None it must be an integer giving the number of entries desired in the lookup table,</span></dt><dd><p>and name must be a standard mpl colormap name.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>colors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_color_list_gradient">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_color_list_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'greenyellow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'darkgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_color_list_gradient" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of colors in RGB between color1 and color2
Input (color1 and color2) can be RGB or color names set by matplotlib
… color1-color2-color3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color1</strong> – </p></li>
<li><p><strong>color2</strong> – </p></li>
<li><p><strong>n</strong> (<em>length of the returning list</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>color_list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_colors_and_cmap_using_values">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_colors_and_cmap_using_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'greenyellow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'darkgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_colors_and_cmap_using_values" title="Permalink to this definition"></a></dt>
<dd><p>Returns colors (list), cmap instance, mpl.colors.Normalize instance assigned by the
…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>1d array-like</em><em>,</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em><em> or  </em><em>matplotlib.colors.Colormap instance</em>) – </p></li>
<li><p><strong>color1</strong> – </p></li>
<li><p><strong>color2</strong> – </p></li>
<li><p><strong>vmin</strong> – </p></li>
<li><p><strong>vmax</strong> – </p></li>
<li><p><strong>n</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>colors, cmap, norm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_contours">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close_ctr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_contours" title="Permalink to this definition"></a></dt>
<dd><p>Returns positions of contours drawn by ax.contour()
… each contour has a different length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctrs</strong> (<em>QuadContourSet instance</em><em> (</em><em>output of ax.contour</em><em>)</em>) – </p></li>
<li><p><strong>close_ctr</strong> (<em>bool</em>) – … If True, returned points on the contours would be closed.</p></li>
<li><p><strong>thd</strong> (<em>float</em>) – <p>… Relevant parameter if close_ctr is True
… Let the beginning and the end of a contour be R1 and R2.</p>
<blockquote>
<div><p>If <a href="#id39"><span class="problematic" id="id40">|R1 - R2|</span></a> &lt; thd, it considers the contour closed.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>verts</strong> – … verts[n] stores (x, y) of the n-th contour
… xn, yn = verts[n][:, 0], verts[n][:, 1]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_current_backend">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_current_backend</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_current_backend" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_data_from_fig_plot">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_data_from_fig_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_data_from_fig_plot" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of data included in the figure
… this function extracts data points for fig.ax.lines
… Any other data must be returned</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> – </p></li>
<li><p><strong>axis_number</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_data_from_fig_scatter">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_data_from_fig_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_data_from_fig_scatter" title="Permalink to this definition"></a></dt>
<dd><p>Retrieves x, y from a scatter plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_default_color_cycle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_default_color_cycle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_default_color_cycle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_first_n_colors_from_color_cycle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_first_n_colors_from_color_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_first_n_colors_from_color_cycle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_first_n_default_colors">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_first_n_default_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_first_n_default_colors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_markers">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_markers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_markers" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of available markers for ax.scatter()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_mask4erroneous_pts">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_mask4erroneous_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_mask4erroneous_pts" title="Permalink to this definition"></a></dt>
<dd><p>Retruns a mask that can be sued to hide erroneous data points for 1D plots
… e.g. x[mask] and y[mask] hide the jumps which appear to be false to human eyes
… Uses P = dy/dx / y to determine whether data points appear to be false</p>
<blockquote>
<div><p>If P is high, we’d expect a jump. thd is a threshold of P.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>y</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>threshold on P</em><em> (</em><em>fractional dy/dx</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mask</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d bool array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_plot_data_from_fig">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_plot_data_from_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_plot_data_from_fig" title="Permalink to this definition"></a></dt>
<dd><p>Depricated. Use get_data_from_fig_plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_scatter_data_from_fig">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_scatter_data_from_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_scatter_data_from_fig" title="Permalink to this definition"></a></dt>
<dd><p>Return x, y data of scattered data in a figure instance
… It requires a different code to extract scattered data from a Figure instance, compared to plt.plot() output (type: line?)
… Scattered data are stored as an collections.collection object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.Figure object</em>) – </p></li>
<li><p><strong>axis_number</strong> (<em>int</em><em>, </em><em>number to specify which axis user refers to. ax = fig.axes</em><em>[</em><em>axis_number</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data_list</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, each element of a list is a 2d array which store x,y coordinates of the scattered data points</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.get_sfmt">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">get_sfmt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.get_sfmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.hex2rgb">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">hex2rgb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.hex2rgb" title="Permalink to this definition"></a></dt>
<dd><p>Converts a HEX code to RGB in a numpy array
:param hex:
:type hex: str, hex code. e.g. #B4FBB8</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>rgb</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy array. RGB</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.imgScatter">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">imgScatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subax_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2%'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'5%'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scientific'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axLim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.54,</span> <span class="pre">7.54)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.imgScatter" title="Permalink to this definition"></a></dt>
<dd><p>Scatter plots images (2d arrays)
… This function creates additional Axes on top of the master Axes instance.</p>
<p>To do1: one should be able to plot on the master Axes; however, this fails even with altering the zorder values.
To do2: Should one be able to pass a list of imag_x as well?- this would enable plotting imgs with different resolutions
:param x:
:type x: 1d array-like, x-coordinates of the image locations
:param y:
:type y: 1d array-like, y-coordinates of the image locations
:param imgs:
:type imgs: list, list of images (2d arrays
:param img_x: … Otherwise, it calls imshow(imgs[i]).
:type img_x: 2d array (optional), x grid of the images- if given, this calls color_plot(img_x, img_y, imgs[i]).
:param img_y: … Otherwise, it calls imshow(imgs[i]).
:type img_y: 2d array (optional), y grid of the images- if given, this calls color_plot(img_x, img_y, imgs[i]).
:param subax_size:
:type subax_size: float (0, 1], default:0.06, the size of the subaxes (inner plots)
:param cmap:
:type cmap: str/cmap object- a color map of the images
:param vmin:
:type vmin: float, default:None- color bar range [vmin, vmax]
:param vmax:
:type vmax: float, default:None- color bar range [vmin, vmax]
:param cbar:
:type cbar: boolean, default:False- To toggle a color bar, vmin and vmax must be given. This is because each image could be drawn with a different color bar range.
:param cb_pad:
:type cb_pad: str, default:”2%” (with respect to the figure width)- Do not pass a float.
:param cb_size:
:type cb_size: str, default:”2%” (with respect to the figure width)- Do not pass a float.
:param cb_option:
:type cb_option: str, color bar notation, choose from ‘normal’ and ‘scientific’
:param cb_label:
:type cb_label: str, label of the color bar
:param axLim:
:type axLim: 1d array-like (xmin, xmax, ymin, ymax)- x- and y-limits of the master axes
:param kwargs:
:type kwargs: dict, this gets passed to either imshow() or color_plot()</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>fig, ax, axes, cb</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Figure, Axes (master), list of Axes, a color bar object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.imshow">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">imshow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7.54,</span> <span class="pre">7.54)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bwr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.imshow" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array-like</em><em> or </em><em>PIL image</em>) – </p></li>
<li><p><strong>xmin</strong> (<em>float</em><em> [</em><em>0.</em><em>, </em><em>1.</em><em>)</em><em>- extent=</em><em>(</em><em>xmin</em><em>, </em><em>xmax</em><em>, </em><em>ymin</em><em>, </em><em>ymax</em><em>) </em><em>The bounding box in data coordinates that the image will fill.</em>) – </p></li>
<li><p><strong>xmax</strong> (<em>float</em><em> (</em><em>0.</em><em>, </em><em>1.</em><em>]</em><em>- extent=</em><em>(</em><em>xmin</em><em>, </em><em>xmax</em><em>, </em><em>ymin</em><em>, </em><em>ymax</em><em>) </em><em>The bounding box in data coordinates that the image will fill.</em>) – </p></li>
<li><p><strong>ymin</strong> (<em>float</em><em> [</em><em>0.</em><em>, </em><em>1.</em><em>)</em><em>- extent=</em><em>(</em><em>xmin</em><em>, </em><em>xmax</em><em>, </em><em>ymin</em><em>, </em><em>ymax</em><em>) </em><em>The bounding box in data coordinates that the image will fill.</em>) – </p></li>
<li><p><strong>ymax</strong> (<em>float</em><em> (</em><em>0.</em><em>, </em><em>1.</em><em>]</em><em>- extent=</em><em>(</em><em>xmin</em><em>, </em><em>xmax</em><em>, </em><em>ymin</em><em>, </em><em>ymax</em><em>) </em><em>The bounding box in data coordinates that the image will fill.</em>) – </p></li>
<li><p><strong>cbar</strong> (bool, If True, fig.colorbar(ImageAxes instance, <a href="#id25"><span class="problematic" id="id26">**</span></a>cb_kwargs) is called.) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>image intensity ranges from vmin to vmax</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>image intensity ranges from vmin to vmax</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>three-digit integer to specify a subplot</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size- e.g.</em><em> (</em><em>8</em><em>,</em><em>8</em><em>)</em>) – </p></li>
<li><p><strong>interpolation</strong> (<em>'none'</em><em>, </em><em>'nearest'</em><em>, </em><em>'bilinear'</em><em>, </em><em>'bicubic'</em><em>, </em><em>'spline16'</em><em>, </em><em>'spline36'</em><em>,</em>) – ‘hanning’, ‘hamming’, ‘hermite’, ‘kaiser’, ‘quadric’, ‘catrom’,
‘gaussian’, ‘bessel’, ‘mitchell’, ‘sinc’, ‘lanczos’.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>color map used for plt.imshow</em>) – </p></li>
<li><p><strong>cb_kwargs</strong> (<em>dict</em><em>,  </em><em>color bar keyward arguments can be passed in this dictionary like {'shrink': 0.5</em><em>, </em><em>'pad':0.05}</em>) – <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html">https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig, ax, ima, cc</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Figure, Axes, AxesImage, Colorbar instances</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.labelaxes">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">labelaxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.labelaxes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.labelaxes_multicolor">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">labelaxes_multicolor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_of_strings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_of_colors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchorpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.labelaxes_multicolor" title="Permalink to this definition"></a></dt>
<dd><p>this function creates axes labels with multiple colors
ax specifies the axes object where the labels should be drawn
list_of_strings is a list of all of the text items
list_if_colors is a corresponding list of colors for the strings
axis=’x’, ‘y’, or ‘both’ and specifies which label(s) should be drawn</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.legend">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">legend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.legend" title="Permalink to this definition"></a></dt>
<dd><p>loc:
best        0, upper right  1, upper left   2, lower left   3, lower right  4, right        5,
center left 6, center right 7, lower center 8, upper center 9, center       10
:param ax:
:param kwargs:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.list_available_backends">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">list_available_backends</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.list_available_backends" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.make_ax_symmetric">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">make_ax_symmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.make_ax_symmetric" title="Permalink to this definition"></a></dt>
<dd><p>Makes the plot symmetric about x- or y-axis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.make_ticks_scientific">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">make_ticks_scientific</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.make_ticks_scientific" title="Permalink to this definition"></a></dt>
<dd><p>Make tick labels display in a scientific format</p>
<dl class="simple">
<dt>Some other useful lines about tick formats</dt><dd><p>ax.set_xticks(np.arange(0, 1.1e-3, 0.5e-3))
ax.set_yticks(np.arange(0, 1.1e-3, 0.25e-3))
ax.tick_params(axis=’x’, labelsize=20)
ax.tick_params(axis=’y’, labelsize=20)
ax.xaxis.offsetText.set_fontsize(20)
ax.yaxis.offsetText.set_fontsize(20)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ax</strong> (<em>axes.Axes instance</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.pc2float">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">pc2float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.pc2float" title="Permalink to this definition"></a></dt>
<dd><p>Converts a percentage expression (str) to float
e.g. pc2float(5.2%) returns 0.0052
:param s:
:type s: str, e.g. “5.2%”</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>a floating number  (e.g. 0.0052)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.pdf">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analyze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.pdf" title="Permalink to this definition"></a></dt>
<dd><p>Plots a probability distribution function of ND data
… a wrapper for np.histogram and matplotlib
… Returns fig, ax, (optional: bins, hist)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>nd-array</em><em>, </em><em>list</em><em>, or </em><em>tuple</em><em>, </em><em>data used to get a histogram/pdf</em>) – </p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>number of bins</em>) – </p></li>
<li><p><strong>return_data</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it returns  fig</em><em>, </em><em>ax</em><em>, </em><em>bins</em><em> (</em><em>centers of the bins</em><em>)</em><em>, </em><em>hist</em><em> (</em><em>counts</em><em> or </em><em>probability density values</em><em>)</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>data</em><em>[</em><em>data&gt;vmax</em><em>] </em><em>will be ignored during counting.</em>) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>data</em><em>[</em><em>data&lt;vmin</em><em>] </em><em>will be ignored during counting.</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em><em> (</em><em>the argument called &quot;num&quot; in matplotlib</em><em>)</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size in inch</em><em> (</em><em>width x height</em><em>)</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>matplotlib subplot notation. default: 111</em>) – </p></li>
<li><p><strong>density</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it plots the probability density instead of counts.</em>) – </p></li>
<li><p><strong>analyze</strong> (<em>bool If True</em><em>, </em><em>it adds mean</em><em>, </em><em>mode</em><em>, </em><em>variane to the plot.</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>other kwargs passed to plot</em><em>(</em><em>) </em><em>of the velocity module</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.Figure instance</em>)</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes instance</em>)</p></li>
<li><p><em>(Optional)</em></p></li>
<li><p><strong>bins</strong> (<em>1d array, bin centers</em>)</p></li>
<li><p><strong>hist</strong> (<em>1d array, probability density vales or counts</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.pie">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">pie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autopct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%1.1f%%'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startangle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.pie" title="Permalink to this definition"></a></dt>
<dd><p>A wrapper for plt.pie
… a main difference from the original plt.plot is the sorting feature. It automatically sorts the portions from the largest to smallest.
… If one</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_bottom_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_left_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_cycler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_cycler_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">['r',</span> <span class="pre">'b',</span> <span class="pre">'g',</span> <span class="pre">'y'],</span> <span class="pre">'linestyle':</span> <span class="pre">['-',</span> <span class="pre">'-',</span> <span class="pre">'-',</span> <span class="pre">'-'],</span> <span class="pre">'linewidth':</span> <span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">'marker':</span> <span class="pre">['o',</span> <span class="pre">'o',</span> <span class="pre">'o',</span> <span class="pre">'o'],</span> <span class="pre">'s':</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot" title="Permalink to this definition"></a></dt>
<dd><p>plot a graph using given x,y
fignum can be specified
any kwargs from plot can be passed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot3d">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot3d" title="Permalink to this definition"></a></dt>
<dd><p>plot a 3D graph using given x, y, z</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_colorbar">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_colorbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vertical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tick_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_colorbar" title="Permalink to this definition"></a></dt>
<dd><p>Plots a stand-alone colorbar</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>1d array-like</em><em>, </em><em>these values are used to create a colormap</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>cmap object</em>) – </p></li>
<li><p><strong>colors</strong> (<em>list of colors</em><em>, </em><em>if given</em><em>, </em><em>it overwrites 'cmap'.</em>) – … For custom colors/colormaps, the functions below could be handy.
…… colors = graph.choose_colors() # sns.choose_cubehelix_palette()
…… colors = graph.get_color_list_gradient(color1=’red’, color2=’blue’) # linearly segmented colors</p></li>
<li><p><strong>ncolors</strong> – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
<li><p><strong>orientation</strong> – </p></li>
<li><p><strong>label</strong> – </p></li>
<li><p><strong>labelpad</strong> – </p></li>
<li><p><strong>fontsize</strong> – </p></li>
<li><p><strong>option</strong> (<em>str</em><em>, </em><em>if 'scientific'</em><em>, </em><em>it uses a scientific format for the ticks</em>) – </p></li>
<li><p><strong>fformat</strong> – </p></li>
<li><p><strong>ticks</strong> – </p></li>
<li><p><strong>tick_params</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig, cax, cb</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Figure instance, axes.Axes instance, Colorbar instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_date">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_bottom_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_date" title="Permalink to this definition"></a></dt>
<dd><p>A function to plot values against dates with format “2020-01-01”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dates</strong> (<em>1d array-like of dates- each entry must be in the format &quot;YYYY-MM-DD&quot;</em>) – </p></li>
<li><p><strong>y</strong> (<em>1d array-like</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>fignure number</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size e.g.-</em><em> (</em><em>8</em><em>, </em><em>8</em><em>)</em>) – </p></li>
<li><p><strong>label</strong> (<em>label kwarg in plt.plot_date</em>) – </p></li>
<li><p><strong>color</strong> (<em>str</em><em>,  </em><em>color kwarg in plt.plot_date</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>3-digit notation to specify a subplot</em>) – </p></li>
<li><p><strong>legend</strong> (<em>bool</em>) – </p></li>
<li><p><strong>fig</strong> (<em>mpl.figure.Figure instance- if given</em><em>, </em><em>it will just return this instance at the end</em>) – </p></li>
<li><p><strong>ax</strong> (<em>mpl.axes.Axes instance- if given</em><em>, </em><em>it plots the given inputs on this subplot.</em>) – </p></li>
<li><p><strong>set_bottom_zero</strong> (<em>bool</em><em>, </em><em>if True</em><em>, </em><em>it sets the ymin=0</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>the keyword arguments will be passed to plt.plot_date</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig, ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.figure.Figure instance, matplotlib.axes.Axes instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_fit_curve">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_fit_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'--'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_equation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_fit_curve" title="Permalink to this definition"></a></dt>
<dd><p>Plots a fit curve given xdata and ydata
:param xdata:
:type xdata: 1d array
:param ydata:
:type ydata: 1d array
:param func:
:type func: a function to be fit- e.g. lambda x, a, b: a*x+b
:param fignum:
:type fignum: int, figure number
:param subplot:
:type subplot: int, three-digit number to specify a subplot location
:param ax:
:type ax: Axes instance- If given, it plots on the
:param figsize:
:param linestyle:
:param xmin:
:param xmax:
:param add_equation:
:param eq_loc:
:param color:
:param label:
:param show_r2:
:param return_r2:
:param p0:
:param bounds:
:param maskon:
:param thd:
:param kwargs:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>A Figure object, an Axes object</em>)</p></li>
<li><p><strong>popt, pcov</strong> (<em>fit results, a covariance matrix</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_interpolated_curves">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_interpolated_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_interp_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_interpolated_curves" title="Permalink to this definition"></a></dt>
<dd><p>plot a graph using given x, y
fignum can be specified
any kwargs from plot can be passed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_isosurface">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_isosurface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isovalue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Spectral'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_isosurface" title="Permalink to this definition"></a></dt>
<dd><p>Plots a isosurface given a 3D data, value at which isosurface is defined, 3D grids in Cartesian coordinates)
… the isosurface is extracted by the marching cube algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qty</strong> (<em>3D array</em><em>, </em><em>a scalar field</em>) – </p></li>
<li><p><strong>isovalue</strong> (<em>float</em><em>, </em><em>the value at which the isosurface is extracted</em>) – </p></li>
<li><p><strong>xxx</strong> (<em>3D array</em><em>, </em><em>x component of the positional grid</em>) – </p></li>
<li><p><strong>yyy</strong> (<em>3D array</em><em>, </em><em>y component of the positional grid</em>) – </p></li>
<li><p><strong>zzz</strong> (<em>3D array</em><em>, </em><em>z component of the positional grid</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>name of the color map used to plot the isosurface</em>) – </p></li>
<li><p><strong>r</strong> (<em>float</em><em>,</em>) – </p></li>
<li><p><strong>provided</strong> (<em>...</em><em> If</em>) – </p></li>
<li><p><strong>zz**2</strong><strong>)</strong> (<em>it sets qty</em><em>[</em><em>R &gt; r</em><em>] </em><em>= fill_value where R = np.sqrt</em><em>(</em><em>xx**2 + yy**2 +</em>) – </p></li>
<li><p><strong>boundaries</strong> (<em>...</em><em> This is used for a simple fitering the problematic outliers near the</em>) – </p></li>
<li><p><strong>xc</strong> (<em>float/int</em><em>, </em><em>x-coordinate of the origin in case r is not None</em>) – </p></li>
<li><p><strong>yc</strong> (<em>float/int</em><em>, </em><em>y-coordinate of the origin in case r is not None</em>) – </p></li>
<li><p><strong>zc</strong> (<em>float/int</em><em>, </em><em>z-coordinate of the origin in case r is not None</em>) – </p></li>
<li><p><strong>fill_value</strong> (<em>float/int</em>) – </p></li>
<li><p><strong>None</strong> (<em>...</em><em> If r is not</em>) – </p></li>
<li><p><strong>zz**2</strong><strong>)</strong> – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em><em> (</em><em>&gt;=1</em><em>)</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>e.g. 121</em><em>, </em><em>111</em><em>, </em><em>331</em><em>, </em><em>default=None</em>) – </p></li>
<li><p><strong>matplotlib</strong> (<em>...</em><em> the three digit notaton for the</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size in inches e.g.-</em><em> (</em><em>8</em><em>, </em><em>8</em><em>)</em>) – </p></li>
<li><p><strong>labelaxes</strong> (<em>bool</em><em>, </em><em>default True</em>) – </p></li>
<li><p><strong>True</strong> (<em>...</em><em> If</em>) – </p></li>
<li><p><strong>x</strong><strong>(</strong><strong>mm</strong><strong>)</strong> (<em>it labels each axis as</em>) – </p></li>
<li><p><strong>y</strong><strong>(</strong><strong>mm</strong><strong>)</strong> – </p></li>
<li><p><strong>z</strong><strong>(</strong><strong>mm</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig, ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.figure.Figure instance, matplotlib.axes.Axes instance,</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_multicolor">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_multicolor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colored_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_multicolor" title="Permalink to this definition"></a></dt>
<dd><p>plot a graph using given x,y
fignum can be specified
any kwargs from plot can be passed</p>
<p>org source: <a class="reference external" href="https://matplotlib.org/3.1.1/gallery/lines_bars_and_markers/multicolored_line.html">https://matplotlib.org/3.1.1/gallery/lines_bars_and_markers/multicolored_line.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_saddoughi">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_saddoughi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Re$_{\\lambda}</span> <span class="pre">\\approx</span> <span class="pre">600</span> <span class="pre">$</span> <span class="pre">\n</span> <span class="pre">SV,</span> <span class="pre">1994'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotEk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_saddoughi" title="Permalink to this definition"></a></dt>
<dd><p>plot universal 1d energy spectrum (Saddoughi, 1992)</p>
<p>E(k)=C epsilon^(2/3)k^(-5/3), E11(k)=C1 epsilon^(2/3)k^(-5/3)
# # In iso, homo, turbulence, C1 = 18/55 C. (Pope 6.242)
# c = 1.6
# c1 = 18. / 55. * c</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_saddoughi_struc_func">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_saddoughi_struc_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Re$_{\\lambda}</span> <span class="pre">\x07pprox</span> <span class="pre">600</span> <span class="pre">$</span> <span class="pre">\n</span> <span class="pre">Saddoughi</span> <span class="pre">and</span> <span class="pre">Veeravalli,</span> <span class="pre">1994'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_saddoughi_struc_func" title="Permalink to this definition"></a></dt>
<dd><p>Plots the second order structure function on Saddoughi &amp; Veeravalli, 1994</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>fig</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
<li><p><strong>label</strong> – </p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>array-like</em><em> (</em><em>1d</em><em>)</em>) – </p></li>
<li><p><strong>alpha</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>legend</strong> – </p></li>
<li><p><strong>marker</strong> (<em>str</em><em> or </em><em>list</em>) – … Unlike the plt.scatter(), this accepts a list for markers.
A useful feature if one wants to plot with different markers</p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_spline">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_spline" title="Permalink to this definition"></a></dt>
<dd><p>Plots a spline representation of a curve (x against y)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1d array-like</em>) – </p></li>
<li><p><strong>y</strong> (<em>1d array-like</em>) – </p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>order of spline interpolation</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em><em>, </em><em>default=1</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size e.g.</em><em> (</em><em>8</em><em>, </em><em>8</em><em>) </em><em>in inch</em>) – </p></li>
<li><p><strong>int</strong> (<em>subplot#</em>) – </p></li>
<li><p><strong>notation</strong> (<em>e.g.- 121- matplotlib shorthand</em>) – </p></li>
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure instance</em><em>, </em><em>default: None</em>) – </p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes instance</em><em>, </em><em>default: None</em>) – … If passed, this function plots a curve on the given ax.</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>label of the curve</em>) – </p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>color e.g.- 'r' for red</em><em>, </em><em>'b' for blue. Consult mpl website for the full color code.</em>) – </p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>ax.legend</em><em>(</em><em>) </em><em>is called.</em>) – </p></li>
<li><p><strong>maskon</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it uses get_mask4erroneous_pts</em><em>(</em><em>) </em><em>to spot potentially erroneous values</em><em>, </em><em>and hides them.</em>) – </p></li>
<li><p><strong>thd</strong> (<em>float</em><em>, </em><em>This argument is only relevant if maskon=True. This is a parameter which controls the tolerance of the jumpiness of hte plot.</em>) – … The higher thd is, the less inputs gets hide.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>, </em><em>The other keyword arguments gets passed to ax.plot</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig, ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.figure.Figure instance, matplotlib.axes.Axes instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_surface">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">altdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_surface" title="Permalink to this definition"></a></dt>
<dd><p>plot_surface for the graph module
… By default, it enables the shading feature</p>
<p>Source: <a class="reference external" href="https://stackoverflow.com/questions/28232879/phong-shading-for-shiny-python-3d-surface-plots/31754643">https://stackoverflow.com/questions/28232879/phong-shading-for-shiny-python-3d-surface-plots/31754643</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>z</strong> – </p></li>
<li><p><strong>shade</strong> – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_with_arrows">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_with_arrows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_with_arrows" title="Permalink to this definition"></a></dt>
<dd><p>Add doc later
:param x:
:param y:
:param fignum:
:param figsize:
:param label:
:param color:
:param subplot:
:param legend:
:param fig:
:param ax:
:param maskon:
:param thd:
:param kwargs:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plot_with_varying_alphas">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plot_with_varying_alphas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#1f77b4'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plot_with_varying_alphas" title="Permalink to this definition"></a></dt>
<dd><p>Plots a curve with varying alphas (e.g. fading curves)
… plt.plot(x, y, alpha=alpha) does not allow varying alpha.
… A workaround for this is to use LineCollection. i.e. create lines for each segment, then assign different alpha values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>color</strong> (<em>color of the line</em>) – </p></li>
<li><p><strong>alphas</strong> (<em>list/array with the same length as x and y</em>) – … default:  alphas = 1 - np.linspace(0, 1, len(x))  (linearly fade)</p></li>
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>color</strong> – </p></li>
<li><p><strong>alphas</strong> – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>fig</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>xmin</strong> – </p></li>
<li><p><strong>xmax</strong> – </p></li>
<li><p><strong>maskon</strong> – </p></li>
<li><p><strong>thd</strong> – </p></li>
<li><p><strong>linewidth</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.plotfunc">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">plotfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.plotfunc" title="Permalink to this definition"></a></dt>
<dd><p>plot a graph using the function fun
fignum can be specified
any kwargs from plot can be passed
Use the homemade function refresh() to draw and plot the figure, no matter the way python is called (terminal, script, notebook)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.quiver">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">quiver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inches'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.08,</span> <span class="pre">1.06]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mm/s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_labelpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'E'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.1f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.quiver" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for plt.quiver()</p>
<p>Some tips:
… plt.quiver() autoscales the arrows. This may be problematic if you want to show them with absolute scales.
… I got a workaround for you. You can control this by toggling a boolean “absolute”
…… If “absolute” is False, it autoscales.
…… If “absolute” is True, you must supply “scale” (float)
……… e.g. Plot two quiver plots with the same scale</p>
<blockquote>
<div><p>fig1, ax1, Q1 = quiver(x1, y1, u1, v1, scale=4, fignum=1, key_length=50)
quiver(x2, y2, u2, v2, scale=4, fignum=2, key_length=50) # scale could be Q1.scale</p>
</div></blockquote>
<dl class="simple">
<dt>………… This ensures to plot the arrows with the same scale with the same quiver key.</dt><dd><p>This is essential to create an animation of quiver plots to avoid distraction.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>u</strong> – </p></li>
<li><p><strong>v</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>figsize</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>inc_x</strong> – </p></li>
<li><p><strong>inc_y</strong> – </p></li>
<li><p><strong>inc</strong> – </p></li>
<li><p><strong>color</strong> – </p></li>
<li><p><strong>vmin</strong> – </p></li>
<li><p><strong>vmax</strong> – </p></li>
<li><p><strong>absolute</strong> – </p></li>
<li><p><strong>u_ref</strong> – </p></li>
<li><p><strong>key</strong> – </p></li>
<li><p><strong>key_loc</strong> – </p></li>
<li><p><strong>key_length</strong> – </p></li>
<li><p><strong>key_label</strong> – </p></li>
<li><p><strong>key_units</strong> – </p></li>
<li><p><strong>key_labelpos</strong> – </p></li>
<li><p><strong>key_pad</strong> – </p></li>
<li><p><strong>key_fmt</strong> – </p></li>
<li><p><strong>key_kwargs</strong> – </p></li>
<li><p><strong>aspect</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.quiver3d">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">quiver3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">udata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xinc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yinc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zinc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_bounding_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./vectorfield.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.quiver3d" title="Permalink to this definition"></a></dt>
<dd><p>3D Quiver plot using pyvista</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>udata</strong> (<em>4d array with shape</em><em> (</em><em>3</em><em>, </em><em>y</em><em>, </em><em>x</em><em>, </em><em>z</em><em>)</em>) – </p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>default: False. If True</em><em>, </em><em>it ignores the magnitude in udata. All vectors have the magnitude of 1.</em>) – … This is handy if you would like to assess the directions of the field.</p></li>
<li><p><strong>mag</strong> (<em>float greater than 0</em><em>, </em><em>default:1. udata*mag gets plotted. Sometimes</em><em>, </em><em>it is necessary to multiply a scalar to see the quivers.</em>) – </p></li>
<li><p><strong>inc</strong> (<em>int</em><em>, </em><em>default:1. Increment of quivers to be plotted- if inc=1</em><em>, </em><em>it plots all vectors in udata.</em>) – If inc=2, it plots vectors every 2 xsteps, 2ysteps, and 2zsteps. i.e. 1/8 of vectors in udata gets plotted</p></li>
<li><p><strong>xinc</strong> (<em>int</em><em>, </em><em>default:1. Increment of quivers to be plotted along the x-axis</em><em> (</em><em>the third index of udata</em><em>)</em>) – </p></li>
<li><p><strong>yinc</strong> (<em>int</em><em>, </em><em>default:1. Increment of quivers to be plotted along the y-axis</em><em> (</em><em>the second index of udata</em><em>)</em>) – </p></li>
<li><p><strong>zinc</strong> (<em>int</em><em>, </em><em>default:1. Increment of quivers to be plotted along the z-axis</em><em> (</em><em>the fourth index of udata</em><em>)</em>) – </p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>default: 0. The color range is specified by</em><em> [</em><em>vmin</em><em>, </em><em>vmax</em><em>]</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>default: None. The default is the maximum value in udata</em>) – </p></li>
<li><p><strong>add_bounding_box</strong> (<em>bool</em><em>, </em><em>default: True. If True</em><em>, </em><em>it draws a bounding box of udata</em>) – </p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>default: False. If True</em><em>, </em><em>it saves an image</em><em> (</em><em>png</em><em>) </em><em>at savepath.</em>) – </p></li>
<li><p><strong>savepath</strong> (<em>str</em><em>, </em><em>a path where an image gets saved if save is True.</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default: True. If False</em><em>, </em><em>it suppresses print outputs.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>plobj, a</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyvista.Plotter instance,  returned object of pyvista.Plotter.add_arrows()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.resample">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.resample" title="Permalink to this definition"></a></dt>
<dd><p>Resample x, y
… this is particularly useful to crete a evenly spaced data in log from a linearly spaced data, and vice versa</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>y</strong> (<em>1d array</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of points to resample</em>) – </p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>options are &quot;linear&quot; and &quot;log&quot;</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_new, y_rs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1d arrays of new x and new y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.reset_figure_params">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">reset_figure_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.reset_figure_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.reset_sfmt">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">reset_sfmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%03.1f'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.reset_sfmt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.save">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transparent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.save" title="Permalink to this definition"></a></dt>
<dd><p>Save a figure from pyplot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>string</em>) – The path (and filename, without the extension) to save the
figure to.</p></li>
<li><p><strong>ext</strong> (<em>string</em><em> (</em><em>default='png'</em><em>)</em>) – The file extension. This must be supported by the active
matplotlib backend (see matplotlib.backends module).  Most
backends support ‘png’, ‘pdf’, ‘ps’, ‘eps’, and ‘svg’.</p></li>
<li><p><strong>ext</strong> – The file extension. This must be supported by the active
matplotlib backend (see matplotlib.backends module).  Most
backends support ‘png’, ‘pdf’, ‘ps’, ‘eps’, and ‘svg’.</p></li>
<li><p><strong>close</strong> (<em>boolean</em><em> (</em><em>default=True</em><em>)</em>) – Whether to close the figure after saving.  If you want to save
the figure multiple times (e.g., to multiple formats), you
should NOT close it in between saves or you will have to
re-plot it.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em> (</em><em>default=True</em><em>)</em>) – Whether to print information about when and where the image
has been saved.</p></li>
<li><p><strong>fignum</strong> – </p></li>
<li><p><strong>dpi</strong> – </p></li>
<li><p><strong>overwrite</strong> – </p></li>
<li><p><strong>tight_layout</strong> – </p></li>
<li><p><strong>savedata</strong> – </p></li>
<li><p><strong>transparent</strong> – </p></li>
<li><p><strong>bkgcolor</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.scatter">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_bottom_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_left_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.scatter" title="Permalink to this definition"></a></dt>
<dd><p>plot a graph using given x,y
fignum can be specified
any kwargs from plot can be passed
Use the homemade function refresh() to draw and plot the figure, no matter the way python is called (terminal, script, notebook)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.scatter3d">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">scatter3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelaxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.scatter3d" title="Permalink to this definition"></a></dt>
<dd><p>plot a graph using given x,y
fignum can be specified
any kwargs from plot can be passed
Use the homemade function refresh() to draw and plot the figure, no matter the way python is called (terminal, script, notebook)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_axes_equal">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_axes_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_axes_equal" title="Permalink to this definition"></a></dt>
<dd><p>Make axes of 3D plot have equal scale so that spheres appear as spheres,
cubes as cubes, etc..  This is one possible solution to Matplotlib’s
ax.set_aspect(‘equal’) and ax.axis(‘equal’) not working for 3D.</p>
<dl class="simple">
<dt>Input</dt><dd><p>ax: a matplotlib axis, e.g., as output from plt.gca().</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_color_cycle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_color_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmapname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab10'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_color_cycle" title="Permalink to this definition"></a></dt>
<dd><p>Sets a color cycle of a particular Axes instance</p>
<p>sns_palettes = [‘deep’, ‘muted’, ‘bright’, ‘pastel’, ‘dark’, ‘colorblind’] # sns_palettes
matplotlab cmap names: ‘tab10’ (default cmap of mpl), ‘tab20’, ‘Set1’, ‘Set2’ etc.
(<a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">https://matplotlib.org/stable/tutorials/colors/colormaps.html</a>)
… One may specify the color cycles using the existing color maps (seaborn and matplotlib presets)</p>
<blockquote>
<div><p>or a list of colors specified by a user.</p>
</div></blockquote>
<p>… For the presets, pass a name of the colormap like “tab10” (mpl default), “muted” (seaborn defualt)
… For a more customized color cycle, pass a list of colors to ‘colors’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmapname</strong> (<em>str</em><em>, </em><em>name of the cmap like 'viridis'</em><em>, </em><em>'jet'</em><em>, </em><em>etc.</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of colors</em>) – </p></li>
<li><p><strong>colors</strong> (<em>list</em><em>, </em><em>a list of colors like</em><em> [</em><em>'r'</em><em>, </em><em>'b'</em><em>, </em><em>'g'</em><em>, </em><em>'magenta'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_color_cycle_custom">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_color_cycle_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['#1f77b4',</span> <span class="pre">'#ff7f0e',</span> <span class="pre">'#2ca02c',</span> <span class="pre">'#d62728',</span> <span class="pre">'#9467bd',</span> <span class="pre">'#8c564b',</span> <span class="pre">'#e377c2',</span> <span class="pre">'#7f7f7f',</span> <span class="pre">'#bcbd22',</span> <span class="pre">'#17becf']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_color_cycle_custom" title="Permalink to this definition"></a></dt>
<dd><p>Sets a color cycle using a list
:param ax:
:param colors:
:type colors: list of colors in rgb/cnames/hex codes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_color_cycle_gradient">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_color_cycle_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'greenyellow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'navy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_color_cycle_gradient" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_default_color_cycle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_default_color_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab10'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_default_color_cycle" title="Permalink to this definition"></a></dt>
<dd><p>Sets a color cycle for plotting</p>
<p>sns_palettes = [‘deep’, ‘muted’, ‘bright’, ‘pastel’, ‘dark’, ‘colorblind’] # sns_palettes
matplotlab cmap names: ‘tab10’ (default cmap of mpl), ‘tab20’, ‘Set1’, ‘Set2’ etc.
(<a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">https://matplotlib.org/stable/tutorials/colors/colormaps.html</a>)
… One may specify the color cycles using the existing color maps (seaborn and matplotlib presets)</p>
<blockquote>
<div><p>or a list of colors specified by a user.</p>
</div></blockquote>
<p>… For the presets, pass a name of the colormap like “tab10” (mpl default), “muted” (seaborn defualt)
… For a more customized color cycle, pass a list of colors to ‘colors’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>name of the cmap</em>) – </p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>number of colors</em>) – </p></li>
<li><p><strong>colors</strong> (<em>list</em><em>, </em><em>a list of colors like</em><em> [</em><em>'r'</em><em>, </em><em>'b'</em><em>, </em><em>'g'</em><em>, </em><em>'magenta'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_fig">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fignum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_cycler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_cycler_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">['r',</span> <span class="pre">'b',</span> <span class="pre">'g',</span> <span class="pre">'y'],</span> <span class="pre">'linestyle':</span> <span class="pre">['-',</span> <span class="pre">'-',</span> <span class="pre">'-',</span> <span class="pre">'-'],</span> <span class="pre">'linewidth':</span> <span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3,</span> <span class="pre">3],</span> <span class="pre">'marker':</span> <span class="pre">['o',</span> <span class="pre">'o',</span> <span class="pre">'o',</span> <span class="pre">'o'],</span> <span class="pre">'s':</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_fig" title="Permalink to this definition"></a></dt>
<dd><p>Returns Figure and Axes instances
… a short sniplet for</p>
<blockquote>
<div><p>plt.figure(fignum, dpi=dpi, figsize=figsize)
plt.subplot(subplot, <a href="#id27"><span class="problematic" id="id28">**</span></a>kwargs)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fignum</strong> (<em>int</em><em>, </em><em>figure number</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em><em>, </em><em>A 3-digit integer. The digits are interpreted as if given separately as three single-digit integers</em><em>, </em><em>i.e. fig.add_subplot</em><em>(</em><em>235</em><em>) </em><em>is the same as fig.add_subplot</em><em>(</em><em>2</em><em>, </em><em>3</em><em>, </em><em>5</em><em>)</em><em> Note that this can only be used if there are no more than 9 subplots.</em>) – </p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>,</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>figure size</em>) – </p></li>
<li><p><strong>custom_cycler</strong> (<em>bool</em><em>, </em><em>If True</em><em>, </em><em>it enables users to customize a plot style</em><em> (</em><em>color cycle</em><em>, </em><em>marker cycle</em><em>, </em><em>linewidth cycle etc.</em><em>)</em>) – … The customized cycler could be passed to custom_cycler_dict.</p></li>
<li><p><strong>custom_cycler_dict</strong> (<em>dict</em><em>, </em><em>A summary of a plotting style.</em>) – <dl class="simple">
<dt>… E.g.- default_custom_cycler = {‘color’: [‘r’, ‘b’, ‘g’, ‘y’],</dt><dd><p>’linestyle’: [‘-’, ‘-’, ‘-’, ‘-‘],
‘linewidth’: [3, 3, 3, 3],
‘marker’: [‘o’, ‘o’, ‘o’, ‘o’],
‘s’: [0,0,0,0]}</p>
</dd>
</dl>
<p>… The dictionary is turned into a list of cyclers, and passed to ax.set_prop_cycle(custom_cycler).</p>
</p></li>
<li><p><strong>kwargs</strong> (Visit plt.subplot(<a href="#id29"><span class="problematic" id="id30">**</span></a>kwargs) for available kwargs) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>Figure instance</em>)</p></li>
<li><p><strong>ax</strong> (<em>Axes instance</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_fontsize_scientific_text">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_fontsize_scientific_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_fontsize_scientific_text" title="Permalink to this definition"></a></dt>
<dd><p>Set fontsize for the scientific format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fontsize</strong> (<em>int</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_grid_invisible">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_grid_invisible</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_grid_invisible" title="Permalink to this definition"></a></dt>
<dd><p>Makes the background grid invisible
:param ax:
:type ax: axes.Axes instance</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_pane_invisible">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_pane_invisible</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_pane_invisible" title="Permalink to this definition"></a></dt>
<dd><p>Makes the background pane invisible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ax</strong> (<em>axes.Axes instance</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_standard_pos">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_standard_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_standard_pos" title="Permalink to this definition"></a></dt>
<dd><p>Sets standard positions for added texts in the plot
left: 0.025, right: 0.75
bottom: 0.10 top: 0.90
xcenter: 0.5 ycenter:0.5
:param ax:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>top, bottom, right, left, xcenter, ycenter</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float, position</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_xtick_interval">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_xtick_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_xtick_interval" title="Permalink to this definition"></a></dt>
<dd><p>Sets x-tick interval as tickint
:param ax:
:type ax: Axes object
:param tickint:
:type tickint: float, tick interval</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.set_ytick_interval">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">set_ytick_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.set_ytick_interval" title="Permalink to this definition"></a></dt>
<dd><p>Sets y-tick interval as tickint
:param ax:
:type ax: Axes object
:param tickint:
:type tickint: float, tick interval</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.setaxes">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">setaxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.setaxes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.show">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.show" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.show_plot_styles">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">show_plot_styles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.show_plot_styles" title="Permalink to this definition"></a></dt>
<dd><p>Prints available plotting styles</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.simple_legend">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">simple_legend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.simple_legend" title="Permalink to this definition"></a></dt>
<dd><p>Removes the errorbars from the legend</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.simplest_fraction_in_interval">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">simplest_fraction_in_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.simplest_fraction_in_interval" title="Permalink to this definition"></a></dt>
<dd><p>Return the fraction with the lowest denominator in [x,y].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.skipcolor">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">skipcolor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">numskip</span></em>, <em class="sig-param"><span class="pre">color_cycle=&lt;itertools.cycle</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.skipcolor" title="Permalink to this definition"></a></dt>
<dd><p>Skips numskip times in the color_cycle iterator
Can be used to reset the color_cycle</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.smooth">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.smooth" title="Permalink to this definition"></a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with a given signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl>
<dt>input:</dt><dd><p>x: the input signal
window_len: the dimension of the smoothing window; should be an odd integer
window: the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’</p>
<blockquote>
<div><p>flat window will produce a moving average smoothing.</p>
</div></blockquote>
</dd>
<dt>output:</dt><dd><p>the smoothed signal</p>
</dd>
</dl>
<p>example:</p>
<p>t=linspace(-2,2,0.1)
x=sin(t)+randn(len(t))*0.1
y=smooth(x)</p>
<p>see also:</p>
<p>numpy.hanning, numpy.hamming, numpy.bartlett, numpy.blackman, numpy.convolve
scipy.signal.filter</p>
<p>TODO: the window parameter could be the window itself if an array instead of a string
NOTE: length(output) != length(input), to correct this: return y[(window_len/2-1):-(window_len/2)] instead of just y.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.smooth1d">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">smooth1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.smooth1d" title="Permalink to this definition"></a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with a given signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl>
<dt>input:</dt><dd><p>x: the input signal
window_len: the dimension of the smoothing window; should be an odd integer
window: the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’</p>
<blockquote>
<div><p>flat window will produce a moving average smoothing.</p>
</div></blockquote>
</dd>
<dt>output:</dt><dd><p>the smoothed signal</p>
</dd>
</dl>
<p>example:</p>
<p>t=linspace(-2,2,0.1)
x=sin(t)+randn(len(t))*0.1
y=smooth(x)</p>
<p>see also:</p>
<p>numpy.hanning, numpy.hamming, numpy.bartlett, numpy.blackman, numpy.convolve
scipy.signal.filter</p>
<p>TODO: the window parameter could be the window itself if an array instead of a string
NOTE: length(output) != length(input), to correct this: return y[(window_len/2-1):-(window_len/2)] instead of just y.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.streamplot">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">streamplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1.0,</span> <span class="pre">1.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.streamplot" title="Permalink to this definition"></a></dt>
<dd><p>Plots streamlines (2D)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>y</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>u</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>v</strong> (<em>2d array</em>) – </p></li>
<li><p><strong>subplot</strong> (<em>int</em>) – </p></li>
<li><p><strong>fignum</strong> (<em>int</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>tuple</em>) – </p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax.Axes instance</em>) – </p></li>
<li><p><strong>density</strong> (<em>1d array-like</em>) – … density of streamlines</p></li>
<li><p><strong>aspect</strong> (<em>str</em><em>, </em><em>default: &quot;equal&quot;</em>) – … options: “equal”, “auto”</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – … passed to ax.streamplot()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.suptitle">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">suptitle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0.03,</span> <span class="pre">1,</span> <span class="pre">0.95]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.suptitle" title="Permalink to this definition"></a></dt>
<dd><p>Add a centered title to the figure.
If fignum is given, it adds a title, then it reselects the figure which selected before this method was called.
… this is because figure class does not have a suptitle method.
…
:param title:
:param fignum:
:param kwargs:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.tight_layout">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">tight_layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0.03,</span> <span class="pre">1,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.tight_layout" title="Permalink to this definition"></a></dt>
<dd><p>Reminder for myself how tight_layout works with the ect option
fig.tight_layout(rect=rect)
:param fig:
:param rect:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.title">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">title</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.title" title="Permalink to this definition"></a></dt>
<dd><p>ax.set_title(title, <a href="#id31"><span class="problematic" id="id32">**</span></a>kwargs)
… if you want more space for the tile, try “pad=50”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> – </p></li>
<li><p><strong>title</strong> – </p></li>
<li><p><strong>subplot</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.tologlog">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">tologlog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.tologlog" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.tosemilogx">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">tosemilogx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.tosemilogx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.tosemilogy">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">tosemilogy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.tosemilogy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.update_figure_params">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">update_figure_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.update_figure_params" title="Permalink to this definition"></a></dt>
<dd><p>update a default matplotlib setting
e.g. params = { ‘legend.fontsize’: ‘x-large’,</p>
<blockquote>
<div><p>‘figure.figsize’: (15, 5),
‘axes.labelsize’: ‘x-large’,
‘axes.titlesize’:’x-large’,
‘xtick.labelsize’:’x-large’,
‘ytick.labelsize’:’x-large’}</p>
</div></blockquote>
<p>… pylab.rcParams.update(params)
:param params:
:type params: dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.use_backend">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">use_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'agg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.use_backend" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.use_plot_style">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">use_plot_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stylename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.use_plot_style" title="Permalink to this definition"></a></dt>
<dd><p>Reminder for me how to set a plotting style</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tflow.graph.use_symmetric_ylim">
<span class="sig-prename descclassname"><span class="pre">tflow.graph.</span></span><span class="sig-name descname"><span class="pre">use_symmetric_ylim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tflow.graph.use_symmetric_ylim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="helper-modules">
<h2>Helper modules<a class="headerlink" href="#helper-modules" title="Permalink to this headline"></a></h2>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Takumi Matsuzawa<br/>
  
      &copy; Copyright 2022, Takumi Matsuzawa.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>